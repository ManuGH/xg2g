services:
  xg2g:
    build: .
    image: xg2g:local
    container_name: xg2g
    restart: unless-stopped
    ports:
      - "8088:8088"
    # Production compose: deterministic paths (use docker-compose.dev.yml for local overrides).
    env_file:
      - /etc/xg2g/xg2g.env
    environment:
      - XG2G_DATA=/var/lib/xg2g
      - XG2G_LOG_LEVEL=info
    volumes:
      - /var/lib/xg2g:/var/lib/xg2g
      # Optional: Mount a custom config
      # - ./config.yaml:/var/lib/xg2g/config.yaml:ro
    healthcheck:
      test: ["CMD", "xg2g", "healthcheck", "-mode", "live"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 60s
