# xg2g - Enigma2 to IPTV Gateway
# Standard 2025 Setup - Everything enabled by default
#
# Features included:
# - M3U playlist with channel logos
# - 7-day EPG guide (XMLTV)
# - HDHomeRun emulation (Plex/Jellyfin auto-discovery)
# - Smart stream detection (OSCam port 8001/17999)
# - Enigma2 authentication

services:
  xg2g:
    image: ghcr.io/manugh/xg2g:latest
    container_name: xg2g
    ports:
      - "8080:8080"      # HTTP API & M3U/EPG
      - "1900:1900/udp"  # SSDP for Plex/Jellyfin discovery
      - "9090:9090"      # Prometheus metrics (optional)
    environment:
      # ============================================================================
      # Required Configuration
      # ============================================================================
      - XG2G_OWI_BASE=http://192.168.1.100
      - XG2G_OWI_USER=root
      - XG2G_OWI_PASS=yourpassword
      - XG2G_BOUQUET=Favourites

      # ============================================================================
      # Optional: Disable Features (all enabled by default)
      # ============================================================================
      # - XG2G_EPG_ENABLED=false                  # Disable EPG collection
      # - XG2G_SMART_STREAM_DETECTION=false       # Disable OSCam auto-detection
      # - XG2G_HDHR_ENABLED=false                 # Disable HDHomeRun emulation

      # ============================================================================
      # Optional: Advanced Configuration
      # ============================================================================
      # - XG2G_DATA=/data                         # Data directory
      # - XG2G_EPG_DAYS=7                         # EPG days (1-14)
      # - XG2G_API_TOKEN=your-token-here          # API authentication
      # - XG2G_PICON_BASE=http://picons-url       # Custom picons URL
    volumes:
      - ./data:/data
    healthcheck:
      test: wget -q --spider -T 5 -O /dev/null http://localhost:8080/readyz || exit 1
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    restart: unless-stopped

# ============================================================================
# Access URLs
# ============================================================================
#
# M3U Playlist:  http://localhost:8080/files/playlist.m3u
# EPG (XMLTV):   http://localhost:8080/xmltv.xml
# API Status:    http://localhost:8080/api/v1/status
# Prometheus:    http://localhost:9090/metrics
#
# Plex/Jellyfin: Automatically discovered via SSDP (port 1900/udp)
#
# ============================================================================
# For Development
# ============================================================================
#
# To build locally instead of using the published image:
#   docker compose -f docker-compose.dev.yml up --build
#
# See: docker-compose.dev.yml, docker-compose.test.yml
#
