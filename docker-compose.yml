services:
  xg2g:
    build: .
    image: xg2g:local
    container_name: xg2g
    restart: unless-stopped
    ports:
      - "8088:8088"
    environment:
      - XG2G_DATA=/var/lib/xg2g
      - XG2G_LOG_LEVEL=info
      # Required secrets/config via .env file or explicit env
      - XG2G_OWI_BASE=http://root:Kiddy99@10.10.55.64
      - XG2G_API_TOKEN=${XG2G_API_TOKEN}
      - XG2G_API_TOKEN_SCOPES=v3:admin,v3:read,v3:write
    volumes:
      - ./data:/var/lib/xg2g
      # Optional: Mount a custom config
      # - ./config.yaml:/var/lib/xg2g/config.yaml:ro
    healthcheck:
      test: ["CMD", "xg2g", "healthcheck", "-mode", "live"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 60s
