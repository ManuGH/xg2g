# xg2g systemd Timer Configuration
# Copy to /etc/systemd/system/ and enable with:
# sudo systemctl enable --now xg2g-refresh.timer

# /etc/systemd/system/xg2g-refresh.service
[Unit]
Description=xg2g Refresh Service
After=network.target
Requires=network.target

[Service]
Type=oneshot
User=xg2g
Group=xg2g
WorkingDirectory=/opt/xg2g
Environment="XG2G_HOST=localhost:8080"
Environment="XG2G_TOKEN_FILE=/opt/xg2g/.env.prod"
Environment="LOG_FILE=/var/log/xg2g/refresh.log"
ExecStart=/opt/xg2g/scripts/xg2g-auto-refresh.sh
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target

---

# /etc/systemd/system/xg2g-refresh.timer
[Unit]
Description=xg2g Refresh Timer - Every 15 minutes
Requires=xg2g-refresh.service

[Timer]
OnCalendar=*:0/15  # Every 15 minutes
Persistent=true
RandomizedDelaySec=60  # Add up to 60s random delay

[Install]
WantedBy=timers.target

---

# Installation Commands:
# sudo cp xg2g-refresh.{service,timer} /etc/systemd/system/
# sudo systemctl daemon-reload
# sudo systemctl enable --now xg2g-refresh.timer
# sudo systemctl status xg2g-refresh.timer

# Monitoring:
# sudo journalctl -u xg2g-refresh.service -f
# sudo systemctl list-timers | grep xg2g