# Default values for xg2g Helm chart
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: ghcr.io/manugh/xg2g
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65532
  runAsGroup: 65532
  fsGroup: 65532
  seccompProfile:
    type: RuntimeDefault

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true

service:
  type: ClusterIP
  port: 8080
  annotations: {}

metrics:
  enabled: true
  port: 9090
  serviceMonitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s

ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: xg2g.local
      paths:
        - path: /
          pathType: Prefix
  tls: []
  #  - secretName: xg2g-tls
  #    hosts:
  #      - xg2g.local

resources:
  limits:
    cpu: 500m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# Persistent storage for data (M3U, XMLTV files)
persistence:
  enabled: true
  # storageClass: "-"
  accessMode: ReadWriteOnce
  size: 1Gi
  # existingClaim: ""

# xg2g configuration
config:
  # Enigma2 receiver configuration
  owiBase: "http://your-receiver-ip"
  owiUser: ""
  owiPass: ""
  bouquet: "Favourites"

  # EPG configuration
  epg:
    enabled: true
    days: 7
    maxConcurrency: 10

  # HDHomeRun emulation
  hdhr:
    enabled: true
    friendlyName: "xg2g"

  # Stream proxy
  streamProxy:
    enabled: false
    port: 18000
    target: ""
    streamBase: ""

  # Transcoding
  transcoding:
    enabled: false
    audioCodec: "aac"
    audioBitrate: "192k"
    audioChannels: 2

  # Logging
  logLevel: "info"
  logFormat: "json"

  # API
  apiToken: ""

  # Rate limiting
  rateLimit:
    rps: 5
    burst: 10

# Liveness and readiness probes
livenessProbe:
  httpGet:
    path: /healthz
    port: http
  initialDelaySeconds: 15
  periodSeconds: 30
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /healthz
    port: http
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 3
  failureThreshold: 3

# Additional environment variables
extraEnv: []
# - name: XG2G_CUSTOM_VAR
#   value: "custom-value"

# Additional volume mounts
extraVolumeMounts: []
# - name: config
#   mountPath: /config
#   readOnly: true

# Additional volumes
extraVolumes: []
# - name: config
#   configMap:
#     name: xg2g-config
