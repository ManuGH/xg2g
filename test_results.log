# github.com/ManuGH/xg2g/cmd/configgen
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/cmd/gencert
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/cmd/generate-capability-fixtures
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/cmd/xg2g-soak
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/api [github.com/ManuGH/xg2g/internal/api.test]
internal/api/handlers_test.go:87:54: not enough arguments in call to resilience.NewCircuitBreaker
	have (string, number, time.Duration)
	want (string, int, int, time.Duration, time.Duration, ...resilience.Option)
# github.com/ManuGH/xg2g/internal/api/testutil
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
=== RUN   TestMaskURL
=== RUN   TestMaskURL/http_URL_without_credentials
=== RUN   TestMaskURL/https_URL_without_credentials
=== RUN   TestMaskURL/URL_with_username_and_password
=== RUN   TestMaskURL/URL_with_only_username
=== RUN   TestMaskURL/URL_with_complex_credentials
=== RUN   TestMaskURL/URL_with_special_characters_in_password
=== RUN   TestMaskURL/plain_text_(parsed_as_relative_path)
=== RUN   TestMaskURL/empty_URL
=== RUN   TestMaskURL/IPv6_address
=== RUN   TestMaskURL/URL_with_fragment
=== RUN   TestMaskURL/URL_with_query_parameters
--- PASS: TestMaskURL (0.00s)
    --- PASS: TestMaskURL/http_URL_without_credentials (0.00s)
    --- PASS: TestMaskURL/https_URL_without_credentials (0.00s)
    --- PASS: TestMaskURL/URL_with_username_and_password (0.00s)
    --- PASS: TestMaskURL/URL_with_only_username (0.00s)
    --- PASS: TestMaskURL/URL_with_complex_credentials (0.00s)
    --- PASS: TestMaskURL/URL_with_special_characters_in_password (0.00s)
    --- PASS: TestMaskURL/plain_text_(parsed_as_relative_path) (0.00s)
    --- PASS: TestMaskURL/empty_URL (0.00s)
    --- PASS: TestMaskURL/IPv6_address (0.00s)
    --- PASS: TestMaskURL/URL_with_fragment (0.00s)
    --- PASS: TestMaskURL/URL_with_query_parameters (0.00s)
=== RUN   TestReportRedaction
--- PASS: TestReportRedaction (0.00s)
PASS
coverage: 3.4% of statements
ok  	github.com/ManuGH/xg2g/cmd/daemon	1.040s	coverage: 3.4% of statements
=== RUN   TestProbeCleanup_Hardened
PASS: Server_Identity (0ms)
PASS: Setup_FetchServiceRef (0ms)
PASS: Router_404_RFC7807 (0ms)
PASS: Router_405_RFC7807 (0ms)
INJECTING FAILURE: panic
CLEANUP: Attempting to delete timer test-timer-123
CLEANUP SUCCESS: Timer test-timer-123 deleted
--- PASS: TestProbeCleanup_Hardened (0.00s)
PASS
coverage: 47.1% of statements
ok  	github.com/ManuGH/xg2g/cmd/v3probe	1.022s	coverage: 47.1% of statements
# github.com/ManuGH/xg2g/internal/channels
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/control/clientplayback
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/control/http/problem
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
=== RUN   TestValidateCLI
=== RUN   TestValidateCLI/valid_minimal_config
=== RUN   TestValidateCLI/invalid_unknown_key
=== RUN   TestValidateCLI/invalid_type_mismatch
=== RUN   TestValidateCLI/no_file_flag_provided
=== RUN   TestValidateCLI/non-existent_file
--- PASS: TestValidateCLI (0.62s)
    --- PASS: TestValidateCLI/valid_minimal_config (0.01s)
    --- PASS: TestValidateCLI/invalid_unknown_key (0.00s)
    --- PASS: TestValidateCLI/invalid_type_mismatch (0.00s)
    --- PASS: TestValidateCLI/no_file_flag_provided (0.00s)
    --- PASS: TestValidateCLI/non-existent_file (0.00s)
=== RUN   TestValidateCLI_Version
--- PASS: TestValidateCLI_Version (0.53s)
=== RUN   TestValidateCLI_CuratedSurface
--- PASS: TestValidateCLI_CuratedSurface (0.52s)
=== RUN   TestValidateCLI_RegistryParity
    main_test.go:180: validate failed for registry example ../../config.generated.example.yaml: exit status 1
        Output:
        Configuration error in ../../config.generated.example.yaml:
          load config file: strict config parse error (legacy keys found? see docs/guides/CONFIGURATION.md): yaml: unmarshal errors:
          line 55: field featureFlags not found in type config.FileConfig
--- FAIL: TestValidateCLI_RegistryParity (0.43s)
FAIL
coverage: 0.0% of statements
FAIL	github.com/ManuGH/xg2g/cmd/validate	2.120s
=== RUN   TestResourceMonitor_CPU_FailClosed
    monitor_cpu_test.go:22: expected fail-closed (ReasonCPUUnknown) with 14 samples, got ok=true reason=admitted
--- FAIL: TestResourceMonitor_CPU_FailClosed (0.00s)
=== RUN   TestResourceMonitor_CPU_RatioAdmisson
=== RUN   TestResourceMonitor_CPU_RatioAdmisson/46%_Samples_Over_Threshold_Admits
=== RUN   TestResourceMonitor_CPU_RatioAdmisson/50%_Samples_Over_Threshold_Rejects
--- PASS: TestResourceMonitor_CPU_RatioAdmisson (0.00s)
    --- PASS: TestResourceMonitor_CPU_RatioAdmisson/46%_Samples_Over_Threshold_Admits (0.00s)
    --- PASS: TestResourceMonitor_CPU_RatioAdmisson/50%_Samples_Over_Threshold_Rejects (0.00s)
=== RUN   TestResourceMonitor_CPU_EvictionBoundary
    monitor_cpu_test.go:108: expected fail-closed after clock tick, got ok=true reason=admitted
--- FAIL: TestResourceMonitor_CPU_EvictionBoundary (0.00s)
=== RUN   TestResourceMonitor_CPU_TimeJump
    monitor_cpu_test.go:132: expected fail-closed after 60s time jump, got ok=true reason=admitted
--- FAIL: TestResourceMonitor_CPU_TimeJump (0.00s)
=== RUN   TestResourceMonitor_GPUAdmission
--- PASS: TestResourceMonitor_GPUAdmission (0.00s)
=== RUN   TestResourceMonitor_PriorityOrdering
--- PASS: TestResourceMonitor_PriorityOrdering (0.00s)
=== RUN   TestResourceMonitor_TokenCleanup
--- PASS: TestResourceMonitor_TokenCleanup (0.00s)
=== RUN   TestResourceMonitor_TunerAdmission
--- PASS: TestResourceMonitor_TunerAdmission (0.00s)
=== RUN   TestResourceMonitor_PreemptionPredicates
--- PASS: TestResourceMonitor_PreemptionPredicates (0.00s)
=== RUN   TestResourceMonitor_NoSpawnGuarantee
=== RUN   TestResourceMonitor_NoSpawnGuarantee/PoolFull_RejectsWhenNoPreemptibleSessions
    nospawn_test.go:37: Admitted: false, Reason: pool_full
=== RUN   TestResourceMonitor_NoSpawnGuarantee/ZeroPool_RejectsEverything
    nospawn_test.go:51: Admitted: false, Reason: pool_full
=== RUN   TestResourceMonitor_NoSpawnGuarantee/PreemptionScenario_HigherPriorityCanPreemptLower
    nospawn_test.go:69: Admitted: true, Reason: preempt
=== RUN   TestResourceMonitor_NoSpawnGuarantee/RecordingCannotPreemptRecording
    nospawn_test.go:87: Admitted: false, Reason: pool_full
--- PASS: TestResourceMonitor_NoSpawnGuarantee (0.00s)
    --- PASS: TestResourceMonitor_NoSpawnGuarantee/PoolFull_RejectsWhenNoPreemptibleSessions (0.00s)
    --- PASS: TestResourceMonitor_NoSpawnGuarantee/ZeroPool_RejectsEverything (0.00s)
    --- PASS: TestResourceMonitor_NoSpawnGuarantee/PreemptionScenario_HigherPriorityCanPreemptLower (0.00s)
    --- PASS: TestResourceMonitor_NoSpawnGuarantee/RecordingCannotPreemptRecording (0.00s)
=== RUN   TestResourceMonitor_SessionTracking
--- PASS: TestResourceMonitor_SessionTracking (0.00s)
FAIL
coverage: 69.0% of statements
FAIL	github.com/ManuGH/xg2g/internal/admission	0.019s
FAIL	github.com/ManuGH/xg2g/internal/api [build failed]
=== RUN   TestVODPlayback_DurationTruth
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:54+01:00","message":"Running pre-flight startup checks..."}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","path":"/tmp/xg2g-vod-duration-2764580326","time":"2026-02-01T14:52:54+01:00","message":"✓ Data directory is writable"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","addr":":0","time":"2026-02-01T14:52:54+01:00","message":"✓ API listen address is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","url":"http://mock-receiver","time":"2026-02-01T14:52:54+01:00","message":"✓ OWI Base URL is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","ffmpeg":"/usr/bin/ffmpeg","time":"2026-02-01T14:52:54+01:00","message":"✓ Engine dependencies available"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","store_backend":"memory","time":"2026-02-01T14:52:54+01:00","message":"engine uses in-memory store; sessions are not persistent across restarts"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","data_dir":"/tmp/xg2g-vod-duration-2764580326","time":"2026-02-01T14:52:54+01:00","message":"data directory is under temp; cached data and sessions may be lost on reboot"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:54+01:00","message":"✅ All startup checks passed"}
{"level":"info","service":"xg2g","version":"test-v3","roots":1,"time":"2026-02-01T14:52:54+01:00","message":"library service initialized"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:54+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:54+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"about","time":"2026-02-01T14:52:54+01:00","message":"rate limit wait cancelled"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"getlocations","time":"2026-02-01T14:52:54+01:00","message":"rate limit wait cancelled"}
=== RUN   TestVODPlayback_DurationTruth/FallbackPath_ProbeAndPersist
{"level":"info","sref":"1:0:0:0:0:0:0:0:0:0:/hdd/movie/film.ts","kind":"local","source":"file:///tmp/xg2g-vod-duration-2764580326/movies/film.ts","time":"2026-02-01T14:52:54+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/313a303a303a303a303a303a303a303a303a303a2f6864642f6d6f7669652f66696c6d2e7473/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"96ea99bd-6229-45e2-a33e-afc3d9bc133d","event":"request.handled","status":503,"duration":0.923593,"time":"2026-02-01T14:52:54+01:00","message":"http request"}
{"level":"info","sref":"1:0:0:0:0:0:0:0:0:0:/hdd/movie/film.ts","kind":"local","source":"file:///tmp/xg2g-vod-duration-2764580326/movies/film.ts","time":"2026-02-01T14:52:55+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/313a303a303a303a303a303a303a303a303a303a2f6864642f6d6f7669652f66696c6d2e7473/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"c4ab3ccc-f2ae-41fe-92b8-1f3599394c1e","event":"request.handled","status":200,"duration":1.919288,"time":"2026-02-01T14:52:55+01:00","message":"http request"}
=== RUN   TestVODPlayback_DurationTruth/SuccessPath_FromStore
{"level":"info","sref":"1:0:0:0:0:0:0:0:0:0:/hdd/movie/film.ts","kind":"local","source":"file:///tmp/xg2g-vod-duration-2764580326/movies/film.ts","time":"2026-02-01T14:52:55+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/313a303a303a303a303a303a303a303a303a303a2f6864642f6d6f7669652f66696c6d2e7473/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"dcab6700-c2e1-4975-a92a-7604c7374b92","event":"request.handled","status":200,"duration":1.430122,"time":"2026-02-01T14:52:55+01:00","message":"http request"}
--- PASS: TestVODPlayback_DurationTruth (0.13s)
    --- PASS: TestVODPlayback_DurationTruth/FallbackPath_ProbeAndPersist (0.10s)
    --- PASS: TestVODPlayback_DurationTruth/SuccessPath_FromStore (0.00s)
=== RUN   TestVODPlayback_Path_Wiring_ErrorPath
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:55+01:00","message":"Running pre-flight startup checks..."}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","path":"/tmp/xg2g-vod-error-1789512702","time":"2026-02-01T14:52:55+01:00","message":"✓ Data directory is writable"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","addr":":0","time":"2026-02-01T14:52:55+01:00","message":"✓ API listen address is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","url":"http://mock-receiver","time":"2026-02-01T14:52:55+01:00","message":"✓ OWI Base URL is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","ffmpeg":"/usr/bin/ffmpeg","time":"2026-02-01T14:52:55+01:00","message":"✓ Engine dependencies available"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","store_backend":"memory","time":"2026-02-01T14:52:55+01:00","message":"engine uses in-memory store; sessions are not persistent across restarts"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","data_dir":"/tmp/xg2g-vod-error-1789512702","time":"2026-02-01T14:52:55+01:00","message":"data directory is under temp; cached data and sessions may be lost on reboot"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:55+01:00","message":"✅ All startup checks passed"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:55+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:55+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"about","time":"2026-02-01T14:52:55+01:00","message":"rate limit wait cancelled"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"getlocations","time":"2026-02-01T14:52:55+01:00","message":"rate limit wait cancelled"}
{"level":"info","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/313a303a303a303a303a303a303a303a303a303a2f6864642f6d6f7669652f6d697373696e672e7473/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"754cf804-189e-4834-9065-9d87eed6879c","event":"request.handled","status":404,"duration":0.152162,"time":"2026-02-01T14:52:55+01:00","message":"http request"}
--- PASS: TestVODPlayback_Path_Wiring_ErrorPath (0.00s)
=== RUN   TestVODPlayback_Path_Wiring_SuccessPath
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:55+01:00","message":"Running pre-flight startup checks..."}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","path":"/tmp/xg2g-vod-success-3099588608","time":"2026-02-01T14:52:55+01:00","message":"✓ Data directory is writable"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","addr":":0","time":"2026-02-01T14:52:55+01:00","message":"✓ API listen address is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","url":"http://mock-receiver","time":"2026-02-01T14:52:55+01:00","message":"✓ OWI Base URL is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","ffmpeg":"/usr/bin/ffmpeg","time":"2026-02-01T14:52:55+01:00","message":"✓ Engine dependencies available"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","store_backend":"memory","time":"2026-02-01T14:52:55+01:00","message":"engine uses in-memory store; sessions are not persistent across restarts"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","data_dir":"/tmp/xg2g-vod-success-3099588608","time":"2026-02-01T14:52:55+01:00","message":"data directory is under temp; cached data and sessions may be lost on reboot"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:55+01:00","message":"✅ All startup checks passed"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:55+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:55+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"about","time":"2026-02-01T14:52:55+01:00","message":"rate limit wait cancelled"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"getlocations","time":"2026-02-01T14:52:55+01:00","message":"rate limit wait cancelled"}
    vod_path_test.go:220: Injecting mock service...
    vod_path_test.go:222: Mock service injected
{"level":"info","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/313a303a303a303a303a303a303a303a303a303a2f6864642f6d6f7669652f66696c6d2e7473/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"88ca5167-aefe-408a-8934-5e95afa7ceb7","event":"request.handled","status":200,"duration":0.584774,"time":"2026-02-01T14:52:55+01:00","message":"http request"}
--- PASS: TestVODPlayback_Path_Wiring_SuccessPath (0.00s)
=== RUN   TestVODPlayback_Path_Wiring_ScopeEnforcement
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:55+01:00","message":"Running pre-flight startup checks..."}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","path":"/tmp/xg2g-vod-scope-3041298881","time":"2026-02-01T14:52:55+01:00","message":"✓ Data directory is writable"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","addr":":0","time":"2026-02-01T14:52:55+01:00","message":"✓ API listen address is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","url":"http://mock-receiver","time":"2026-02-01T14:52:55+01:00","message":"✓ OWI Base URL is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","ffmpeg":"/usr/bin/ffmpeg","time":"2026-02-01T14:52:55+01:00","message":"✓ Engine dependencies available"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","store_backend":"memory","time":"2026-02-01T14:52:55+01:00","message":"engine uses in-memory store; sessions are not persistent across restarts"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","data_dir":"/tmp/xg2g-vod-scope-3041298881","time":"2026-02-01T14:52:55+01:00","message":"data directory is under temp; cached data and sessions may be lost on reboot"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:55+01:00","message":"✅ All startup checks passed"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:55+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:55+01:00","message":"receiver rate limiting enabled"}
{"level":"error","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","event":"openwebif.request","operation":"about","method":"GET","endpoint":"/api/about","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"network","error":"Get \"http://mock-receiver/api/about\": context canceled","time":"2026-02-01T14:52:55+01:00","message":"openwebif request failed"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"getlocations","time":"2026-02-01T14:52:55+01:00","message":"rate limit wait cancelled"}
=== RUN   TestVODPlayback_Path_Wiring_ScopeEnforcement/MissingScope_Forbidden
{"level":"warn","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/any-id/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"5c2ee923-08fb-4792-8be8-5a3a251ed059","component":"authz","required_scopes":["v3:read"],"token_scopes":["v3:status"],"time":"2026-02-01T14:52:55+01:00","message":"insufficient scopes for request"}
{"level":"info","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/any-id/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"5c2ee923-08fb-4792-8be8-5a3a251ed059","event":"request.handled","status":403,"duration":0.280631,"time":"2026-02-01T14:52:55+01:00","message":"http request"}
=== RUN   TestVODPlayback_Path_Wiring_ScopeEnforcement/NoAuth_Unauthorized
{"level":"warn","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/any-id/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"1079d23f-3663-426c-b1a0-2f94e4555222","component":"auth","event":"auth.missing_header","time":"2026-02-01T14:52:55+01:00","message":"authorization header/cookie missing"}
{"level":"info","service":"xg2g","version":"test-v3","method":"GET","path":"/api/v3/recordings/any-id/stream-info","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"1079d23f-3663-426c-b1a0-2f94e4555222","event":"request.handled","status":401,"duration":0.122197,"time":"2026-02-01T14:52:55+01:00","message":"http request"}
--- PASS: TestVODPlayback_Path_Wiring_ScopeEnforcement (0.01s)
    --- PASS: TestVODPlayback_Path_Wiring_ScopeEnforcement/MissingScope_Forbidden (0.00s)
    --- PASS: TestVODPlayback_Path_Wiring_ScopeEnforcement/NoAuth_Unauthorized (0.00s)
=== RUN   TestWiring_BootsMinimalStack
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:55+01:00","message":"Running pre-flight startup checks..."}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","path":"/tmp/xg2g-wiring-3341691607","time":"2026-02-01T14:52:55+01:00","message":"✓ Data directory is writable"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","addr":":0","time":"2026-02-01T14:52:55+01:00","message":"✓ API listen address is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","url":"http://mock-receiver","time":"2026-02-01T14:52:55+01:00","message":"✓ OWI Base URL is valid"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","ffmpeg":"/usr/bin/ffmpeg","time":"2026-02-01T14:52:55+01:00","message":"✓ Engine dependencies available"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","store_backend":"memory","time":"2026-02-01T14:52:55+01:00","message":"engine uses in-memory store; sessions are not persistent across restarts"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"startup-check","data_dir":"/tmp/xg2g-wiring-3341691607","time":"2026-02-01T14:52:55+01:00","message":"data directory is under temp; cached data and sessions may be lost on reboot"}
{"level":"info","service":"xg2g","version":"test-v3","component":"startup-check","time":"2026-02-01T14:52:55+01:00","message":"✅ All startup checks passed"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:55+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:52:55+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"about","time":"2026-02-01T14:52:55+01:00","message":"rate limit wait cancelled"}
{"level":"warn","service":"xg2g","version":"test-v3","component":"openwebif","host":"mock-receiver","error":"context canceled","event":"openwebif.rate_limit","operation":"getlocations","time":"2026-02-01T14:52:55+01:00","message":"rate limit wait cancelled"}
{"level":"info","service":"xg2g","version":"test-v3","method":"GET","path":"/healthz","remote_addr":"192.0.2.1:1234","user_agent":"","request_id":"02e5c11f-fe40-4757-8750-0425b972901e","event":"request.handled","status":200,"duration":0.238993,"time":"2026-02-01T14:52:55+01:00","message":"http request"}
--- PASS: TestWiring_BootsMinimalStack (0.01s)
PASS
coverage: 49.4% of statements
ok  	github.com/ManuGH/xg2g/internal/app/bootstrap	1.229s	coverage: 49.4% of statements
?   	github.com/ManuGH/xg2g/internal/auth	[no test files]
=== RUN   TestMemoryCache_GetSet
--- PASS: TestMemoryCache_GetSet (0.00s)
=== RUN   TestMemoryCache_Expiration
--- PASS: TestMemoryCache_Expiration (0.10s)
=== RUN   TestMemoryCache_Delete
--- PASS: TestMemoryCache_Delete (0.00s)
=== RUN   TestMemoryCache_Clear
--- PASS: TestMemoryCache_Clear (0.00s)
=== RUN   TestMemoryCache_Stats
--- PASS: TestMemoryCache_Stats (0.00s)
=== RUN   TestMemoryCache_Janitor
--- PASS: TestMemoryCache_Janitor (0.15s)
=== RUN   TestMemoryCache_ConcurrentAccess
--- PASS: TestMemoryCache_ConcurrentAccess (0.11s)
=== RUN   TestNoOpCache
--- PASS: TestNoOpCache (0.00s)
=== RUN   TestRedisCache_SetGet
--- PASS: TestRedisCache_SetGet (0.00s)
=== RUN   TestRedisCache_GetMissing
--- PASS: TestRedisCache_GetMissing (0.00s)
=== RUN   TestRedisCache_TTL
--- PASS: TestRedisCache_TTL (0.00s)
=== RUN   TestRedisCache_Delete
--- PASS: TestRedisCache_Delete (0.00s)
=== RUN   TestRedisCache_Clear
--- PASS: TestRedisCache_Clear (0.00s)
=== RUN   TestRedisCache_ComplexData
--- PASS: TestRedisCache_ComplexData (0.00s)
=== RUN   TestRedisCache_Stats
--- PASS: TestRedisCache_Stats (0.00s)
=== RUN   TestRedisCache_HealthCheck
redis: 2026/01/28 08:45:32 pool.go:419: redis: connection pool: failed to dial after 5 attempts: dial tcp 127.0.0.1:44271: connect: connection refused
redis: 2026/01/28 08:45:32 pool.go:419: redis: connection pool: failed to dial after 5 attempts: dial tcp 127.0.0.1:44271: connect: connection refused
redis: 2026/01/28 08:45:33 pool.go:419: redis: connection pool: failed to dial after 5 attempts: dial tcp 127.0.0.1:44271: connect: connection refused
redis: 2026/01/28 08:45:33 pool.go:419: redis: connection pool: failed to dial after 5 attempts: dial tcp 127.0.0.1:44271: connect: connection refused
--- PASS: TestRedisCache_HealthCheck (2.08s)
=== RUN   TestRedisCache_ConcurrentAccess
--- PASS: TestRedisCache_ConcurrentAccess (0.04s)
PASS
coverage: 78.6% of statements
ok  	github.com/ManuGH/xg2g/internal/cache	(cached)	coverage: 78.6% of statements
=== RUN   TestAliasConflictOpenWebIFEnigma2
=== RUN   TestAliasConflictOpenWebIFEnigma2/only_openWebIF_set
=== RUN   TestAliasConflictOpenWebIFEnigma2/only_enigma2_set
=== RUN   TestAliasConflictOpenWebIFEnigma2/both_set_same
=== RUN   TestAliasConflictOpenWebIFEnigma2/both_set_differ
--- PASS: TestAliasConflictOpenWebIFEnigma2 (0.01s)
    --- PASS: TestAliasConflictOpenWebIFEnigma2/only_openWebIF_set (0.00s)
    --- PASS: TestAliasConflictOpenWebIFEnigma2/only_enigma2_set (0.00s)
    --- PASS: TestAliasConflictOpenWebIFEnigma2/both_set_same (0.00s)
    --- PASS: TestAliasConflictOpenWebIFEnigma2/both_set_differ (0.00s)
=== RUN   TestAliasConflictEnvToEnv
=== RUN   TestAliasConflictEnvToEnv/env_mismatch_fails
=== RUN   TestAliasConflictEnvToEnv/env_match_passes
--- PASS: TestAliasConflictEnvToEnv (0.00s)
    --- PASS: TestAliasConflictEnvToEnv/env_mismatch_fails (0.00s)
    --- PASS: TestAliasConflictEnvToEnv/env_match_passes (0.00s)
=== RUN   TestAliasConflictYamlVsEnv
=== RUN   TestAliasConflictYamlVsEnv/yaml_openWebIF_vs_env_enigma2_mismatch
=== RUN   TestAliasConflictYamlVsEnv/yaml_enigma2_vs_env_openWebIF_mismatch
--- PASS: TestAliasConflictYamlVsEnv (0.00s)
    --- PASS: TestAliasConflictYamlVsEnv/yaml_openWebIF_vs_env_enigma2_mismatch (0.00s)
    --- PASS: TestAliasConflictYamlVsEnv/yaml_enigma2_vs_env_openWebIF_mismatch (0.00s)
=== RUN   TestE2AuthMode_None
=== RUN   TestE2AuthMode_None/none:_OWI_set,_E2_empty_=>_E2_stays_empty
=== RUN   TestE2AuthMode_None/none:_E2_set_=>_fail
=== RUN   TestE2AuthMode_None/none:_E2_partial_=>_fail
--- PASS: TestE2AuthMode_None (0.00s)
    --- PASS: TestE2AuthMode_None/none:_OWI_set,_E2_empty_=>_E2_stays_empty (0.00s)
    --- PASS: TestE2AuthMode_None/none:_E2_set_=>_fail (0.00s)
    --- PASS: TestE2AuthMode_None/none:_E2_partial_=>_fail (0.00s)
=== RUN   TestE2AuthMode_Explicit
=== RUN   TestE2AuthMode_Explicit/explicit:_empty_=>_ok
=== RUN   TestE2AuthMode_Explicit/explicit:_both_set_=>_ok
=== RUN   TestE2AuthMode_Explicit/explicit:_partial_=>_fail
--- PASS: TestE2AuthMode_Explicit (0.00s)
    --- PASS: TestE2AuthMode_Explicit/explicit:_empty_=>_ok (0.00s)
    --- PASS: TestE2AuthMode_Explicit/explicit:_both_set_=>_ok (0.00s)
    --- PASS: TestE2AuthMode_Explicit/explicit:_partial_=>_fail (0.00s)
=== RUN   TestE2AuthMode_InvalidEnum
--- PASS: TestE2AuthMode_InvalidEnum (0.00s)
=== RUN   TestE2AuthMode_Normalization
=== RUN   TestE2AuthMode_Normalization/uppercase
=== RUN   TestE2AuthMode_Normalization/mixed_case
=== RUN   TestE2AuthMode_Normalization/whitespace
=== RUN   TestE2AuthMode_Normalization/tabs
--- PASS: TestE2AuthMode_Normalization (0.00s)
    --- PASS: TestE2AuthMode_Normalization/uppercase (0.00s)
    --- PASS: TestE2AuthMode_Normalization/mixed_case (0.00s)
    --- PASS: TestE2AuthMode_Normalization/whitespace (0.00s)
    --- PASS: TestE2AuthMode_Normalization/tabs (0.00s)
=== RUN   TestConfigAudit_FieldCoverage
--- PASS: TestConfigAudit_FieldCoverage (0.00s)
=== RUN   TestConfigAudit_RegistryIntegrity
--- PASS: TestConfigAudit_RegistryIntegrity (0.00s)
=== RUN   TestConfigAudit_StrictLoadingFailsOnUnknownKey
--- PASS: TestConfigAudit_StrictLoadingFailsOnUnknownKey (0.00s)
=== RUN   TestConfigAudit_StrictLoadingFailsOnNestedUnknownKey
--- PASS: TestConfigAudit_StrictLoadingFailsOnNestedUnknownKey (0.00s)
=== RUN   TestConfigGovernance_ForbiddenCombination_ProxyAware
--- PASS: TestConfigGovernance_ForbiddenCombination_ProxyAware (0.00s)
=== RUN   TestConfigAudit_RegistryDefaultsTypes
--- PASS: TestConfigAudit_RegistryDefaultsTypes (0.00s)
=== RUN   TestConfigAudit_RegistryTruth_Defaults
    config_audit_test.go:177: Loader validation error ignored for defaults audit: config validation failed: validation failed for Enigma2.BaseURL: URL cannot be empty
--- PASS: TestConfigAudit_RegistryTruth_Defaults (0.00s)
=== RUN   TestConfigAudit_RegistryTruth_EnvKeys
--- PASS: TestConfigAudit_RegistryTruth_EnvKeys (0.00s)
=== RUN   TestConfigAudit_PointerDefaults_PreserveZeroValues
=== RUN   TestConfigAudit_PointerDefaults_PreserveZeroValues/ApplyDefaultToNil
=== RUN   TestConfigAudit_PointerDefaults_PreserveZeroValues/PreserveExplicitFalse
--- PASS: TestConfigAudit_PointerDefaults_PreserveZeroValues (0.00s)
    --- PASS: TestConfigAudit_PointerDefaults_PreserveZeroValues/ApplyDefaultToNil (0.00s)
    --- PASS: TestConfigAudit_PointerDefaults_PreserveZeroValues/PreserveExplicitFalse (0.00s)
=== RUN   TestConfigGovernance_DeprecationFail
--- PASS: TestConfigGovernance_DeprecationFail (0.00s)
=== RUN   TestConfigGovernance_DeprecationWarn
{"level":"warn","service":"xg2g","version":"","component":"config","source":"ENV: XG2G_STREAM_PORT","target":"enigma2.streamPort","time":"2026-02-01T14:52:55+01:00","message":"DEPRECATED: Use YAML config for streaming ports; ENV override will be removed in v3.5 (ADR-00X)"}
--- PASS: TestConfigGovernance_DeprecationWarn (0.00s)
=== RUN   TestLoad_ValidMinimal
--- PASS: TestLoad_ValidMinimal (0.00s)
=== RUN   TestLoad_UnknownKeyFails
--- PASS: TestLoad_UnknownKeyFails (0.00s)
=== RUN   TestLoad_InvalidTypeFails
--- PASS: TestLoad_InvalidTypeFails (0.00s)
=== RUN   TestLoad_ValidationFails
--- PASS: TestLoad_ValidationFails (0.00s)
=== RUN   TestParseString
=== RUN   TestParseString/environment_variable_set
=== RUN   TestParseString/environment_variable_not_set
=== RUN   TestParseString/environment_variable_empty_string
=== RUN   TestParseString/sensitive_variable_(password)
--- PASS: TestParseString (0.00s)
    --- PASS: TestParseString/environment_variable_set (0.00s)
    --- PASS: TestParseString/environment_variable_not_set (0.00s)
    --- PASS: TestParseString/environment_variable_empty_string (0.00s)
    --- PASS: TestParseString/sensitive_variable_(password) (0.00s)
=== RUN   TestParseInt
=== RUN   TestParseInt/valid_integer
=== RUN   TestParseInt/invalid_integer
{"level":"warn","service":"xg2g","version":"","component":"config","key":"TEST_INT_INVALID","value":"not-a-number","default":42,"time":"2026-02-01T14:52:55+01:00","message":"invalid integer in environment variable, using default"}
=== RUN   TestParseInt/empty_string
=== RUN   TestParseInt/not_set
--- PASS: TestParseInt (0.00s)
    --- PASS: TestParseInt/valid_integer (0.00s)
    --- PASS: TestParseInt/invalid_integer (0.00s)
    --- PASS: TestParseInt/empty_string (0.00s)
    --- PASS: TestParseInt/not_set (0.00s)
=== RUN   TestParseDuration
=== RUN   TestParseDuration/valid_duration
=== RUN   TestParseDuration/complex_duration
=== RUN   TestParseDuration/invalid_duration
{"level":"warn","service":"xg2g","version":"","component":"config","key":"TEST_DURATION_INVALID","value":"not-a-duration","default":5000,"time":"2026-02-01T14:52:55+01:00","message":"invalid duration in environment variable, using default"}
=== RUN   TestParseDuration/empty_string
=== RUN   TestParseDuration/not_set
--- PASS: TestParseDuration (0.00s)
    --- PASS: TestParseDuration/valid_duration (0.00s)
    --- PASS: TestParseDuration/complex_duration (0.00s)
    --- PASS: TestParseDuration/invalid_duration (0.00s)
    --- PASS: TestParseDuration/empty_string (0.00s)
    --- PASS: TestParseDuration/not_set (0.00s)
=== RUN   TestParseBool
=== RUN   TestParseBool/true_string
=== RUN   TestParseBool/TRUE_uppercase
=== RUN   TestParseBool/1_as_true
=== RUN   TestParseBool/yes_as_true
=== RUN   TestParseBool/false_string
=== RUN   TestParseBool/0_as_false
=== RUN   TestParseBool/no_as_false
=== RUN   TestParseBool/invalid_boolean
{"level":"warn","service":"xg2g","version":"","component":"config","key":"TEST_BOOL_INVALID","value":"maybe","default":true,"time":"2026-02-01T14:52:55+01:00","message":"invalid boolean in environment variable, using default"}
=== RUN   TestParseBool/empty_string
=== RUN   TestParseBool/not_set
--- PASS: TestParseBool (0.00s)
    --- PASS: TestParseBool/true_string (0.00s)
    --- PASS: TestParseBool/TRUE_uppercase (0.00s)
    --- PASS: TestParseBool/1_as_true (0.00s)
    --- PASS: TestParseBool/yes_as_true (0.00s)
    --- PASS: TestParseBool/false_string (0.00s)
    --- PASS: TestParseBool/0_as_false (0.00s)
    --- PASS: TestParseBool/no_as_false (0.00s)
    --- PASS: TestParseBool/invalid_boolean (0.00s)
    --- PASS: TestParseBool/empty_string (0.00s)
    --- PASS: TestParseBool/not_set (0.00s)
=== RUN   TestLoadDefaults
--- PASS: TestLoadDefaults (0.00s)
=== RUN   TestLoadFromYAML
--- PASS: TestLoadFromYAML (0.00s)
=== RUN   TestENVOverridesFile
{"level":"warn","service":"xg2g","version":"","component":"config","source":"ENV: XG2G_STREAM_PORT","target":"enigma2.streamPort","time":"2026-02-01T14:52:55+01:00","message":"DEPRECATED: Use YAML config for streaming ports; ENV override will be removed in v3.5 (ADR-00X)"}
--- PASS: TestENVOverridesFile (0.00s)
=== RUN   TestPrecedenceOrder
--- PASS: TestPrecedenceOrder (0.00s)
=== RUN   TestValidateEPGBounds
=== RUN   TestValidateEPGBounds/valid_EPG_config
=== RUN   TestValidateEPGBounds/EPGTimeoutMS_too_low
=== RUN   TestValidateEPGBounds/EPGTimeoutMS_too_high
=== RUN   TestValidateEPGBounds/EPGRetries_too_high
=== RUN   TestValidateEPGBounds/FuzzyMax_too_high
--- PASS: TestValidateEPGBounds (0.00s)
    --- PASS: TestValidateEPGBounds/valid_EPG_config (0.00s)
    --- PASS: TestValidateEPGBounds/EPGTimeoutMS_too_low (0.00s)
    --- PASS: TestValidateEPGBounds/EPGTimeoutMS_too_high (0.00s)
    --- PASS: TestValidateEPGBounds/EPGRetries_too_high (0.00s)
    --- PASS: TestValidateEPGBounds/FuzzyMax_too_high (0.00s)
=== RUN   TestOWIMaxBackoffFromENV
=== RUN   TestOWIMaxBackoffFromENV/default_value
=== RUN   TestOWIMaxBackoffFromENV/custom_value_2s
=== RUN   TestOWIMaxBackoffFromENV/custom_value_5s
=== RUN   TestOWIMaxBackoffFromENV/custom_value_10s
=== RUN   TestOWIMaxBackoffFromENV/custom_value_30s
--- PASS: TestOWIMaxBackoffFromENV (0.00s)
    --- PASS: TestOWIMaxBackoffFromENV/default_value (0.00s)
    --- PASS: TestOWIMaxBackoffFromENV/custom_value_2s (0.00s)
    --- PASS: TestOWIMaxBackoffFromENV/custom_value_5s (0.00s)
    --- PASS: TestOWIMaxBackoffFromENV/custom_value_10s (0.00s)
    --- PASS: TestOWIMaxBackoffFromENV/custom_value_30s (0.00s)
=== RUN   TestOWIMaxBackoffFromFile
=== RUN   TestOWIMaxBackoffFromFile/2_seconds
=== RUN   TestOWIMaxBackoffFromFile/5_seconds
=== RUN   TestOWIMaxBackoffFromFile/10_seconds
=== RUN   TestOWIMaxBackoffFromFile/30_seconds
=== RUN   TestOWIMaxBackoffFromFile/milliseconds
--- PASS: TestOWIMaxBackoffFromFile (0.01s)
    --- PASS: TestOWIMaxBackoffFromFile/2_seconds (0.00s)
    --- PASS: TestOWIMaxBackoffFromFile/5_seconds (0.00s)
    --- PASS: TestOWIMaxBackoffFromFile/10_seconds (0.00s)
    --- PASS: TestOWIMaxBackoffFromFile/30_seconds (0.00s)
    --- PASS: TestOWIMaxBackoffFromFile/milliseconds (0.00s)
=== RUN   TestOWIMaxBackoffENVOverridesFile
--- PASS: TestOWIMaxBackoffENVOverridesFile (0.00s)
=== RUN   TestOWIBackoffConfigConsistency
--- PASS: TestOWIBackoffConfigConsistency (0.00s)
=== RUN   TestOWIMaxBackoffInvalidValues
=== RUN   TestOWIMaxBackoffInvalidValues/invalid_string
{"level":"warn","service":"xg2g","version":"","component":"config","key":"XG2G_OWI_MAX_BACKOFF_MS","value":"not-a-number","default":0,"time":"2026-02-01T14:52:55+01:00","message":"invalid integer in environment variable, using default"}
=== RUN   TestOWIMaxBackoffInvalidValues/negative_value
=== RUN   TestOWIMaxBackoffInvalidValues/zero_value
=== RUN   TestOWIMaxBackoffInvalidValues/empty_string
--- PASS: TestOWIMaxBackoffInvalidValues (0.00s)
    --- PASS: TestOWIMaxBackoffInvalidValues/invalid_string (0.00s)
    --- PASS: TestOWIMaxBackoffInvalidValues/negative_value (0.00s)
    --- PASS: TestOWIMaxBackoffInvalidValues/zero_value (0.00s)
    --- PASS: TestOWIMaxBackoffInvalidValues/empty_string (0.00s)
=== RUN   TestYAMLCanDisableFeatures
--- PASS: TestYAMLCanDisableFeatures (0.00s)
=== RUN   TestParseScopedTokensFromEnv
=== RUN   TestParseScopedTokensFromEnv/json_format
=== RUN   TestParseScopedTokensFromEnv/legacy_format
{"level":"warn","service":"xg2g","version":"","component":"config","key":"XG2G_API_TOKENS","time":"2026-02-01T14:52:55+01:00","message":"legacy token format detected; JSON array is recommended"}
=== RUN   TestParseScopedTokensFromEnv/invalid_json_errors
=== RUN   TestParseScopedTokensFromEnv/legacy_missing_scopes_errors
{"level":"warn","service":"xg2g","version":"","component":"config","key":"XG2G_API_TOKENS","time":"2026-02-01T14:52:55+01:00","message":"legacy token format detected; JSON array is recommended"}
=== RUN   TestParseScopedTokensFromEnv/unknown_scope_errors
--- PASS: TestParseScopedTokensFromEnv (0.01s)
    --- PASS: TestParseScopedTokensFromEnv/json_format (0.00s)
    --- PASS: TestParseScopedTokensFromEnv/legacy_format (0.00s)
    --- PASS: TestParseScopedTokensFromEnv/invalid_json_errors (0.00s)
    --- PASS: TestParseScopedTokensFromEnv/legacy_missing_scopes_errors (0.00s)
    --- PASS: TestParseScopedTokensFromEnv/unknown_scope_errors (0.00s)
=== RUN   TestAPITokenRequiresScopes
--- PASS: TestAPITokenRequiresScopes (0.00s)
=== RUN   TestYAMLRejectsMissingTokenScopes
--- PASS: TestYAMLRejectsMissingTokenScopes (0.00s)
=== RUN   TestYAMLRejectsTokenWithoutScopes
--- PASS: TestYAMLRejectsTokenWithoutScopes (0.00s)
=== RUN   TestConfigLoggerDoesNotPanic
{"level":"warn","service":"xg2g","version":"","component":"config","time":"2026-02-01T14:52:55+01:00","message":"logger sanity check"}
--- PASS: TestConfigLoggerDoesNotPanic (0.00s)
=== RUN   TestMaskSecrets_SimpleMap
--- PASS: TestMaskSecrets_SimpleMap (0.00s)
=== RUN   TestMaskSecrets_NestedMap
--- PASS: TestMaskSecrets_NestedMap (0.00s)
=== RUN   TestMaskSecrets_Struct
--- PASS: TestMaskSecrets_Struct (0.00s)
=== RUN   TestMaskSecrets_FileConfig
--- PASS: TestMaskSecrets_FileConfig (0.00s)
=== RUN   TestMaskSecrets_Slice
--- PASS: TestMaskSecrets_Slice (0.00s)
=== RUN   TestMaskSecrets_CaseInsensitive
=== RUN   TestMaskSecrets_CaseInsensitive/lowercase
=== RUN   TestMaskSecrets_CaseInsensitive/uppercase
=== RUN   TestMaskSecrets_CaseInsensitive/mixedcase
=== RUN   TestMaskSecrets_CaseInsensitive/with_underscore
=== RUN   TestMaskSecrets_CaseInsensitive/with_Token
--- PASS: TestMaskSecrets_CaseInsensitive (0.00s)
    --- PASS: TestMaskSecrets_CaseInsensitive/lowercase (0.00s)
    --- PASS: TestMaskSecrets_CaseInsensitive/uppercase (0.00s)
    --- PASS: TestMaskSecrets_CaseInsensitive/mixedcase (0.00s)
    --- PASS: TestMaskSecrets_CaseInsensitive/with_underscore (0.00s)
    --- PASS: TestMaskSecrets_CaseInsensitive/with_Token (0.00s)
=== RUN   TestMaskSecrets_Nil
--- PASS: TestMaskSecrets_Nil (0.00s)
=== RUN   TestMaskSecrets_Primitives
=== RUN   TestMaskSecrets_Primitives/int
=== RUN   TestMaskSecrets_Primitives/bool
=== RUN   TestMaskSecrets_Primitives/float
=== RUN   TestMaskSecrets_Primitives/string
--- PASS: TestMaskSecrets_Primitives (0.00s)
    --- PASS: TestMaskSecrets_Primitives/int (0.00s)
    --- PASS: TestMaskSecrets_Primitives/bool (0.00s)
    --- PASS: TestMaskSecrets_Primitives/float (0.00s)
    --- PASS: TestMaskSecrets_Primitives/string (0.00s)
=== RUN   TestIsSensitiveKey
=== RUN   TestIsSensitiveKey/password
=== RUN   TestIsSensitiveKey/Password
=== RUN   TestIsSensitiveKey/PASSWORD
=== RUN   TestIsSensitiveKey/userPassword
=== RUN   TestIsSensitiveKey/token
=== RUN   TestIsSensitiveKey/apiToken
=== RUN   TestIsSensitiveKey/api_key
=== RUN   TestIsSensitiveKey/apiKey
=== RUN   TestIsSensitiveKey/secret
=== RUN   TestIsSensitiveKey/secretKey
=== RUN   TestIsSensitiveKey/credential
=== RUN   TestIsSensitiveKey/auth
=== RUN   TestIsSensitiveKey/authToken
=== RUN   TestIsSensitiveKey/username
=== RUN   TestIsSensitiveKey/host
=== RUN   TestIsSensitiveKey/port
=== RUN   TestIsSensitiveKey/dataDir
--- PASS: TestIsSensitiveKey (0.00s)
    --- PASS: TestIsSensitiveKey/password (0.00s)
    --- PASS: TestIsSensitiveKey/Password (0.00s)
    --- PASS: TestIsSensitiveKey/PASSWORD (0.00s)
    --- PASS: TestIsSensitiveKey/userPassword (0.00s)
    --- PASS: TestIsSensitiveKey/token (0.00s)
    --- PASS: TestIsSensitiveKey/apiToken (0.00s)
    --- PASS: TestIsSensitiveKey/api_key (0.00s)
    --- PASS: TestIsSensitiveKey/apiKey (0.00s)
    --- PASS: TestIsSensitiveKey/secret (0.00s)
    --- PASS: TestIsSensitiveKey/secretKey (0.00s)
    --- PASS: TestIsSensitiveKey/credential (0.00s)
    --- PASS: TestIsSensitiveKey/auth (0.00s)
    --- PASS: TestIsSensitiveKey/authToken (0.00s)
    --- PASS: TestIsSensitiveKey/username (0.00s)
    --- PASS: TestIsSensitiveKey/host (0.00s)
    --- PASS: TestIsSensitiveKey/port (0.00s)
    --- PASS: TestIsSensitiveKey/dataDir (0.00s)
=== RUN   TestMaskURLCredentials
=== RUN   TestMaskURLCredentials/empty
=== RUN   TestMaskURLCredentials/no_credentials
=== RUN   TestMaskURLCredentials/http_with_credentials
=== RUN   TestMaskURLCredentials/https_with_credentials
=== RUN   TestMaskURLCredentials/complex_credentials
--- PASS: TestMaskURLCredentials (0.00s)
    --- PASS: TestMaskURLCredentials/empty (0.00s)
    --- PASS: TestMaskURLCredentials/no_credentials (0.00s)
    --- PASS: TestMaskURLCredentials/http_with_credentials (0.00s)
    --- PASS: TestMaskURLCredentials/https_with_credentials (0.00s)
    --- PASS: TestMaskURLCredentials/complex_credentials (0.00s)
=== RUN   TestWorkerEnvMergePreservesConfigValues
--- PASS: TestWorkerEnvMergePreservesConfigValues (0.00s)
=== RUN   TestInvalidTunerSlotsEnvPreservesConfig
--- PASS: TestInvalidTunerSlotsEnvPreservesConfig (0.00s)
=== RUN   TestEmptyTunerSlotsEnvPreservesConfig
--- PASS: TestEmptyTunerSlotsEnvPreservesConfig (0.00s)
=== RUN   TestParseRecordingMappings
=== RUN   TestParseRecordingMappings/empty_string_returns_defaults
=== RUN   TestParseRecordingMappings/single_mapping
=== RUN   TestParseRecordingMappings/multiple_mappings
=== RUN   TestParseRecordingMappings/whitespace_handling
=== RUN   TestParseRecordingMappings/invalid_format_returns_defaults
=== RUN   TestParseRecordingMappings/empty_entries_skipped
--- PASS: TestParseRecordingMappings (0.00s)
    --- PASS: TestParseRecordingMappings/empty_string_returns_defaults (0.00s)
    --- PASS: TestParseRecordingMappings/single_mapping (0.00s)
    --- PASS: TestParseRecordingMappings/multiple_mappings (0.00s)
    --- PASS: TestParseRecordingMappings/whitespace_handling (0.00s)
    --- PASS: TestParseRecordingMappings/invalid_format_returns_defaults (0.00s)
    --- PASS: TestParseRecordingMappings/empty_entries_skipped (0.00s)
=== RUN   TestNewConfigHolder
--- PASS: TestNewConfigHolder (0.00s)
=== RUN   TestConfigHolder_Swap_AssignsMonotonicEpoch
--- PASS: TestConfigHolder_Swap_AssignsMonotonicEpoch (0.00s)
=== RUN   TestConfigHolder_Get
--- PASS: TestConfigHolder_Get (0.00s)
=== RUN   TestConfigHolder_Reload_Success
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_start","time":"2026-02-01T14:52:55+01:00","message":"reloading configuration"}
{"level":"info","service":"xg2g","version":"","component":"config","old":"old-bouquet","new":"new-bouquet","time":"2026-02-01T14:52:55+01:00","message":"config changed: Bouquet"}
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_success","time":"2026-02-01T14:52:55+01:00","message":"configuration reloaded successfully"}
--- PASS: TestConfigHolder_Reload_Success (0.00s)
=== RUN   TestConfigHolder_Reload_ValidationFailure
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_start","time":"2026-02-01T14:52:55+01:00","message":"reloading configuration"}
{"level":"error","service":"xg2g","version":"","component":"config","error":"config validation failed: validation failed for EPGDays: value must be between 1 and 14, got 99","event":"config.reload_failed","time":"2026-02-01T14:52:55+01:00","message":"failed to load new configuration"}
--- PASS: TestConfigHolder_Reload_ValidationFailure (0.00s)
=== RUN   TestConfigHolder_RegisterListener
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_start","time":"2026-02-01T14:52:55+01:00","message":"reloading configuration"}
{"level":"info","service":"xg2g","version":"","component":"config","old":"old","new":"new","time":"2026-02-01T14:52:55+01:00","message":"config changed: Bouquet"}
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_success","time":"2026-02-01T14:52:55+01:00","message":"configuration reloaded successfully"}
--- PASS: TestConfigHolder_RegisterListener (0.00s)
=== RUN   TestConfigHolder_NotifyListeners_NonBlocking
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_start","time":"2026-02-01T14:52:55+01:00","message":"reloading configuration"}
{"level":"warn","service":"xg2g","version":"","component":"config","event":"config.listener_skip","time":"2026-02-01T14:52:55+01:00","message":"skipped notifying listener (channel full)"}
{"level":"info","service":"xg2g","version":"","component":"config","old":"old","new":"new","time":"2026-02-01T14:52:55+01:00","message":"config changed: Bouquet"}
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_success","time":"2026-02-01T14:52:55+01:00","message":"configuration reloaded successfully"}
--- PASS: TestConfigHolder_NotifyListeners_NonBlocking (0.00s)
=== RUN   TestMaskURL
=== RUN   TestMaskURL/empty_url
=== RUN   TestMaskURL/http_url
=== RUN   TestMaskURL/https_url_with_creds
--- PASS: TestMaskURL (0.00s)
    --- PASS: TestMaskURL/empty_url (0.00s)
    --- PASS: TestMaskURL/http_url (0.00s)
    --- PASS: TestMaskURL/https_url_with_creds (0.00s)
=== RUN   TestConfigHolder_ReloadDuringRequest_UsesSingleEpoch
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_start","time":"2026-02-01T14:52:55+01:00","message":"reloading configuration"}
{"level":"info","service":"xg2g","version":"","component":"config","old":"old-bouquet","new":"new-bouquet","time":"2026-02-01T14:52:55+01:00","message":"config changed: Bouquet"}
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_success","time":"2026-02-01T14:52:55+01:00","message":"configuration reloaded successfully"}
--- PASS: TestConfigHolder_ReloadDuringRequest_UsesSingleEpoch (0.00s)
=== RUN   TestConfigHolder_LogChanges
{"level":"info","service":"xg2g","version":"","component":"config","old":"old-bouquet","new":"new-bouquet","time":"2026-02-01T14:52:55+01:00","message":"config changed: Bouquet"}
{"level":"info","service":"xg2g","version":"","component":"config","old":false,"new":true,"time":"2026-02-01T14:52:55+01:00","message":"config changed: EPGEnabled"}
{"level":"info","service":"xg2g","version":"","component":"config","old":3,"new":7,"time":"2026-02-01T14:52:55+01:00","message":"config changed: EPGDays"}
{"level":"info","service":"xg2g","version":"","component":"config","old":8080,"new":9090,"time":"2026-02-01T14:52:55+01:00","message":"config changed: StreamPort"}
--- PASS: TestConfigHolder_LogChanges (0.00s)
=== RUN   TestConfigHolder_Stop
--- PASS: TestConfigHolder_Stop (0.00s)
=== RUN   TestConfigHolder_StartWatcher_EmptyPath
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.watcher_disabled","time":"2026-02-01T14:52:55+01:00","message":"config file watcher disabled (using ENV-only configuration)"}
--- PASS: TestConfigHolder_StartWatcher_EmptyPath (0.00s)
=== RUN   TestConfigHolder_Reload_StrictParseFailure
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_start","time":"2026-02-01T14:52:55+01:00","message":"reloading configuration"}
{"level":"error","service":"xg2g","version":"","component":"config","error":"load config file: strict config parse error (legacy keys found? see docs/guides/CONFIGURATION.md): yaml: unmarshal errors:\n  line 10: field unknownField not found in type config.FileConfig","event":"config.reload_failed","time":"2026-02-01T14:52:55+01:00","message":"failed to load new configuration"}
--- PASS: TestConfigHolder_Reload_StrictParseFailure (0.00s)
=== RUN   TestConfigHolder_Reload_TypeMismatch
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_start","time":"2026-02-01T14:52:55+01:00","message":"reloading configuration"}
{"level":"error","service":"xg2g","version":"","component":"config","error":"load config file: strict config parse error: yaml: unmarshal errors:\n  line 9: cannot unmarshal !!str `seven` into int","event":"config.reload_failed","time":"2026-02-01T14:52:55+01:00","message":"failed to load new configuration"}
--- PASS: TestConfigHolder_Reload_TypeMismatch (0.00s)
=== RUN   TestConfigHolder_Reload_BusinessLogicFailure
{"level":"info","service":"xg2g","version":"","component":"config","event":"config.reload_start","time":"2026-02-01T14:52:55+01:00","message":"reloading configuration"}
{"level":"error","service":"xg2g","version":"","component":"config","error":"config validation failed: validation failed for EPGDays: value must be between 1 and 14, got 99","event":"config.reload_failed","time":"2026-02-01T14:52:55+01:00","message":"failed to load new configuration"}
--- PASS: TestConfigHolder_Reload_BusinessLogicFailure (0.00s)
=== RUN   TestResilienceDefaults
--- PASS: TestResilienceDefaults (0.00s)
=== RUN   TestResilienceZeroOverrides
--- PASS: TestResilienceZeroOverrides (0.00s)
=== RUN   TestFailOpenBooleans
--- PASS: TestFailOpenBooleans (0.00s)
=== RUN   TestLimitsEnv
--- PASS: TestLimitsEnv (0.00s)
=== RUN   TestResilienceValidation
=== RUN   TestResilienceValidation/MaxSessions_<_1
=== RUN   TestResilienceValidation/MaxTranscodes_<_0
=== RUN   TestResilienceValidation/TranscodeStart_<=_0
=== RUN   TestResilienceValidation/TranscodeNoProgress_<=_TranscodeStart
=== RUN   TestResilienceValidation/KillGrace_<=_0
=== RUN   TestResilienceValidation/KillGrace_>=_TranscodeNoProgress
=== RUN   TestResilienceValidation/Breaker.Window_<=_0
=== RUN   TestResilienceValidation/Breaker.MinAttempts_<_1
=== RUN   TestResilienceValidation/Breaker.FailuresThreshold_<_1
--- PASS: TestResilienceValidation (0.01s)
    --- PASS: TestResilienceValidation/MaxSessions_<_1 (0.00s)
    --- PASS: TestResilienceValidation/MaxTranscodes_<_0 (0.00s)
    --- PASS: TestResilienceValidation/TranscodeStart_<=_0 (0.00s)
    --- PASS: TestResilienceValidation/TranscodeNoProgress_<=_TranscodeStart (0.00s)
    --- PASS: TestResilienceValidation/KillGrace_<=_0 (0.00s)
    --- PASS: TestResilienceValidation/KillGrace_>=_TranscodeNoProgress (0.00s)
    --- PASS: TestResilienceValidation/Breaker.Window_<=_0 (0.00s)
    --- PASS: TestResilienceValidation/Breaker.MinAttempts_<_1 (0.00s)
    --- PASS: TestResilienceValidation/Breaker.FailuresThreshold_<_1 (0.00s)
=== RUN   TestParseServerConfig
=== RUN   TestParseServerConfig/defaults_when_no_env_vars_set
=== RUN   TestParseServerConfig/custom_values_from_env_vars
=== RUN   TestParseServerConfig/invalid_values_fall_back_to_defaults
{"level":"warn","service":"xg2g","version":"","component":"config","key":"XG2G_SERVER_READ_TIMEOUT","value":"invalid","default":60000,"time":"2026-02-01T14:52:55+01:00","message":"invalid duration in environment variable, using default"}
{"level":"warn","service":"xg2g","version":"","component":"config","key":"XG2G_SERVER_MAX_HEADER_BYTES","value":"not-a-number","default":1048576,"time":"2026-02-01T14:52:55+01:00","message":"invalid integer in environment variable, using default"}
--- PASS: TestParseServerConfig (0.00s)
    --- PASS: TestParseServerConfig/defaults_when_no_env_vars_set (0.00s)
    --- PASS: TestParseServerConfig/custom_values_from_env_vars (0.00s)
    --- PASS: TestParseServerConfig/invalid_values_fall_back_to_defaults (0.00s)
=== RUN   TestParseMetricsAddr
=== RUN   TestParseMetricsAddr/metrics_disabled_(default)
=== RUN   TestParseMetricsAddr/metrics_enabled_with_custom_port
=== RUN   TestParseMetricsAddr/metrics_enabled_with_full_address
=== RUN   TestParseMetricsAddr/empty_string_disables_metrics
--- PASS: TestParseMetricsAddr (0.00s)
    --- PASS: TestParseMetricsAddr/metrics_disabled_(default) (0.00s)
    --- PASS: TestParseMetricsAddr/metrics_enabled_with_custom_port (0.00s)
    --- PASS: TestParseMetricsAddr/metrics_enabled_with_full_address (0.00s)
    --- PASS: TestParseMetricsAddr/empty_string_disables_metrics (0.00s)
=== RUN   TestStrictConfig_FailsOnUnknownFields
--- PASS: TestStrictConfig_FailsOnUnknownFields (0.00s)
=== RUN   TestValidateCIDRList_TrustedProxies_MustFail
=== RUN   TestValidateCIDRList_TrustedProxies_MustFail/IPv4_any
=== RUN   TestValidateCIDRList_TrustedProxies_MustFail/IPv6_any
=== RUN   TestValidateCIDRList_TrustedProxies_MustFail/IPv4_unspecified_single
=== RUN   TestValidateCIDRList_TrustedProxies_MustFail/IPv4_unspecified_CIDR
=== RUN   TestValidateCIDRList_TrustedProxies_MustFail/IPv6_unspecified_single
=== RUN   TestValidateCIDRList_TrustedProxies_MustFail/IPv6_unspecified_CIDR
=== RUN   TestValidateCIDRList_TrustedProxies_MustFail/invalid_entry
--- PASS: TestValidateCIDRList_TrustedProxies_MustFail (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustFail/IPv4_any (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustFail/IPv6_any (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustFail/IPv4_unspecified_single (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustFail/IPv4_unspecified_CIDR (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustFail/IPv6_unspecified_single (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustFail/IPv6_unspecified_CIDR (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustFail/invalid_entry (0.00s)
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass/localhost_IPv4
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass/localhost_IPv4_CIDR
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass/private_class_A
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass/private_class_C
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass/IPv6_ULA
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass/IPv6_documentation
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass/empty_entry
=== RUN   TestValidateCIDRList_TrustedProxies_MustPass/whitespace_entry
--- PASS: TestValidateCIDRList_TrustedProxies_MustPass (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustPass/localhost_IPv4 (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustPass/localhost_IPv4_CIDR (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustPass/private_class_A (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustPass/private_class_C (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustPass/IPv6_ULA (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustPass/IPv6_documentation (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustPass/empty_entry (0.00s)
    --- PASS: TestValidateCIDRList_TrustedProxies_MustPass/whitespace_entry (0.00s)
=== RUN   TestValidateCIDRList_Whitelist_MustFail
=== RUN   TestValidateCIDRList_Whitelist_MustFail/IPv4_any
=== RUN   TestValidateCIDRList_Whitelist_MustFail/IPv6_any
=== RUN   TestValidateCIDRList_Whitelist_MustFail/IPv4_unspecified
=== RUN   TestValidateCIDRList_Whitelist_MustFail/IPv6_unspecified
=== RUN   TestValidateCIDRList_Whitelist_MustFail/invalid_entry
--- PASS: TestValidateCIDRList_Whitelist_MustFail (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustFail/IPv4_any (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustFail/IPv6_any (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustFail/IPv4_unspecified (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustFail/IPv6_unspecified (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustFail/invalid_entry (0.00s)
=== RUN   TestValidateCIDRList_Whitelist_MustPass
=== RUN   TestValidateCIDRList_Whitelist_MustPass/private_subnet
=== RUN   TestValidateCIDRList_Whitelist_MustPass/class_A
=== RUN   TestValidateCIDRList_Whitelist_MustPass/localhost
=== RUN   TestValidateCIDRList_Whitelist_MustPass/IPv6_ULA
--- PASS: TestValidateCIDRList_Whitelist_MustPass (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustPass/private_subnet (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustPass/class_A (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustPass/localhost (0.00s)
    --- PASS: TestValidateCIDRList_Whitelist_MustPass/IPv6_ULA (0.00s)
=== RUN   TestValidate_TrustedProxies_Integration
=== RUN   TestValidate_TrustedProxies_Integration/valid_single_IP
=== RUN   TestValidate_TrustedProxies_Integration/valid_CIDR
=== RUN   TestValidate_TrustedProxies_Integration/valid_multiple
=== RUN   TestValidate_TrustedProxies_Integration/forbidden_any_IPv4
=== RUN   TestValidate_TrustedProxies_Integration/forbidden_any_IPv6
=== RUN   TestValidate_TrustedProxies_Integration/forbidden_unspecified
=== RUN   TestValidate_TrustedProxies_Integration/mixed_valid_and_invalid
--- PASS: TestValidate_TrustedProxies_Integration (0.00s)
    --- PASS: TestValidate_TrustedProxies_Integration/valid_single_IP (0.00s)
    --- PASS: TestValidate_TrustedProxies_Integration/valid_CIDR (0.00s)
    --- PASS: TestValidate_TrustedProxies_Integration/valid_multiple (0.00s)
    --- PASS: TestValidate_TrustedProxies_Integration/forbidden_any_IPv4 (0.00s)
    --- PASS: TestValidate_TrustedProxies_Integration/forbidden_any_IPv6 (0.00s)
    --- PASS: TestValidate_TrustedProxies_Integration/forbidden_unspecified (0.00s)
    --- PASS: TestValidate_TrustedProxies_Integration/mixed_valid_and_invalid (0.00s)
=== RUN   TestValidate_RateLimitWhitelist_Integration
=== RUN   TestValidate_RateLimitWhitelist_Integration/valid_single_IP
=== RUN   TestValidate_RateLimitWhitelist_Integration/valid_CIDR
=== RUN   TestValidate_RateLimitWhitelist_Integration/valid_multiple
=== RUN   TestValidate_RateLimitWhitelist_Integration/forbidden_any
=== RUN   TestValidate_RateLimitWhitelist_Integration/forbidden_unspecified
=== RUN   TestValidate_RateLimitWhitelist_Integration/mixed_valid_and_invalid
--- PASS: TestValidate_RateLimitWhitelist_Integration (0.00s)
    --- PASS: TestValidate_RateLimitWhitelist_Integration/valid_single_IP (0.00s)
    --- PASS: TestValidate_RateLimitWhitelist_Integration/valid_CIDR (0.00s)
    --- PASS: TestValidate_RateLimitWhitelist_Integration/valid_multiple (0.00s)
    --- PASS: TestValidate_RateLimitWhitelist_Integration/forbidden_any (0.00s)
    --- PASS: TestValidate_RateLimitWhitelist_Integration/forbidden_unspecified (0.00s)
    --- PASS: TestValidate_RateLimitWhitelist_Integration/mixed_valid_and_invalid (0.00s)
=== RUN   TestValidate_OutboundPolicy
=== RUN   TestValidate_OutboundPolicy/enabled_without_allowlist
=== RUN   TestValidate_OutboundPolicy/enabled_with_allowlist
--- PASS: TestValidate_OutboundPolicy (0.00s)
    --- PASS: TestValidate_OutboundPolicy/enabled_without_allowlist (0.00s)
    --- PASS: TestValidate_OutboundPolicy/enabled_with_allowlist (0.00s)
=== RUN   TestValidate_V3StrictAllowsEmptyConfigVersion
--- PASS: TestValidate_V3StrictAllowsEmptyConfigVersion (0.00s)
=== RUN   TestValidate_AllowsEmptyBouquet
--- PASS: TestValidate_AllowsEmptyBouquet (0.00s)
=== RUN   TestValidate_AllowsEmptyEnigma2BaseURL
--- PASS: TestValidate_AllowsEmptyEnigma2BaseURL (0.00s)
=== RUN   TestValidate_V3StrictRejectsInvalidWorkerMode
--- PASS: TestValidate_V3StrictRejectsInvalidWorkerMode (0.00s)
=== RUN   TestVerification_Defaults
--- PASS: TestVerification_Defaults (0.00s)
=== RUN   TestVerification_EnvOverride_Disabled
--- PASS: TestVerification_EnvOverride_Disabled (0.00s)
=== RUN   TestVerification_EnvOverride_Interval
--- PASS: TestVerification_EnvOverride_Interval (0.00s)
=== RUN   TestDeliveryPolicyDefaults
--- PASS: TestDeliveryPolicyDefaults (0.00s)
=== RUN   TestDeliveryPolicyValidation_Universal
--- PASS: TestDeliveryPolicyValidation_Universal (0.00s)
=== RUN   TestDeliveryPolicyValidation_RejectsInvalid
=== RUN   TestDeliveryPolicyValidation_RejectsInvalid/auto
=== RUN   TestDeliveryPolicyValidation_RejectsInvalid/safari
=== RUN   TestDeliveryPolicyValidation_RejectsInvalid/safari_hevc_hw
=== RUN   TestDeliveryPolicyValidation_RejectsInvalid/empty
=== RUN   TestDeliveryPolicyValidation_RejectsInvalid/invalid
--- PASS: TestDeliveryPolicyValidation_RejectsInvalid (0.00s)
    --- PASS: TestDeliveryPolicyValidation_RejectsInvalid/auto (0.00s)
    --- PASS: TestDeliveryPolicyValidation_RejectsInvalid/safari (0.00s)
    --- PASS: TestDeliveryPolicyValidation_RejectsInvalid/safari_hevc_hw (0.00s)
    --- PASS: TestDeliveryPolicyValidation_RejectsInvalid/empty (0.00s)
    --- PASS: TestDeliveryPolicyValidation_RejectsInvalid/invalid (0.00s)
=== RUN   TestDeprecatedEnvVarFailStart
--- PASS: TestDeprecatedEnvVarFailStart (0.00s)
=== RUN   TestNewEnvVarWorks
--- PASS: TestNewEnvVarWorks (0.00s)
PASS
coverage: 58.5% of statements
ok  	github.com/ManuGH/xg2g/internal/config	1.139s	coverage: 58.5% of statements
=== RUN   TestControlImportPurity
--- PASS: TestControlImportPurity (0.20s)
PASS
coverage: [no statements]
ok  	github.com/ManuGH/xg2g/internal/control	(cached)	coverage: [no statements]
=== RUN   TestAdmissionController
=== RUN   TestAdmissionController/Allow:_Engine_Enabled,_Tuners_Available,_Limits_OK
=== RUN   TestAdmissionController/Reject:_Engine_Disabled
=== RUN   TestAdmissionController/Reject:_No_Tuner_Slots
=== RUN   TestAdmissionController/Reject:_Sessions_Full_(Limit_8,_Active_8)
=== RUN   TestAdmissionController/Reject:_Transcodes_Full_(Limit_2,_Active_2)
=== RUN   TestAdmissionController/Allow:_Transcodes_Full_But_Direct_Play_Requested
=== RUN   TestAdmissionController/Reject:_Internal_State_Invalid_(Negative_Tuners)
=== RUN   TestAdmissionController/Reject:_Internal_State_Invalid_(Negative)
--- PASS: TestAdmissionController (0.00s)
    --- PASS: TestAdmissionController/Allow:_Engine_Enabled,_Tuners_Available,_Limits_OK (0.00s)
    --- PASS: TestAdmissionController/Reject:_Engine_Disabled (0.00s)
    --- PASS: TestAdmissionController/Reject:_No_Tuner_Slots (0.00s)
    --- PASS: TestAdmissionController/Reject:_Sessions_Full_(Limit_8,_Active_8) (0.00s)
    --- PASS: TestAdmissionController/Reject:_Transcodes_Full_(Limit_2,_Active_2) (0.00s)
    --- PASS: TestAdmissionController/Allow:_Transcodes_Full_But_Direct_Play_Requested (0.00s)
    --- PASS: TestAdmissionController/Reject:_Internal_State_Invalid_(Negative_Tuners) (0.00s)
    --- PASS: TestAdmissionController/Reject:_Internal_State_Invalid_(Negative) (0.00s)
PASS
coverage: 89.5% of statements
ok  	github.com/ManuGH/xg2g/internal/control/admission	1.024s	coverage: 89.5% of statements
=== RUN   TestExtractToken_PriorityOrder
--- PASS: TestExtractToken_PriorityOrder (0.00s)
=== RUN   TestExtractToken_IgnoresQueryParams
--- PASS: TestExtractToken_IgnoresQueryParams (0.00s)
=== RUN   TestAuthorizeToken
--- PASS: TestAuthorizeToken (0.00s)
=== RUN   TestAuthorizeRequest
--- PASS: TestAuthorizeRequest (0.00s)
PASS
coverage: 50.0% of statements
ok  	github.com/ManuGH/xg2g/internal/control/auth	1.014s	coverage: 50.0% of statements
=== RUN   TestPolicyCoverage
--- PASS: TestPolicyCoverage (0.17s)
=== RUN   TestPolicyUnscopedAllowlist
--- PASS: TestPolicyUnscopedAllowlist (0.00s)
PASS
coverage: 15.4% of statements
ok  	github.com/ManuGH/xg2g/internal/control/authz	1.189s	coverage: 15.4% of statements
=== RUN   TestSecureFileServer_MethodNotAllowed
{"level":"warn","service":"xg2g","version":"","component":"control.http","event":"file_req.denied","path":"/playlist.m3u","reason":"method_not_allowed","time":"2026-02-01T14:52:55+01:00","message":"method not allowed"}
--- PASS: TestSecureFileServer_MethodNotAllowed (0.00s)
=== RUN   TestSecureFileServer_OnlyAllowlist
{"level":"warn","service":"xg2g","version":"","component":"control.http","event":"file_req.denied","path":"/forbidden.txt","reason":"not_allowlisted","time":"2026-02-01T14:52:55+01:00","message":"file not in allowlist"}
--- PASS: TestSecureFileServer_OnlyAllowlist (0.00s)
=== RUN   TestSecureFileServer_AllowlistAllowed
{"level":"info","service":"xg2g","version":"","component":"control.http","event":"file_req.allowed","path":"/playlist.m3u","time":"2026-02-01T14:52:55+01:00","message":"serving file"}
--- PASS: TestSecureFileServer_AllowlistAllowed (0.00s)
=== RUN   TestSecureFileServer_PathTraversal
{"level":"warn","service":"xg2g","version":"","component":"control.http","event":"file_req.denied","path":"/../playlist.m3u","reason":"path_escape","time":"2026-02-01T14:52:55+01:00","message":"detected traversal sequence"}
{"level":"warn","service":"xg2g","version":"","component":"control.http","event":"file_req.denied","path":"/playlist.m3u/../../../etc/passwd","reason":"not_allowlisted","time":"2026-02-01T14:52:55+01:00","message":"file not in allowlist"}
{"level":"warn","service":"xg2g","version":"","component":"control.http","event":"file_req.denied","path":"/playlist.m3u/../../etc/passwd","reason":"not_allowlisted","time":"2026-02-01T14:52:55+01:00","message":"file not in allowlist"}
--- PASS: TestSecureFileServer_PathTraversal (0.00s)
=== RUN   TestSecureFileServer_NoDirectoryListing
{"level":"warn","service":"xg2g","version":"","component":"control.http","event":"file_req.denied","path":"/xmltv.xml/","reason":"directory_listing","time":"2026-02-01T14:52:55+01:00","message":"directory listing forbidden"}
--- PASS: TestSecureFileServer_NoDirectoryListing (0.00s)
=== RUN   TestSecureFileServer_ETagCaching
{"level":"info","service":"xg2g","version":"","component":"control.http","event":"file_req.allowed","path":"/playlist.m3u","time":"2026-02-01T14:52:55+01:00","message":"serving file"}
--- PASS: TestSecureFileServer_ETagCaching (0.00s)
=== RUN   TestUIEmbedContract
    ui_embed_test.go:48: ✅ assets/ directory found (Vite default structure)
    ui_embed_test.go:53: ✅ WebUI embed contract verified: index.html present, 5 total files
--- PASS: TestUIEmbedContract (0.00s)
=== RUN   TestUIHandler_IndexNoCache
--- PASS: TestUIHandler_IndexNoCache (0.01s)
=== RUN   TestUIHandler_AssetsCached
--- PASS: TestUIHandler_AssetsCached (0.00s)
=== RUN   TestUIHandler_CSPHeader
--- PASS: TestUIHandler_CSPHeader (0.00s)
=== RUN   TestUIHandler_EmptyCSP
--- PASS: TestUIHandler_EmptyCSP (0.00s)
PASS
coverage: 43.0% of statements
ok  	github.com/ManuGH/xg2g/internal/control/http	1.030s	coverage: 43.0% of statements
# github.com/ManuGH/xg2g/internal/control/http/v3/middleware
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/control/recordings/capabilities
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/core/openwebif
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/core/pathutil
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/core/profile
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/core/urlutil
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/core/useragent
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/domain/session/ports
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/domain/session/manager/testkit
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/domain/vod
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
=== RUN   TestAdmissionIntegration
=== RUN   TestAdmissionIntegration/Engine_Disabled_->_503
{"level":"info","service":"xg2g","version":"","serviceRef":"1:0:1:0:0:0:0:0:0:0:http://example.com/stream","code":"ADMISSION_ENGINE_DISABLED","time":"2026-02-01T14:52:59+01:00","message":"admission rejected"}
=== RUN   TestAdmissionIntegration/Sessions_Full_->_503
{"level":"info","service":"xg2g","version":"","serviceRef":"1:0:1:0:0:0:0:0:0:0:http://example.com/stream","code":"ADMISSION_SESSIONS_FULL","time":"2026-02-01T14:52:59+01:00","message":"admission rejected"}
=== RUN   TestAdmissionIntegration/No_Tuners_->_503
{"level":"info","service":"xg2g","version":"","serviceRef":"1:0:1:0:0:0:0:0:0:0:http://example.com/stream","code":"ADMISSION_NO_TUNERS","time":"2026-02-01T14:52:59+01:00","message":"admission rejected"}
=== RUN   TestAdmissionIntegration/State_Unknown_(Fail-Closed)_->_503
{"level":"error","service":"xg2g","version":"","error":"assert.AnError general error for testing","time":"2026-02-01T14:52:59+01:00","message":"admission state snapshot failed, failing closed"}
{"level":"info","service":"xg2g","version":"","serviceRef":"1:0:1:0:0:0:0:0:0:0:http://example.com/stream","code":"ADMISSION_STATE_UNKNOWN","time":"2026-02-01T14:52:59+01:00","message":"admission rejected"}
--- PASS: TestAdmissionIntegration (0.00s)
    --- PASS: TestAdmissionIntegration/Engine_Disabled_->_503 (0.00s)
    --- PASS: TestAdmissionIntegration/Sessions_Full_->_503 (0.00s)
    --- PASS: TestAdmissionIntegration/No_Tuners_->_503 (0.00s)
    --- PASS: TestAdmissionIntegration/State_Unknown_(Fail-Closed)_->_503 (0.00s)
=== RUN   TestSecurityFailClosedInvariant
=== RUN   TestSecurityFailClosedInvariant/401_Unauthorized_Must_Not_Call_Resolver
=== RUN   TestSecurityFailClosedInvariant/403_Forbidden_Must_Not_Call_Resolver
--- PASS: TestSecurityFailClosedInvariant (0.00s)
    --- PASS: TestSecurityFailClosedInvariant/401_Unauthorized_Must_Not_Call_Resolver (0.00s)
    --- PASS: TestSecurityFailClosedInvariant/403_Forbidden_Must_Not_Call_Resolver (0.00s)
=== RUN   TestLANGuard_UntrustedProxy
=== RUN   TestLANGuard_UntrustedProxy/trusted_proxy_honors_xff
=== RUN   TestLANGuard_UntrustedProxy/untrusted_proxy_ignores_xff
=== RUN   TestLANGuard_UntrustedProxy/chained_proxy_right_to_left
--- PASS: TestLANGuard_UntrustedProxy (0.01s)
    --- PASS: TestLANGuard_UntrustedProxy/trusted_proxy_honors_xff (0.00s)
    --- PASS: TestLANGuard_UntrustedProxy/untrusted_proxy_ignores_xff (0.00s)
    --- PASS: TestLANGuard_UntrustedProxy/chained_proxy_right_to_left (0.00s)
=== RUN   TestAuthEnforcement_TableDriven
=== RUN   TestAuthEnforcement_TableDriven/control_plane_start_intent_no_token_->_401
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.missing_header","time":"2026-02-01T14:52:59+01:00","message":"authorization header/cookie missing"}
=== RUN   TestAuthEnforcement_TableDriven/control_plane_start_intent_read_token_->_403
{"level":"warn","service":"xg2g","version":"","component":"authz","required_scopes":["v3:write"],"token_scopes":["v3:read"],"time":"2026-02-01T14:52:59+01:00","message":"insufficient scopes for request"}
=== RUN   TestAuthEnforcement_TableDriven/hls_playlist_no_token_->_401
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.missing_header","time":"2026-02-01T14:52:59+01:00","message":"authorization header/cookie missing"}
=== RUN   TestAuthEnforcement_TableDriven/hls_segment_no_token_->_401
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.missing_header","time":"2026-02-01T14:52:59+01:00","message":"authorization header/cookie missing"}
=== RUN   TestAuthEnforcement_TableDriven/metrics_not_exposed
--- PASS: TestAuthEnforcement_TableDriven (0.00s)
    --- PASS: TestAuthEnforcement_TableDriven/control_plane_start_intent_no_token_->_401 (0.00s)
    --- PASS: TestAuthEnforcement_TableDriven/control_plane_start_intent_read_token_->_403 (0.00s)
    --- PASS: TestAuthEnforcement_TableDriven/hls_playlist_no_token_->_401 (0.00s)
    --- PASS: TestAuthEnforcement_TableDriven/hls_segment_no_token_->_401 (0.00s)
    --- PASS: TestAuthEnforcement_TableDriven/metrics_not_exposed (0.00s)
=== RUN   TestV3WriteRouteRequiresWriteScope
{"level":"warn","service":"xg2g","version":"","component":"authz","required_scopes":["v3:write"],"token_scopes":["v3:read"],"time":"2026-02-01T14:52:59+01:00","message":"insufficient scopes for request"}
--- PASS: TestV3WriteRouteRequiresWriteScope (0.00s)
=== RUN   TestLANGuard_PublicEndpoints
=== RUN   TestLANGuard_PublicEndpoints/public_ip_forbidden_/api/v3/sessions
=== RUN   TestLANGuard_PublicEndpoints/lan_ip_allowed_/api/v3/sessions
--- PASS: TestLANGuard_PublicEndpoints (0.00s)
    --- PASS: TestLANGuard_PublicEndpoints/public_ip_forbidden_/api/v3/sessions (0.00s)
    --- PASS: TestLANGuard_PublicEndpoints/lan_ip_allowed_/api/v3/sessions (0.00s)
=== RUN   TestRaceSafety_ParallelIntents
=== RUN   TestRaceSafety_ParallelIntents/Phase2_Worker_Dedup_PendingIdempotency
    auth_strict_test.go:620: phase 2 idempotency not implemented yet
--- PASS: TestRaceSafety_ParallelIntents (0.00s)
    --- SKIP: TestRaceSafety_ParallelIntents/Phase2_Worker_Dedup_PendingIdempotency (0.00s)
=== RUN   TestAuthMiddleware_NoTokenConfigured
{"level":"error","service":"xg2g","version":"","event":"auth.fail_closed","time":"2026-02-01T14:52:59+01:00","message":"No API tokens configured. Denying access."}
--- PASS: TestAuthMiddleware_NoTokenConfigured (0.00s)
=== RUN   TestAuthMiddleware_MissingAuthHeader
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.missing_header","time":"2026-02-01T14:52:59+01:00","message":"authorization header/cookie missing"}
--- PASS: TestAuthMiddleware_MissingAuthHeader (0.00s)
=== RUN   TestAuthMiddleware_ValidBearerToken
--- PASS: TestAuthMiddleware_ValidBearerToken (0.00s)
=== RUN   TestAuthMiddleware_ValidCookie
--- PASS: TestAuthMiddleware_ValidCookie (0.00s)
=== RUN   TestAuthMiddleware_MediaRequiresSessionCookie
=== RUN   TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/recordings/abc/stream.mp4/bearer-only
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.media_forbidden_source","source":"Authorization header (Bearer)","path":"/api/v3/recordings/abc/stream.mp4","time":"2026-02-01T14:52:59+01:00","message":"media request denied: bearer token not allowed for media (cookie required)"}
=== RUN   TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/recordings/abc/stream.mp4/cookie
=== RUN   TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/recordings/abc/playlist.m3u8/bearer-only
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.media_forbidden_source","source":"Authorization header (Bearer)","path":"/api/v3/recordings/abc/playlist.m3u8","time":"2026-02-01T14:52:59+01:00","message":"media request denied: bearer token not allowed for media (cookie required)"}
=== RUN   TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/recordings/abc/playlist.m3u8/cookie
=== RUN   TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/sessions/00000000-0000-0000-0000-000000000000/hls/index.m3u8/bearer-only
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.media_forbidden_source","source":"Authorization header (Bearer)","path":"/api/v3/sessions/00000000-0000-0000-0000-000000000000/hls/index.m3u8","time":"2026-02-01T14:52:59+01:00","message":"media request denied: bearer token not allowed for media (cookie required)"}
=== RUN   TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/sessions/00000000-0000-0000-0000-000000000000/hls/index.m3u8/cookie
--- PASS: TestAuthMiddleware_MediaRequiresSessionCookie (0.00s)
    --- PASS: TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/recordings/abc/stream.mp4/bearer-only (0.00s)
    --- PASS: TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/recordings/abc/stream.mp4/cookie (0.00s)
    --- PASS: TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/recordings/abc/playlist.m3u8/bearer-only (0.00s)
    --- PASS: TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/recordings/abc/playlist.m3u8/cookie (0.00s)
    --- PASS: TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/sessions/00000000-0000-0000-0000-000000000000/hls/index.m3u8/bearer-only (0.00s)
    --- PASS: TestAuthMiddleware_MediaRequiresSessionCookie//api/v3/sessions/00000000-0000-0000-0000-000000000000/hls/index.m3u8/cookie (0.00s)
=== RUN   TestAuthMiddleware_InvalidToken
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.invalid_token","time":"2026-02-01T14:52:59+01:00","message":"invalid api token"}
--- PASS: TestAuthMiddleware_InvalidToken (0.00s)
=== RUN   TestAuthMiddleware_EmptyScopesPrimaryToken
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.invalid_token","time":"2026-02-01T14:52:59+01:00","message":"invalid api token"}
--- PASS: TestAuthMiddleware_EmptyScopesPrimaryToken (0.00s)
=== RUN   TestAuthMiddleware_EmptyScopesAdditionalToken
{"level":"warn","service":"xg2g","version":"","component":"auth","event":"auth.invalid_token","time":"2026-02-01T14:52:59+01:00","message":"invalid api token"}
--- PASS: TestAuthMiddleware_EmptyScopesAdditionalToken (0.00s)
=== RUN   TestAuthMiddleware_ValidXAPIToken
--- PASS: TestAuthMiddleware_ValidXAPIToken (0.00s)
=== RUN   TestCreateSession
--- PASS: TestCreateSession (0.00s)
=== RUN   TestCreateSession_RejectsCookieOnly
--- PASS: TestCreateSession_RejectsCookieOnly (0.00s)
=== RUN   TestPutSystemConfigRejectsInvalid
--- PASS: TestPutSystemConfigRejectsInvalid (0.00s)
=== RUN   TestPutSystemConfigTriggersShutdown
{"level":"info","service":"xg2g","version":"","component":"startup-check","time":"2026-02-01T14:52:59+01:00","message":"Running pre-flight startup checks..."}
{"level":"info","service":"xg2g","version":"","component":"startup-check","path":"/tmp/TestPutSystemConfigTriggersShutdown1034036045/001","time":"2026-02-01T14:52:59+01:00","message":"✓ Data directory is writable"}
{"level":"info","service":"xg2g","version":"","component":"startup-check","addr":":8088","time":"2026-02-01T14:52:59+01:00","message":"✓ API listen address is valid"}
{"level":"info","service":"xg2g","version":"","component":"startup-check","url":"http://example.com","time":"2026-02-01T14:52:59+01:00","message":"✓ OWI Base URL is valid"}
{"level":"info","service":"xg2g","version":"","component":"startup-check","time":"2026-02-01T14:52:59+01:00","message":"✅ All startup checks passed"}
{"level":"info","service":"xg2g","version":"","time":"2026-02-01T14:52:59+01:00","message":"configuration updated, triggering graceful shutdown"}
--- PASS: TestPutSystemConfigTriggersShutdown (0.00s)
=== RUN   TestPutSystemConfigDoesNotAliasCurrent
{"level":"info","service":"xg2g","version":"","component":"startup-check","time":"2026-02-01T14:52:59+01:00","message":"Running pre-flight startup checks..."}
{"level":"info","service":"xg2g","version":"","component":"startup-check","path":"/tmp/TestPutSystemConfigDoesNotAliasCurrent3118683389/001","time":"2026-02-01T14:52:59+01:00","message":"✓ Data directory is writable"}
{"level":"info","service":"xg2g","version":"","component":"startup-check","addr":":8088","time":"2026-02-01T14:52:59+01:00","message":"✓ API listen address is valid"}
{"level":"info","service":"xg2g","version":"","component":"startup-check","url":"http://example.com","time":"2026-02-01T14:52:59+01:00","message":"✓ OWI Base URL is valid"}
{"level":"info","service":"xg2g","version":"","component":"startup-check","ffmpeg":"/usr/bin/ffmpeg","time":"2026-02-01T14:52:59+01:00","message":"✓ Engine dependencies available"}
{"level":"warn","service":"xg2g","version":"","component":"startup-check","store_backend":"memory","time":"2026-02-01T14:52:59+01:00","message":"engine uses in-memory store; sessions are not persistent across restarts"}
{"level":"warn","service":"xg2g","version":"","component":"startup-check","data_dir":"/tmp/TestPutSystemConfigDoesNotAliasCurrent3118683389/001","time":"2026-02-01T14:52:59+01:00","message":"data directory is under temp; cached data and sessions may be lost on reboot"}
{"level":"info","service":"xg2g","version":"","component":"startup-check","time":"2026-02-01T14:52:59+01:00","message":"✅ All startup checks passed"}
{"level":"info","service":"xg2g","version":"","time":"2026-02-01T14:52:59+01:00","message":"configuration updated, triggering graceful shutdown"}
--- PASS: TestPutSystemConfigDoesNotAliasCurrent (0.00s)
=== RUN   TestPutSystemConfigRejectsUnknownFeatureFlags
--- PASS: TestPutSystemConfigRejectsUnknownFeatureFlags (0.00s)
=== RUN   TestPutSystemConfigRejectsInvalidFeatureFlags
=== RUN   TestPutSystemConfigRejectsInvalidFeatureFlags/Non-primitive_value
=== RUN   TestPutSystemConfigRejectsInvalidFeatureFlags/Type_mismatch_(bool_expected,_string_got)
=== RUN   TestPutSystemConfigRejectsInvalidFeatureFlags/Type_mismatch_(bool_expected,_number_got)
--- PASS: TestPutSystemConfigRejectsInvalidFeatureFlags (0.00s)
    --- PASS: TestPutSystemConfigRejectsInvalidFeatureFlags/Non-primitive_value (0.00s)
    --- PASS: TestPutSystemConfigRejectsInvalidFeatureFlags/Type_mismatch_(bool_expected,_string_got) (0.00s)
    --- PASS: TestPutSystemConfigRejectsInvalidFeatureFlags/Type_mismatch_(bool_expected,_number_got) (0.00s)
=== RUN   TestDetectConflicts
=== RUN   TestDetectConflicts/No_Overlap_-_Clean
=== RUN   TestDetectConflicts/No_Overlap_-_Boundary_Touching
=== RUN   TestDetectConflicts/Exact_Duplicate
=== RUN   TestDetectConflicts/Partial_Overlap_-_Start
=== RUN   TestDetectConflicts/Partial_Overlap_-_End
=== RUN   TestDetectConflicts/Full_Containment
=== RUN   TestDetectConflicts/Contained_Within
=== RUN   TestDetectConflicts/With_Padding_-_Causes_Overlap
=== RUN   TestDetectConflicts/Ignore_Finished/Disabled
=== RUN   TestDetectConflicts/Different_ServiceRef_-_No_Conflict_(Conservative_checks)
--- PASS: TestDetectConflicts (0.00s)
    --- PASS: TestDetectConflicts/No_Overlap_-_Clean (0.00s)
    --- PASS: TestDetectConflicts/No_Overlap_-_Boundary_Touching (0.00s)
    --- PASS: TestDetectConflicts/Exact_Duplicate (0.00s)
    --- PASS: TestDetectConflicts/Partial_Overlap_-_Start (0.00s)
    --- PASS: TestDetectConflicts/Partial_Overlap_-_End (0.00s)
    --- PASS: TestDetectConflicts/Full_Containment (0.00s)
    --- PASS: TestDetectConflicts/Contained_Within (0.00s)
    --- PASS: TestDetectConflicts/With_Padding_-_Causes_Overlap (0.00s)
    --- PASS: TestDetectConflicts/Ignore_Finished/Disabled (0.00s)
    --- PASS: TestDetectConflicts/Different_ServiceRef_-_No_Conflict_(Conservative_checks) (0.00s)
=== RUN   TestProblemWrite_Hardening
{"level":"warn","service":"xg2g","version":"","key":"status","problem_type":"test/type","time":"2026-02-01T14:52:59+01:00","message":"ignoring reserved key in problem extras"}
{"level":"warn","service":"xg2g","version":"","key":"type","problem_type":"test/type","time":"2026-02-01T14:52:59+01:00","message":"ignoring reserved key in problem extras"}
{"level":"warn","service":"xg2g","version":"","key":"title","problem_type":"test/type","time":"2026-02-01T14:52:59+01:00","message":"ignoring reserved key in problem extras"}
{"level":"warn","service":"xg2g","version":"","key":"detail","problem_type":"test/type","time":"2026-02-01T14:52:59+01:00","message":"ignoring reserved key in problem extras"}
{"level":"warn","service":"xg2g","version":"","key":"instance","problem_type":"test/type","time":"2026-02-01T14:52:59+01:00","message":"ignoring reserved key in problem extras"}
{"level":"warn","service":"xg2g","version":"","key":"code","problem_type":"test/type","time":"2026-02-01T14:52:59+01:00","message":"ignoring reserved key in problem extras"}
--- PASS: TestProblemWrite_Hardening (0.00s)
=== RUN   TestV3Router_Hardening
=== RUN   TestV3Router_Hardening/404_NotFound
=== RUN   TestV3Router_Hardening/405_MethodNotAllowed
--- PASS: TestV3Router_Hardening (0.00s)
    --- PASS: TestV3Router_Hardening/404_NotFound (0.00s)
    --- PASS: TestV3Router_Hardening/405_MethodNotAllowed (0.00s)
=== RUN   TestV3RFC7807Compliance
--- PASS: TestV3RFC7807Compliance (0.06s)
=== RUN   TestContract_AddTimer
=== RUN   TestContract_AddTimer/23_InvalidJSON_400
    contract_v3_dvr_add_timer_test.go:69: Response: Status=400 Body=map[code:INVALID_INPUT detail:The request body is malformed or empty instance:/api/v3/dvr/timers requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Request Body type:dvr/invalid_input]
=== RUN   TestContract_AddTimer/24_InvalidTime_422
    contract_v3_dvr_add_timer_test.go:80: Response: Status=422 Body=map[code:INVALID_TIME detail:Begin time must be before end time instance:/api/v3/dvr/timers requestId:FALLBACK-TRUTH-MISSING status:422 title:Invalid Timer Time type:dvr/invalid_time]
=== RUN   TestContract_AddTimer/25_ReceiverUnreachable_DuplicateCheck_502
{"level":"error","service":"xg2g","version":"","error":"connection reset by peer","time":"2026-02-01T14:52:59+01:00","message":"failed to fetch timers for duplicate check"}
    contract_v3_dvr_add_timer_test.go:97: Response: Status=502 Body=map[code:RECEIVER_UNREACHABLE detail:Failed to verify existing timers instance:/api/v3/dvr/timers requestId:FALLBACK-TRUTH-MISSING status:502 title:Receiver Unreachable type:dvr/receiver_unreachable]
=== RUN   TestContract_AddTimer/26_Duplicate_409
    contract_v3_dvr_add_timer_test.go:116: Response: Status=409 Body=map[code:CONFLICT detail:A timer with the same parameters already exists instance:/api/v3/dvr/timers requestId:FALLBACK-TRUTH-MISSING status:409 title:Timer Conflict type:dvr/duplicate]
=== RUN   TestContract_AddTimer/27_AddConflict_409
{"level":"error","service":"xg2g","version":"","error":"Konflikt mit anderem Timer","sref":"1:0:1:C3:21:85:C00000:0:0:0:","time":"2026-02-01T14:52:59+01:00","message":"failed to add timer"}
    contract_v3_dvr_add_timer_test.go:136: Response: Status=409 Body=map[code:ADD_FAILED detail:Konflikt mit anderem Timer instance:/api/v3/dvr/timers requestId:FALLBACK-TRUTH-MISSING status:409 title:Add Timer Failed type:dvr/add_failed]
=== RUN   TestContract_AddTimer/28_AddFails_Generic_500
{"level":"error","service":"xg2g","version":"","error":"internal server error","sref":"1:0:1:C3:21:85:C00000:0:0:0:","time":"2026-02-01T14:52:59+01:00","message":"failed to add timer"}
    contract_v3_dvr_add_timer_test.go:154: Response: Status=500 Body=map[code:ADD_FAILED detail:internal server error instance:/api/v3/dvr/timers requestId:FALLBACK-TRUTH-MISSING status:500 title:Add Timer Failed type:dvr/add_failed]
=== RUN   TestContract_AddTimer/29_VerificationFails_502
{"level":"warn","service":"xg2g","version":"","sref":"1:0:1:C3:21:85:C00000:0:0:0:","time":"2026-02-01T14:52:59+01:00","message":"timer add verified failed"}
    contract_v3_dvr_add_timer_test.go:174: Response: Status=502 Body=map[code:RECEIVER_INCONSISTENT detail:Timer added but failed verification instance:/api/v3/dvr/timers requestId:FALLBACK-TRUTH-MISSING status:502 title:Receiver Inconsistent type:dvr/receiver_inconsistent]
=== RUN   TestContract_AddTimer/30_Success_201_ReturnsTimer
=== RUN   TestContract_AddTimer/31_PaddingApplied_BeginEndShifted
=== RUN   TestContract_AddTimer/32_ServiceRefResolution_NoColon_StillCreates
{"level":"info","service":"xg2g","version":"","path":"/tmp/TestContract_AddTimer2915658493/001/missing.m3u","search_id":"M3U_CHANNEL_ID","time":"2026-02-01T14:52:59+01:00","message":"attempting to resolve service ref from playlist"}
{"level":"warn","service":"xg2g","version":"","error":"open /tmp/TestContract_AddTimer2915658493/001/missing.m3u: no such file or directory","path":"/tmp/TestContract_AddTimer2915658493/001/missing.m3u","time":"2026-02-01T14:52:59+01:00","message":"failed to read playlist for resolution"}
--- PASS: TestContract_AddTimer (0.50s)
    --- PASS: TestContract_AddTimer/23_InvalidJSON_400 (0.00s)
    --- PASS: TestContract_AddTimer/24_InvalidTime_422 (0.00s)
    --- PASS: TestContract_AddTimer/25_ReceiverUnreachable_DuplicateCheck_502 (0.00s)
    --- PASS: TestContract_AddTimer/26_Duplicate_409 (0.00s)
    --- PASS: TestContract_AddTimer/27_AddConflict_409 (0.00s)
    --- PASS: TestContract_AddTimer/28_AddFails_Generic_500 (0.00s)
    --- PASS: TestContract_AddTimer/29_VerificationFails_502 (0.50s)
    --- PASS: TestContract_AddTimer/30_Success_201_ReturnsTimer (0.00s)
    --- PASS: TestContract_AddTimer/31_PaddingApplied_BeginEndShifted (0.00s)
    --- PASS: TestContract_AddTimer/32_ServiceRefResolution_NoColon_StillCreates (0.00s)
=== RUN   TestContract_DeleteTimer
=== RUN   TestContract_DeleteTimer/37_InvalidID_400
    contract_v3_dvr_delete_timer_test.go:25: Response: Status=400 Body=map[code:INVALID_ID detail:The provided timer ID is invalid instance:/api/v3/dvr/timers/invalid-id requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Timer ID type:dvr/invalid_id]
=== RUN   TestContract_DeleteTimer/38_ReceiverUnreachable_502
{"level":"error","service":"xg2g","version":"","error":"connection refused","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","time":"2026-02-01T14:52:59+01:00","message":"failed to delete timer"}
    contract_v3_dvr_delete_timer_test.go:42: Response: Status=502 Body=map[code:DELETE_FAILED detail:connection refused instance:/api/v3/dvr/timers/MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA requestId:FALLBACK-TRUTH-MISSING status:502 title:Receiver Unreachable type:dvr/receiver_unreachable]
=== RUN   TestContract_DeleteTimer/39_TimerNotFound_404
{"level":"error","service":"xg2g","version":"","error":"timer not found","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","time":"2026-02-01T14:52:59+01:00","message":"failed to delete timer"}
    contract_v3_dvr_delete_timer_test.go:59: Response: Status=404 Body=map[code:DELETE_FAILED detail:timer not found instance:/api/v3/dvr/timers/MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA requestId:FALLBACK-TRUTH-MISSING status:404 title:Timer Not Found type:dvr/not_found]
=== RUN   TestContract_DeleteTimer/40_Success_204
--- PASS: TestContract_DeleteTimer (0.00s)
    --- PASS: TestContract_DeleteTimer/37_InvalidID_400 (0.00s)
    --- PASS: TestContract_DeleteTimer/38_ReceiverUnreachable_502 (0.00s)
    --- PASS: TestContract_DeleteTimer/39_TimerNotFound_404 (0.00s)
    --- PASS: TestContract_DeleteTimer/40_Success_204 (0.00s)
=== RUN   TestContract_PreviewConflicts
=== RUN   TestContract_PreviewConflicts/51_InvalidJSON_400
    contract_v3_dvr_preview_conflicts_test.go:26: Response: Status=400 Body=map[code:INVALID_INPUT detail:The request body is malformed or empty instance:/api/v3/dvr/timers/conflicts/preview requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Request Body type:dvr/invalid_input]
=== RUN   TestContract_PreviewConflicts/52_InvalidTimeRange_422
    contract_v3_dvr_preview_conflicts_test.go:37: Response: Status=422 Body=map[code:INVALID_TIME detail:Begin time must be before end time instance:/api/v3/dvr/timers/conflicts/preview requestId:FALLBACK-TRUTH-MISSING status:422 title:Invalid Timer Order type:dvr/validation]
=== RUN   TestContract_PreviewConflicts/53_ReceiverUnreachable_FailClosed_502
{"level":"error","service":"xg2g","version":"","error":"timeout","time":"2026-02-01T14:52:59+01:00","message":"failed to fetch timers for conflict preview"}
    contract_v3_dvr_preview_conflicts_test.go:54: Response: Status=502 Body=map[code:RECEIVER_UNREACHABLE detail:Could not fetch existing timers for conflict check instance:/api/v3/dvr/timers/conflicts/preview requestId:FALLBACK-TRUTH-MISSING status:502 title:Receiver Unreachable type:dvr/receiver_unreachable]
=== RUN   TestContract_PreviewConflicts/54_NoConflicts_200_CanScheduleTrue
=== RUN   TestContract_PreviewConflicts/55_ConflictDetected_200_CanScheduleFalse
--- PASS: TestContract_PreviewConflicts (0.00s)
    --- PASS: TestContract_PreviewConflicts/51_InvalidJSON_400 (0.00s)
    --- PASS: TestContract_PreviewConflicts/52_InvalidTimeRange_422 (0.00s)
    --- PASS: TestContract_PreviewConflicts/53_ReceiverUnreachable_FailClosed_502 (0.00s)
    --- PASS: TestContract_PreviewConflicts/54_NoConflicts_200_CanScheduleTrue (0.00s)
    --- PASS: TestContract_PreviewConflicts/55_ConflictDetected_200_CanScheduleFalse (0.00s)
=== RUN   TestContract_UpdateTimer
=== RUN   TestContract_UpdateTimer/41_InvalidID_400
    contract_v3_dvr_update_timer_test.go:27: Response: Status=400 Body=map[code:INVALID_ID detail:The provided timer ID is invalid instance:/api/v3/dvr/timers/invalid-id requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Timer ID type:dvr/invalid_id]
=== RUN   TestContract_UpdateTimer/42_InvalidInput_400
    contract_v3_dvr_update_timer_test.go:38: Response: Status=400 Body=map[code:INVALID_INPUT detail:The request body is malformed or empty instance:/api/v3/dvr/timers/MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Request Body type:dvr/invalid_input]
=== RUN   TestContract_UpdateTimer/43_TimerNotFound_404
    contract_v3_dvr_update_timer_test.go:55: Response: Status=404 Body=map[code:NOT_FOUND detail:The requested timer does not exist on the receiver instance:/api/v3/dvr/timers/MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA requestId:FALLBACK-TRUTH-MISSING status:404 title:Timer Not Found type:dvr/not_found]
=== RUN   TestContract_UpdateTimer/44_ReceiverUnreachable_GetTimers_502
{"level":"error","service":"xg2g","version":"","error":"timeout","time":"2026-02-01T14:52:59+01:00","message":"failed to fetch timers during update"}
    contract_v3_dvr_update_timer_test.go:72: Response: Status=502 Body=map[code:RECEIVER_UNREACHABLE detail:Failed to verify existing timer instance:/api/v3/dvr/timers/MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA requestId:FALLBACK-TRUTH-MISSING status:502 title:Receiver Unreachable type:dvr/receiver_unreachable]
=== RUN   TestContract_UpdateTimer/45_NativeUpdateSuccess_200
{"level":"info","service":"xg2g","version":"","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMTAwfDIxMDA","native":true,"time":"2026-02-01T14:52:59+01:00","message":"Updating timer"}
=== RUN   TestContract_UpdateTimer/46_NativeUpdateConflict_409
{"level":"info","service":"xg2g","version":"","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","native":true,"time":"2026-02-01T14:52:59+01:00","message":"Updating timer"}
{"level":"error","service":"xg2g","version":"","error":"Conflict with event X","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","time":"2026-02-01T14:52:59+01:00","message":"native update failed"}
    contract_v3_dvr_update_timer_test.go:121: Response: Status=409 Body=map[code:UPDATE_FAILED detail:Conflict with event X instance:/api/v3/dvr/timers/MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA requestId:FALLBACK-TRUTH-MISSING status:409 title:Update Failed type:dvr/update_failed]
=== RUN   TestContract_UpdateTimer/47_FallbackSuccess_200
{"level":"info","service":"xg2g","version":"","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","native":false,"time":"2026-02-01T14:52:59+01:00","message":"Updating timer"}
{"level":"info","service":"xg2g","version":"","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","time":"2026-02-01T14:52:59+01:00","message":"performing delete+add fallback for update"}
=== RUN   TestContract_UpdateTimer/48_FallbackAddConflict_Rollback_409
{"level":"info","service":"xg2g","version":"","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","native":false,"time":"2026-02-01T14:52:59+01:00","message":"Updating timer"}
{"level":"info","service":"xg2g","version":"","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","time":"2026-02-01T14:52:59+01:00","message":"performing delete+add fallback for update"}
{"level":"error","service":"xg2g","version":"","error":"Conflict","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","time":"2026-02-01T14:52:59+01:00","message":"fallback add failed, attempting rollback"}
=== RUN   TestContract_UpdateTimer/50_VerificationFails_502
{"level":"info","service":"xg2g","version":"","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","native":true,"time":"2026-02-01T14:52:59+01:00","message":"Updating timer"}
{"level":"warn","service":"xg2g","version":"","timerId":"MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA","time":"2026-02-01T14:53:00+01:00","message":"timer update verification failed"}
    contract_v3_dvr_update_timer_test.go:203: Response: Status=502 Body=map[code:RECEIVER_INCONSISTENT detail:Timer updated but failed verification instance:/api/v3/dvr/timers/MTowOjE6QzM6MjE6ODU6QzAwMDAwOjA6MDowOnwxMDAwfDIwMDA requestId:FALLBACK-TRUTH-MISSING status:502 title:Inconsistent Receiver State type:dvr/receiver_inconsistent]
--- PASS: TestContract_UpdateTimer (0.50s)
    --- PASS: TestContract_UpdateTimer/41_InvalidID_400 (0.00s)
    --- PASS: TestContract_UpdateTimer/42_InvalidInput_400 (0.00s)
    --- PASS: TestContract_UpdateTimer/43_TimerNotFound_404 (0.00s)
    --- PASS: TestContract_UpdateTimer/44_ReceiverUnreachable_GetTimers_502 (0.00s)
    --- PASS: TestContract_UpdateTimer/45_NativeUpdateSuccess_200 (0.00s)
    --- PASS: TestContract_UpdateTimer/46_NativeUpdateConflict_409 (0.00s)
    --- PASS: TestContract_UpdateTimer/47_FallbackSuccess_200 (0.00s)
    --- PASS: TestContract_UpdateTimer/48_FallbackAddConflict_Rollback_409 (0.00s)
    --- PASS: TestContract_UpdateTimer/50_VerificationFails_502 (0.50s)
=== RUN   TestRFC7807_HeaderAssert
--- PASS: TestRFC7807_HeaderAssert (0.00s)
=== RUN   TestContract_StopStream_DeleteStreamsId
=== RUN   TestContract_StopStream_DeleteStreamsId/13_InvalidID_Empty
    contract_v3_streams_stop_test.go:90: Response: Status=400 Body=map[code:INVALID_SESSION_ID detail:The provided session ID contains unsafe characters instance:/api/v3/streams/ requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Session ID type:streams/invalid_id]
=== RUN   TestContract_StopStream_DeleteStreamsId/14_InvalidID_Unsafe
    contract_v3_streams_stop_test.go:102: Response: Status=400 Body=map[code:INVALID_SESSION_ID detail:The provided session ID contains unsafe characters instance:/api/v3/streams/../unsafe requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Session ID type:streams/invalid_id]
=== RUN   TestContract_StopStream_DeleteStreamsId/15_ControlPlaneDisabled_NoStore
    contract_v3_streams_stop_test.go:112: Response: Status=503 Body=map[code:UNAVAILABLE detail:V3 control plane is not enabled instance:/api/v3/streams/abc requestId:FALLBACK-TRUTH-MISSING status:503 title:Control Plane Unavailable type:streams/unavailable]
=== RUN   TestContract_StopStream_DeleteStreamsId/16_ControlPlaneDisabled_NoBus
    contract_v3_streams_stop_test.go:122: Response: Status=503 Body=map[code:UNAVAILABLE detail:V3 control plane is not enabled instance:/api/v3/streams/abc requestId:FALLBACK-TRUTH-MISSING status:503 title:Control Plane Unavailable type:streams/unavailable]
=== RUN   TestContract_StopStream_DeleteStreamsId/17_SessionNotFound
    contract_v3_streams_stop_test.go:136: Response: Status=404 Body=map[code:NOT_FOUND detail:The session does not exist instance:/api/v3/streams/abc requestId:FALLBACK-TRUTH-MISSING status:404 title:Session Not Found type:streams/not_found]
=== RUN   TestContract_StopStream_DeleteStreamsId/18_StoreError
    contract_v3_streams_stop_test.go:150: Response: Status=500 Body=map[code:STOP_FAILED detail:Failed to retrieve session state instance:/api/v3/streams/abc requestId:FALLBACK-TRUTH-MISSING status:500 title:Stop Failed type:streams/stop_failed]
=== RUN   TestContract_StopStream_DeleteStreamsId/19_PublishFails
    contract_v3_streams_stop_test.go:167: Response: Status=500 Body=map[code:STOP_FAILED detail:Failed to publish stop event instance:/api/v3/streams/abc requestId:FALLBACK-TRUTH-MISSING status:500 title:Stop Failed type:streams/stop_failed]
=== RUN   TestContract_StopStream_DeleteStreamsId/20_Success_204_PublishesCorrectEvent
--- PASS: TestContract_StopStream_DeleteStreamsId (0.00s)
    --- PASS: TestContract_StopStream_DeleteStreamsId/13_InvalidID_Empty (0.00s)
    --- PASS: TestContract_StopStream_DeleteStreamsId/14_InvalidID_Unsafe (0.00s)
    --- PASS: TestContract_StopStream_DeleteStreamsId/15_ControlPlaneDisabled_NoStore (0.00s)
    --- PASS: TestContract_StopStream_DeleteStreamsId/16_ControlPlaneDisabled_NoBus (0.00s)
    --- PASS: TestContract_StopStream_DeleteStreamsId/17_SessionNotFound (0.00s)
    --- PASS: TestContract_StopStream_DeleteStreamsId/18_StoreError (0.00s)
    --- PASS: TestContract_StopStream_DeleteStreamsId/19_PublishFails (0.00s)
    --- PASS: TestContract_StopStream_DeleteStreamsId/20_Success_204_PublishesCorrectEvent (0.00s)
=== RUN   TestGetStreams_Contract_Slice53
=== RUN   TestGetStreams_Contract_Slice53/Empty_Returns_EmptyList
=== RUN   TestGetStreams_Contract_Slice53/PlaylistFilename_Empty_BestEffort
=== RUN   TestGetStreams_Contract_Slice53/Sorting_Deterministic
=== RUN   TestGetStreams_Contract_Slice53/IP_Gating
=== RUN   TestGetStreams_Contract_Slice53/Terminal_States_Filtered
=== RUN   TestGetStreams_Contract_Slice53/Error_Contract_ProblemDetails
=== RUN   TestGetStreams_Contract_Slice53/Error_Contract_ProblemDetails/StoreNil
{"level":"error","service":"xg2g","version":"","time":"2026-02-01T14:53:00+01:00","message":"v3 store not initialized"}
=== RUN   TestGetStreams_Contract_Slice53/Error_Contract_ProblemDetails/StoreError
{"level":"error","service":"xg2g","version":"","error":"db boom","time":"2026-02-01T14:53:00+01:00","message":"failed to get streams"}
=== RUN   TestGetStreams_Contract_Slice53/Mandatory_Traceability_Fields
=== RUN   TestGetStreams_Contract_Slice53/Lifecycle_Truth_Mapping
--- PASS: TestGetStreams_Contract_Slice53 (0.00s)
    --- PASS: TestGetStreams_Contract_Slice53/Empty_Returns_EmptyList (0.00s)
    --- PASS: TestGetStreams_Contract_Slice53/PlaylistFilename_Empty_BestEffort (0.00s)
    --- PASS: TestGetStreams_Contract_Slice53/Sorting_Deterministic (0.00s)
    --- PASS: TestGetStreams_Contract_Slice53/IP_Gating (0.00s)
    --- PASS: TestGetStreams_Contract_Slice53/Terminal_States_Filtered (0.00s)
    --- PASS: TestGetStreams_Contract_Slice53/Error_Contract_ProblemDetails (0.00s)
        --- PASS: TestGetStreams_Contract_Slice53/Error_Contract_ProblemDetails/StoreNil (0.00s)
        --- PASS: TestGetStreams_Contract_Slice53/Error_Contract_ProblemDetails/StoreError (0.00s)
    --- PASS: TestGetStreams_Contract_Slice53/Mandatory_Traceability_Fields (0.00s)
    --- PASS: TestGetStreams_Contract_Slice53/Lifecycle_Truth_Mapping (0.00s)
=== RUN   TestContract_SystemRefresh
=== RUN   TestContract_SystemRefresh/21_RefreshUnavailable_NoScanner
    contract_v3_system_refresh_test.go:46: Response: Status=503 Body=map[code:UNAVAILABLE detail:Scanner not enabled instance:/api/v3/system/refresh requestId:FALLBACK-TRUTH-MISSING status:503 title:Subsystem Unavailable type:system/unavailable]
=== RUN   TestContract_SystemRefresh/22_RefreshAccepted_TriggersBackground
{"level":"info","service":"xg2g","version":"","duration":0.015989,"time":"2026-02-01T14:53:00+01:00","message":"manual refresh triggered via API"}
--- PASS: TestContract_SystemRefresh (0.00s)
    --- PASS: TestContract_SystemRefresh/21_RefreshUnavailable_NoScanner (0.00s)
    --- PASS: TestContract_SystemRefresh/22_RefreshAccepted_TriggersBackground (0.00s)
=== RUN   TestV3Contract_Intents
{"level":"info","service":"xg2g","version":"","component":"api","correlationId":"corr-intent-001","ua":"","profile":"high","dvr_window_sec":0,"idem_key":"ac5cc60bc97456f7ea6a06be0de9f8addfc7d8b08a863777a71329be54c725ea","gpu_available":true,"hwaccel_requested":"auto","hwaccel_effective":"off","hwaccel_reason":"passthrough","encoder_backend":"none","video_codec":"","container":"","llhls":false,"time":"2026-02-01T14:53:00+01:00","message":"intent profile resolved"}
{"level":"info","service":"xg2g","version":"","component":"api","correlationId":"corr-intent-001","time":"2026-02-01T14:53:00+01:00","message":"intent accepted"}
--- PASS: TestV3Contract_Intents (0.18s)
=== RUN   TestV3Contract_Intents_AdmissionRejected
{"level":"error","service":"xg2g","version":"","error":"context deadline exceeded","time":"2026-02-01T14:53:00+01:00","message":"admission state snapshot failed, failing closed"}
{"level":"info","service":"xg2g","version":"","serviceRef":"1:0:1:445D:453:1:C00000:0:0:0:","code":"ADMISSION_STATE_UNKNOWN","time":"2026-02-01T14:53:00+01:00","message":"admission rejected"}
--- PASS: TestV3Contract_Intents_AdmissionRejected (0.00s)
=== RUN   TestV3Contract_IntentLeaseBusy
=== RUN   TestV3Contract_IntentLeaseBusy/phase2_idempotent_replay
{"level":"info","service":"xg2g","version":"","component":"api","correlationId":"corr-intent-001","ua":"","profile":"high","dvr_window_sec":0,"idem_key":"ac5cc60bc97456f7ea6a06be0de9f8addfc7d8b08a863777a71329be54c725ea","gpu_available":true,"hwaccel_requested":"auto","hwaccel_effective":"off","hwaccel_reason":"passthrough","encoder_backend":"none","video_codec":"","container":"","llhls":false,"time":"2026-02-01T14:53:00+01:00","message":"intent profile resolved"}
{"level":"info","service":"xg2g","version":"","component":"api","correlationId":"corr-intent-001","time":"2026-02-01T14:53:00+01:00","message":"intent accepted"}
{"level":"info","service":"xg2g","version":"","component":"api","correlationId":"corr-intent-001","ua":"","profile":"high","dvr_window_sec":0,"idem_key":"ac5cc60bc97456f7ea6a06be0de9f8addfc7d8b08a863777a71329be54c725ea","gpu_available":true,"hwaccel_requested":"auto","hwaccel_effective":"off","hwaccel_reason":"passthrough","encoder_backend":"none","video_codec":"","container":"","llhls":false,"time":"2026-02-01T14:53:00+01:00","message":"intent profile resolved"}
{"level":"info","service":"xg2g","version":"","component":"api","correlationId":"corr-intent-001","existing_sid":"ea56b99f-db6c-47c5-837e-7c5050f72783","time":"2026-02-01T14:53:00+01:00","message":"idempotent replay detected"}
--- PASS: TestV3Contract_IntentLeaseBusy (0.06s)
    --- PASS: TestV3Contract_IntentLeaseBusy/phase2_idempotent_replay (0.06s)
=== RUN   TestV3Contract_SessionState
--- PASS: TestV3Contract_SessionState (0.00s)
=== RUN   TestV3Contract_SessionState_TerminalOutcomeMatrix
=== RUN   TestV3Contract_SessionState_TerminalOutcomeMatrix/cancelled_context
=== RUN   TestV3Contract_SessionState_TerminalOutcomeMatrix/stopped_strips_cancel_detail
{"level":"warn","service":"xg2g","version":"","sessionId":"550e8400-e29b-41d4-a716-446655440000","time":"2026-02-01T14:53:00+01:00","message":"corrected stopped detail_code"}
=== RUN   TestV3Contract_SessionState_TerminalOutcomeMatrix/failed_tune_timeout
--- PASS: TestV3Contract_SessionState_TerminalOutcomeMatrix (0.00s)
    --- PASS: TestV3Contract_SessionState_TerminalOutcomeMatrix/cancelled_context (0.00s)
    --- PASS: TestV3Contract_SessionState_TerminalOutcomeMatrix/stopped_strips_cancel_detail (0.00s)
    --- PASS: TestV3Contract_SessionState_TerminalOutcomeMatrix/failed_tune_timeout (0.00s)
=== RUN   TestV3Contract_ReadyImpliesPlayable
--- PASS: TestV3Contract_ReadyImpliesPlayable (0.00s)
=== RUN   TestV3Contract_HLS
--- PASS: TestV3Contract_HLS (0.02s)
=== RUN   TestV3Contract_HLSRange
--- PASS: TestV3Contract_HLSRange (0.00s)
=== RUN   TestTraceability_RecordingsList
--- PASS: TestTraceability_RecordingsList (0.00s)
=== RUN   TestTraceability_GetSession_Real
--- PASS: TestTraceability_GetSession_Real (0.00s)
=== RUN   TestTraceability_GetStreams
--- PASS: TestTraceability_GetStreams (0.00s)
=== RUN   TestTraceability_RFC7807_Error
{"level":"error","service":"xg2g","version":"","error":"simulated error","time":"2026-02-01T14:53:00+01:00","message":"recordings service error"}
--- PASS: TestTraceability_RFC7807_Error (0.00s)
=== RUN   TestContract_Global_ProblemDetails
=== RUN   TestContract_Global_ProblemDetails/1_InvalidJSON_AddTimer
    contract_v3_write_test.go:94: Response: Status=400 Body=map[code:INVALID_INPUT detail:The request body is malformed or empty instance:/api/v3/dvr/timers requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Request Body type:dvr/invalid_input]
=== RUN   TestContract_Global_ProblemDetails/2_InvalidJSON_UpdateTimer
    contract_v3_write_test.go:102: Response: Status=400 Body=map[code:INVALID_INPUT detail:The request body is malformed or empty instance:/api/v3/dvr/timers/123 requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Request Body type:dvr/invalid_input]
=== RUN   TestContract_Global_ProblemDetails/3_InvalidBody_PreviewConflicts
    contract_v3_write_test.go:110: Response: Status=400 Body=map[code:INVALID_INPUT detail:The request body is malformed or empty instance:/api/v3/dvr/timers/conflicts/preview requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Request Body type:dvr/invalid_input]
=== RUN   TestContract_Global_ProblemDetails/4_InvalidID_DeleteStreams
    contract_v3_write_test.go:121: Server type: *v3.Server
    contract_v3_write_test.go:122: isSafe=false
    contract_v3_write_test.go:127: status=400 ct="application/problem+json"
    contract_v3_write_test.go:129: Response: Status=400 Body=map[code:INVALID_SESSION_ID detail:The provided session ID contains unsafe characters instance:/api/v3/streams/../unsafe requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Session ID type:streams/invalid_id]
=== RUN   TestContract_Global_ProblemDetails/5_InvalidTimerID_DeleteTimer
    contract_v3_write_test.go:137: Response: Status=400 Body=map[code:INVALID_ID detail:The provided timer ID is invalid instance:/api/v3/dvr/timers/bad-id requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Timer ID type:dvr/invalid_id]
=== RUN   TestContract_Global_ProblemDetails/6_InvalidTimerID_UpdateTimer
    contract_v3_write_test.go:145: Response: Status=400 Body=map[code:INVALID_ID detail:The provided timer ID is invalid instance:/api/v3/dvr/timers/bad-id requestId:FALLBACK-TRUTH-MISSING status:400 title:Invalid Timer ID type:dvr/invalid_id]
=== RUN   TestContract_Global_ProblemDetails/7_ControlPlaneDisabled_DeleteStreams
    contract_v3_write_test.go:154: Response: Status=503 Body=map[code:UNAVAILABLE detail:V3 control plane is not enabled instance:/api/v3/streams/123 requestId:FALLBACK-TRUTH-MISSING status:503 title:Control Plane Unavailable type:streams/unavailable]
=== RUN   TestContract_Global_ProblemDetails/8_ControlPlaneDisabled_GetStreams
{"level":"error","service":"xg2g","version":"","time":"2026-02-01T14:53:00+01:00","message":"v3 store not initialized"}
    contract_v3_write_test.go:163: Response: Status=503 Body=map[code:UNAVAILABLE detail:The V3 control plane is not enabled instance:/api/v3/streams requestId:FALLBACK-TRUTH-MISSING status:503 title:V3 control plane not enabled type:streams/unavailable]
=== RUN   TestContract_Global_ProblemDetails/12b_ProblemDetails_OmitsDetails_WhenNil
{"level":"error","service":"xg2g","version":"","time":"2026-02-01T14:53:00+01:00","message":"v3 store not initialized"}
--- PASS: TestContract_Global_ProblemDetails (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/1_InvalidJSON_AddTimer (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/2_InvalidJSON_UpdateTimer (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/3_InvalidBody_PreviewConflicts (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/4_InvalidID_DeleteStreams (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/5_InvalidTimerID_DeleteTimer (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/6_InvalidTimerID_UpdateTimer (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/7_ControlPlaneDisabled_DeleteStreams (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/8_ControlPlaneDisabled_GetStreams (0.00s)
    --- PASS: TestContract_Global_ProblemDetails/12b_ProblemDetails_OmitsDetails_WhenNil (0.00s)
=== RUN   TestHealthEquivalence_Hardened
--- PASS: TestHealthEquivalence_Hardened (0.00s)
=== RUN   TestConfigEquivalence_Hardened
--- PASS: TestConfigEquivalence_Hardened (0.00s)
=== RUN   TestConfigRedaction_Hardened
--- PASS: TestConfigRedaction_Hardened (0.00s)
=== RUN   TestHealthVsHealthzDivergence_Hardened
--- PASS: TestHealthVsHealthzDivergence_Hardened (0.00s)
=== RUN   TestSlice5_1_Equivalence
=== RUN   TestSlice5_1_Equivalence/Scan_Status
=== RUN   TestSlice5_1_Equivalence/DVR_Capabilities
=== RUN   TestSlice5_1_Equivalence/DVR_Status
=== RUN   TestSlice5_1_Equivalence/Services_Bouquets
--- PASS: TestSlice5_1_Equivalence (0.00s)
    --- PASS: TestSlice5_1_Equivalence/Scan_Status (0.00s)
    --- PASS: TestSlice5_1_Equivalence/DVR_Capabilities (0.00s)
    --- PASS: TestSlice5_1_Equivalence/DVR_Status (0.00s)
    --- PASS: TestSlice5_1_Equivalence/Services_Bouquets (0.00s)
=== RUN   TestSlice5_2_Equivalence
=== RUN   TestSlice5_2_Equivalence/GetServices/Combinatorial
=== RUN   TestSlice5_2_Equivalence/GetServices/Combinatorial/All_Services
=== RUN   TestSlice5_2_Equivalence/GetServices/Combinatorial/Favorites_Only
=== RUN   TestSlice5_2_Equivalence/GetServices/Combinatorial/Movies_Only
=== RUN   TestSlice5_2_Equivalence/GetServices/Combinatorial/Non_Existent
=== RUN   TestSlice5_2_Equivalence/GetTimers/All
=== RUN   TestSlice5_2_Equivalence/GetServices/Playlist_Missing
DEBUG: GetServices ReadFile failed: /tmp/TestSlice5_2_Equivalence1394402139/001/test.m3u, err=open /tmp/TestSlice5_2_Equivalence1394402139/001/test.m3u: no such file or directory
=== RUN   TestSlice5_2_Equivalence/GetServices/Playlist_Empty
=== RUN   TestSlice5_2_Equivalence/GetServices/PlaylistFilename_Missing
DEBUG: GetServices ReadFile failed: /tmp/TestSlice5_2_Equivalence1394402139/001/missing.m3u, err=open /tmp/TestSlice5_2_Equivalence1394402139/001/missing.m3u: no such file or directory
=== RUN   TestSlice5_2_Equivalence/GetServicesBouquets/Empty
=== RUN   TestSlice5_2_Equivalence/GetServicesBouquets/PlaylistFilename_Missing_ConfigBouquetEmpty
=== RUN   TestSlice5_2_Equivalence/GetEpg/Combinatorial
=== RUN   TestSlice5_2_Equivalence/GetEpg/Combinatorial/All_Events_Wide_Window
=== RUN   TestSlice5_2_Equivalence/GetEpg/Combinatorial/Restricted_Window_First_Event
=== RUN   TestSlice5_2_Equivalence/GetEpg/Combinatorial/Bouquet_Filter_Favorites_Only_id1
=== RUN   TestSlice5_2_Equivalence/GetEpg/Combinatorial/Bouquet_Filter_Playlist_Missing
=== RUN   TestSlice5_2_Equivalence/GetEpg/Combinatorial/Search_Query_News
=== RUN   TestSlice5_2_Equivalence/GetEpg/Combinatorial/Search_Query_NoMatch
=== RUN   TestSlice5_2_Equivalence/GetEpg/Bouquet_Filter_Failure
=== RUN   TestSlice5_2_Equivalence/GetEpg/Bouquet_Filter_Failure/Playlist_Missing_With_Bouquet
=== RUN   TestSlice5_2_Equivalence/GetEpg/Bouquet_Filter_Failure/Playlist_Missing_With_Bouquet_And_Search
--- PASS: TestSlice5_2_Equivalence (0.01s)
    --- PASS: TestSlice5_2_Equivalence/GetServices/Combinatorial (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetServices/Combinatorial/All_Services (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetServices/Combinatorial/Favorites_Only (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetServices/Combinatorial/Movies_Only (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetServices/Combinatorial/Non_Existent (0.00s)
    --- PASS: TestSlice5_2_Equivalence/GetTimers/All (0.00s)
    --- PASS: TestSlice5_2_Equivalence/GetServices/Playlist_Missing (0.00s)
    --- PASS: TestSlice5_2_Equivalence/GetServices/Playlist_Empty (0.00s)
    --- PASS: TestSlice5_2_Equivalence/GetServices/PlaylistFilename_Missing (0.00s)
    --- PASS: TestSlice5_2_Equivalence/GetServicesBouquets/Empty (0.00s)
    --- PASS: TestSlice5_2_Equivalence/GetServicesBouquets/PlaylistFilename_Missing_ConfigBouquetEmpty (0.00s)
    --- PASS: TestSlice5_2_Equivalence/GetEpg/Combinatorial (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetEpg/Combinatorial/All_Events_Wide_Window (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetEpg/Combinatorial/Restricted_Window_First_Event (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetEpg/Combinatorial/Bouquet_Filter_Favorites_Only_id1 (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetEpg/Combinatorial/Bouquet_Filter_Playlist_Missing (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetEpg/Combinatorial/Search_Query_News (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetEpg/Combinatorial/Search_Query_NoMatch (0.00s)
    --- PASS: TestSlice5_2_Equivalence/GetEpg/Bouquet_Filter_Failure (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetEpg/Bouquet_Filter_Failure/Playlist_Missing_With_Bouquet (0.00s)
        --- PASS: TestSlice5_2_Equivalence/GetEpg/Bouquet_Filter_Failure/Playlist_Missing_With_Bouquet_And_Search (0.00s)
=== RUN   TestWriteJSON
=== RUN   TestWriteJSON/simple_map
=== RUN   TestWriteJSON/complex_struct
--- PASS: TestWriteJSON (0.00s)
    --- PASS: TestWriteJSON/simple_map (0.00s)
    --- PASS: TestWriteJSON/complex_struct (0.00s)
=== RUN   TestClientPlaybackInfo_StrictFailClosed
=== RUN   TestClientPlaybackInfo_StrictFailClosed/UnknownCodecs_=>_Transcode
{"level":"info","service":"xg2g","version":"","event":"client.playback_decision","id":"rec1","decision":"transcode","strategy":"direct","time":"2026-02-01T14:53:00+01:00","message":"resolved client playback"}
=== RUN   TestClientPlaybackInfo_StrictFailClosed/Known+Supported_=>_DirectPlay
{"level":"info","service":"xg2g","version":"","event":"client.playback_decision","id":"rec1","decision":"direct_play","strategy":"direct","container":"mp4","time":"2026-02-01T14:53:00+01:00","message":"resolved client playback"}
=== RUN   TestClientPlaybackInfo_StrictFailClosed/Known+Unsupported_=>_Transcode
{"level":"info","service":"xg2g","version":"","event":"client.playback_decision","id":"rec1","decision":"transcode","strategy":"direct","container":"mp4","time":"2026-02-01T14:53:00+01:00","message":"resolved client playback"}
=== RUN   TestClientPlaybackInfo_StrictFailClosed/DriftGuard_JsonKeys
{"level":"info","service":"xg2g","version":"","event":"client.playback_decision","id":"rec1","decision":"transcode","strategy":"direct","time":"2026-02-01T14:53:00+01:00","message":"resolved client playback"}
--- PASS: TestClientPlaybackInfo_StrictFailClosed (0.00s)
    --- PASS: TestClientPlaybackInfo_StrictFailClosed/UnknownCodecs_=>_Transcode (0.00s)
    --- PASS: TestClientPlaybackInfo_StrictFailClosed/Known+Supported_=>_DirectPlay (0.00s)
    --- PASS: TestClientPlaybackInfo_StrictFailClosed/Known+Unsupported_=>_Transcode (0.00s)
    --- PASS: TestClientPlaybackInfo_StrictFailClosed/DriftGuard_JsonKeys (0.00s)
=== RUN   TestGetEpg_ResponseShape
--- PASS: TestGetEpg_ResponseShape (0.00s)
=== RUN   TestHLS_ProfilePropagation
=== RUN   TestHLS_ProfilePropagation/Safari_Mac
=== RUN   TestHLS_ProfilePropagation/Generic_Chrome
--- PASS: TestHLS_ProfilePropagation (0.00s)
    --- PASS: TestHLS_ProfilePropagation/Safari_Mac (0.00s)
    --- PASS: TestHLS_ProfilePropagation/Generic_Chrome (0.00s)
=== RUN   TestHLSHandlers_Matrix
=== RUN   TestHLSHandlers_Matrix/Playlist_200_GET
=== RUN   TestHLSHandlers_Matrix/Playlist_200_HEAD
=== RUN   TestHLSHandlers_Matrix/Playlist_416_RangeViolation
=== RUN   TestHLSHandlers_Matrix/Playlist_503_Preparing
=== RUN   TestHLSHandlers_Matrix/Segment_200_GET
=== RUN   TestHLSHandlers_Matrix/Segment_206_Range
=== RUN   TestHLSHandlers_Matrix/Segment_416_InvalidRange
--- PASS: TestHLSHandlers_Matrix (0.00s)
    --- PASS: TestHLSHandlers_Matrix/Playlist_200_GET (0.00s)
    --- PASS: TestHLSHandlers_Matrix/Playlist_200_HEAD (0.00s)
    --- PASS: TestHLSHandlers_Matrix/Playlist_416_RangeViolation (0.00s)
    --- PASS: TestHLSHandlers_Matrix/Playlist_503_Preparing (0.00s)
    --- PASS: TestHLSHandlers_Matrix/Segment_200_GET (0.00s)
    --- PASS: TestHLSHandlers_Matrix/Segment_206_Range (0.00s)
    --- PASS: TestHLSHandlers_Matrix/Segment_416_InvalidRange (0.00s)
=== RUN   TestIntentsPreflight_ProblemMapping
=== RUN   TestIntentsPreflight_ProblemMapping/unreachable
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"unreachable","status":502,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
=== RUN   TestIntentsPreflight_ProblemMapping/timeout
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"timeout","status":504,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
=== RUN   TestIntentsPreflight_ProblemMapping/unauthorized
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"unauthorized","status":401,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
=== RUN   TestIntentsPreflight_ProblemMapping/forbidden
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"forbidden","status":403,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
=== RUN   TestIntentsPreflight_ProblemMapping/not_found
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"not_found","status":404,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
=== RUN   TestIntentsPreflight_ProblemMapping/bad_gateway
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"bad_gateway","status":502,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
=== RUN   TestIntentsPreflight_ProblemMapping/internal
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"error","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"internal","status":500,"time":"2026-02-01T14:53:00+01:00","message":"preflight failed"}
--- PASS: TestIntentsPreflight_ProblemMapping (0.00s)
    --- PASS: TestIntentsPreflight_ProblemMapping/unreachable (0.00s)
    --- PASS: TestIntentsPreflight_ProblemMapping/timeout (0.00s)
    --- PASS: TestIntentsPreflight_ProblemMapping/unauthorized (0.00s)
    --- PASS: TestIntentsPreflight_ProblemMapping/forbidden (0.00s)
    --- PASS: TestIntentsPreflight_ProblemMapping/not_found (0.00s)
    --- PASS: TestIntentsPreflight_ProblemMapping/bad_gateway (0.00s)
    --- PASS: TestIntentsPreflight_ProblemMapping/internal (0.00s)
=== RUN   TestIntentsPreflight_NoBestEffort
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"unreachable","status":502,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
--- PASS: TestIntentsPreflight_NoBestEffort (0.00s)
=== RUN   TestIntentsPreflight_Metrics
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"unreachable","status":502,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
--- PASS: TestIntentsPreflight_Metrics (0.01s)
=== RUN   TestIntentsPreflight_DetailNoSecrets
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.invalid","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:00+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"api","request_id":"req-preflight-001","outcome":"unauthorized","status":401,"time":"2026-02-01T14:53:00+01:00","message":"preflight rejected"}
--- PASS: TestIntentsPreflight_DetailNoSecrets (0.00s)
=== RUN   TestGetRecordingPlaybackInfo_P3_4_SegmentTruth
=== RUN   TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/Traceability_Propagation
=== RUN   TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/Live_FailClosed_ImplausibleWindow
=== RUN   TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/Live_FailClosed_PartialPDT
=== RUN   TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/VOD_Robust_NoPDT
=== RUN   TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/Live_Valid_FullTruth
--- PASS: TestGetRecordingPlaybackInfo_P3_4_SegmentTruth (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/Traceability_Propagation (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/Live_FailClosed_ImplausibleWindow (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/Live_FailClosed_PartialPDT (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/VOD_Robust_NoPDT (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_P3_4_SegmentTruth/Live_Valid_FullTruth (0.00s)
=== RUN   TestGetRecordingPlaybackInfo_StrictTruthfulness
=== RUN   TestGetRecordingPlaybackInfo_StrictTruthfulness/NotFound
=== RUN   TestGetRecordingPlaybackInfo_StrictTruthfulness/Preparing
=== RUN   TestGetRecordingPlaybackInfo_StrictTruthfulness/InvalidArgument
=== RUN   TestGetRecordingPlaybackInfo_StrictTruthfulness/UpstreamError
=== RUN   TestGetRecordingPlaybackInfo_StrictTruthfulness/DTO_Mapping_UnknownDuration_UnknownCodecs
=== RUN   TestGetRecordingPlaybackInfo_StrictTruthfulness/DTO_Mapping_KnownDuration_KnownCodecs
--- PASS: TestGetRecordingPlaybackInfo_StrictTruthfulness (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_StrictTruthfulness/NotFound (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_StrictTruthfulness/Preparing (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_StrictTruthfulness/InvalidArgument (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_StrictTruthfulness/UpstreamError (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_StrictTruthfulness/DTO_Mapping_UnknownDuration_UnknownCodecs (0.00s)
    --- PASS: TestGetRecordingPlaybackInfo_StrictTruthfulness/DTO_Mapping_KnownDuration_KnownCodecs (0.00s)
=== RUN   TestGetRecordingPlaybackInfo_ID_Ownership_StrictHexRequirement
--- PASS: TestGetRecordingPlaybackInfo_ID_Ownership_StrictHexRequirement (0.00s)
=== RUN   TestGetRecordingPlaybackInfo_Deny_OptionB
--- PASS: TestGetRecordingPlaybackInfo_Deny_OptionB (0.00s)
=== RUN   TestGetServicesBouquets_ResponseShapeAndCounts
--- PASS: TestGetServicesBouquets_ResponseShapeAndCounts (0.00s)
=== RUN   TestGetServicesBouquets_Fallback
--- PASS: TestGetServicesBouquets_Fallback (0.00s)
=== RUN   TestGetServicesBouquets_EmptyFile
--- PASS: TestGetServicesBouquets_EmptyFile (0.00s)
=== RUN   TestGetServicesBouquets_FailClosed
{"level":"error","service":"xg2g","version":"","error":"read /tmp/TestGetServicesBouquets_FailClosed3600104799/001/bad.m3u: is a directory","cause":"read","time":"2026-02-01T14:53:00+01:00","message":"failed to get bouquets"}
--- PASS: TestGetServicesBouquets_FailClosed (0.00s)
=== RUN   TestStreamRecordingDirect_RangeMatrix
=== RUN   TestStreamRecordingDirect_RangeMatrix/Full_GET
=== RUN   TestStreamRecordingDirect_RangeMatrix/Partial_FirstByte
=== RUN   TestStreamRecordingDirect_RangeMatrix/Partial_First100
=== RUN   TestStreamRecordingDirect_RangeMatrix/Partial_Suffix
=== RUN   TestStreamRecordingDirect_RangeMatrix/Partial_OpenEnded
=== RUN   TestStreamRecordingDirect_RangeMatrix/Invalid_OutOfRange
=== RUN   TestStreamRecordingDirect_RangeMatrix/Invalid_MultiRange_PolicyA
=== RUN   TestStreamRecordingDirect_RangeMatrix/Full_HEAD
=== RUN   TestStreamRecordingDirect_RangeMatrix/Partial_HEAD
--- PASS: TestStreamRecordingDirect_RangeMatrix (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Full_GET (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Partial_FirstByte (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Partial_First100 (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Partial_Suffix (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Partial_OpenEnded (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Invalid_OutOfRange (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Invalid_MultiRange_PolicyA (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Full_HEAD (0.00s)
    --- PASS: TestStreamRecordingDirect_RangeMatrix/Partial_HEAD (0.00s)
=== RUN   TestHotReload_LogLevel_Hardened
--- PASS: TestHotReload_LogLevel_Hardened (0.00s)
=== RUN   TestHotReload_AuditGating_Killer
--- PASS: TestHotReload_AuditGating_Killer (0.00s)
=== RUN   TestHotReload_SliceNormalization_Hardened
--- PASS: TestHotReload_SliceNormalization_Hardened (0.00s)
=== RUN   TestHotReload_EmptyBouquets_CSVNormalization
--- PASS: TestHotReload_EmptyBouquets_CSVNormalization (0.00s)
=== RUN   TestHotReload_ConcurrencyStress
--- PASS: TestHotReload_ConcurrencyStress (0.05s)
=== RUN   TestHotReload_LogBuffer_OOM_Prevention
--- PASS: TestHotReload_LogBuffer_OOM_Prevention (0.03s)
=== RUN   TestWriterTransparent_TruthTable
=== RUN   TestWriterTransparent_TruthTable/none
=== RUN   TestWriterTransparent_TruthTable/rf
=== RUN   TestWriterTransparent_TruthTable/h
=== RUN   TestWriterTransparent_TruthTable/rf_h
=== RUN   TestWriterTransparent_TruthTable/f
=== RUN   TestWriterTransparent_TruthTable/rf_f
=== RUN   TestWriterTransparent_TruthTable/h_f
=== RUN   TestWriterTransparent_TruthTable/rf_h_f
=== RUN   TestWriterTransparent_TruthTable/p
=== RUN   TestWriterTransparent_TruthTable/rf_p
=== RUN   TestWriterTransparent_TruthTable/h_p
=== RUN   TestWriterTransparent_TruthTable/rf_h_p
=== RUN   TestWriterTransparent_TruthTable/f_p
=== RUN   TestWriterTransparent_TruthTable/rf_f_p
=== RUN   TestWriterTransparent_TruthTable/h_f_p
=== RUN   TestWriterTransparent_TruthTable/rf_h_f_p
--- PASS: TestWriterTransparent_TruthTable (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/none (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/rf (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/h (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/rf_h (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/f (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/rf_f (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/h_f (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/rf_h_f (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/p (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/rf_p (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/h_p (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/rf_h_p (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/f_p (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/rf_f_p (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/h_f_p (0.00s)
    --- PASS: TestWriterTransparent_TruthTable/rf_h_f_p (0.00s)
=== RUN   TestWriterTransparent_StatusTracking
=== RUN   TestWriterTransparent_StatusTracking/WriteHeader
=== RUN   TestWriterTransparent_StatusTracking/Write
=== RUN   TestWriterTransparent_StatusTracking/ReadFrom
=== RUN   TestWriterTransparent_StatusTracking/Unwrap
--- PASS: TestWriterTransparent_StatusTracking (0.00s)
    --- PASS: TestWriterTransparent_StatusTracking/WriteHeader (0.00s)
    --- PASS: TestWriterTransparent_StatusTracking/Write (0.00s)
    --- PASS: TestWriterTransparent_StatusTracking/ReadFrom (0.00s)
    --- PASS: TestWriterTransparent_StatusTracking/Unwrap (0.00s)
=== RUN   TestIntentErrorMapping_Table
--- PASS: TestIntentErrorMapping_Table (0.00s)
=== RUN   TestIntentErrorMapping_ResponseShape
--- PASS: TestIntentErrorMapping_ResponseShape (0.00s)
=== RUN   TestIsNil_TypedNilTrap
--- PASS: TestIsNil_TypedNilTrap (0.00s)
=== RUN   TestSetDependencies_HandlesTypedNil
--- PASS: TestSetDependencies_HandlesTypedNil (0.00s)
=== RUN   TestProblemDetails_Compliance
=== RUN   TestProblemDetails_Compliance/Status_500_-_System_Error
=== RUN   TestProblemDetails_Compliance/Status_400_-_Invalid_Input
--- PASS: TestProblemDetails_Compliance (0.00s)
    --- PASS: TestProblemDetails_Compliance/Status_500_-_System_Error (0.00s)
    --- PASS: TestProblemDetails_Compliance/Status_400_-_Invalid_Input (0.00s)
=== RUN   TestOWIAdapter_FilesizePropagated
--- PASS: TestOWIAdapter_FilesizePropagated (0.00s)
=== RUN   TestOWIAdapter_FilesizeZeroPreserved
--- PASS: TestOWIAdapter_FilesizeZeroPreserved (0.00s)
=== RUN   TestOWIAdapter_FilesizeStringPreserved
--- PASS: TestOWIAdapter_FilesizeStringPreserved (0.00s)
=== RUN   TestGetRecordings_Contract_UpstreamFailure
--- PASS: TestGetRecordings_Contract_UpstreamFailure (0.00s)
=== RUN   TestHLSPlaylist_NoSyncPreflightIO
--- PASS: TestHLSPlaylist_NoSyncPreflightIO (0.00s)
=== RUN   TestGetRecordingHLSPlaylist_FailedPromotesReady
--- PASS: TestGetRecordingHLSPlaylist_FailedPromotesReady (0.00s)
=== RUN   TestGetRecordingHLSPlaylist_Failed_Reconcile_BuildCallbackPromotesReady
{"level":"info","jobId":"/tmp/TestGetRecordingHLSPlaylist_Failed_Reconcile_BuildCallbackPromot1214619483/001/recordings/b88707d0e76991df0f88380e6f1f942866f17fbbf70b25b592a97e346b02c842","time":"2026-02-01T14:53:00+01:00","message":"VOD build process completed successfully"}
{"level":"info","jobId":"/tmp/TestGetRecordingHLSPlaylist_Failed_Reconcile_BuildCallbackPromot1214619483/001/recordings/b88707d0e76991df0f88380e6f1f942866f17fbbf70b25b592a97e346b02c842","finalPath":"/tmp/TestGetRecordingHLSPlaylist_Failed_Reconcile_BuildCallbackPromot1214619483/001/recordings/b88707d0e76991df0f88380e6f1f942866f17fbbf70b25b592a97e346b02c842/index.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD build published successfully"}
{"level":"info","jobId":"/tmp/TestGetRecordingHLSPlaylist_Failed_Reconcile_BuildCallbackPromot1214619483/001/recordings/b88707d0e76991df0f88380e6f1f942866f17fbbf70b25b592a97e346b02c842","metaId":"1:0:0:0:0:0:0:0:0:/media/nfs/build.ts","oldState":"PREPARING","newState":"READY","playlistPath":"/tmp/TestGetRecordingHLSPlaylist_Failed_Reconcile_BuildCallbackPromot1214619483/001/recordings/b88707d0e76991df0f88380e6f1f942866f17fbbf70b25b592a97e346b02c842/index.m3u8","stateGen":2,"time":"2026-02-01T14:53:00+01:00","message":"VOD manager: metadata updated"}
--- PASS: TestGetRecordingHLSPlaylist_Failed_Reconcile_BuildCallbackPromotesReady (0.01s)
=== RUN   TestGetRecordingHLSPlaylist_FailedStampedeTriggersSingleBuild
--- PASS: TestGetRecordingHLSPlaylist_FailedStampedeTriggersSingleBuild (0.00s)
=== RUN   TestGetRecordingHLSPlaylist_FailedLatencySLO
{"level":"info","jobId":"/tmp/TestGetRecordingHLSPlaylist_FailedLatencySLO1361914164/001/recordings/0cf2e02b8da5160dd81b286e0fae78f966f5ba2dabe812871ecabcb4d63284e3","time":"2026-02-01T14:53:00+01:00","message":"VOD build process completed successfully"}
{"level":"info","jobId":"/tmp/TestGetRecordingHLSPlaylist_FailedLatencySLO1361914164/001/recordings/0cf2e02b8da5160dd81b286e0fae78f966f5ba2dabe812871ecabcb4d63284e3","finalPath":"/tmp/TestGetRecordingHLSPlaylist_FailedLatencySLO1361914164/001/recordings/0cf2e02b8da5160dd81b286e0fae78f966f5ba2dabe812871ecabcb4d63284e3/index.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD build published successfully"}
{"level":"info","jobId":"/tmp/TestGetRecordingHLSPlaylist_FailedLatencySLO1361914164/001/recordings/0cf2e02b8da5160dd81b286e0fae78f966f5ba2dabe812871ecabcb4d63284e3","metaId":"1:0:0:0:0:0:0:0:0:/media/nfs/latency.ts","oldState":"PREPARING","newState":"READY","playlistPath":"/tmp/TestGetRecordingHLSPlaylist_FailedLatencySLO1361914164/001/recordings/0cf2e02b8da5160dd81b286e0fae78f966f5ba2dabe812871ecabcb4d63284e3/index.m3u8","stateGen":2,"time":"2026-02-01T14:53:00+01:00","message":"VOD manager: metadata updated"}
--- PASS: TestGetRecordingHLSPlaylist_FailedLatencySLO (0.01s)
=== RUN   TestGetRecordingHLSPlaylist_OpenFailure_ReconcileReady
    recordings_hls_reconcile_test.go:313: Skipping flaky async reconciliation test
--- SKIP: TestGetRecordingHLSPlaylist_OpenFailure_ReconcileReady (0.00s)
=== RUN   TestProbeDurationIntegration
    recordings_probe_verification_test.go:39: Skipping integration test requiring full server setup
--- SKIP: TestProbeDurationIntegration (1.14s)
=== RUN   TestExtractPathFromServiceRef
=== RUN   TestExtractPathFromServiceRef/standard_enigma2_service_ref
=== RUN   TestExtractPathFromServiceRef/extended_enigma2_service_ref_with_more_colons
=== RUN   TestExtractPathFromServiceRef/path_with_spaces
=== RUN   TestExtractPathFromServiceRef/no_colon_-_return_as-is
=== RUN   TestExtractPathFromServiceRef/colon_but_no_absolute_path_-_return_as-is_(defensive)
=== RUN   TestExtractPathFromServiceRef/empty_string
=== RUN   TestExtractPathFromServiceRef/only_colons
=== RUN   TestExtractPathFromServiceRef/trailing_colon_no_path
=== RUN   TestExtractPathFromServiceRef/windows-style_path_(not_supported,_returned_as-is)
=== RUN   TestExtractPathFromServiceRef/path_with_special_characters
=== RUN   TestExtractPathFromServiceRef/path_with_unicode_characters
=== RUN   TestExtractPathFromServiceRef/path_with_url_encoding_(already_decoded)
=== RUN   TestExtractPathFromServiceRef/root_path
=== RUN   TestExtractPathFromServiceRef/deep_nested_path
--- PASS: TestExtractPathFromServiceRef (0.00s)
    --- PASS: TestExtractPathFromServiceRef/standard_enigma2_service_ref (0.00s)
    --- PASS: TestExtractPathFromServiceRef/extended_enigma2_service_ref_with_more_colons (0.00s)
    --- PASS: TestExtractPathFromServiceRef/path_with_spaces (0.00s)
    --- PASS: TestExtractPathFromServiceRef/no_colon_-_return_as-is (0.00s)
    --- PASS: TestExtractPathFromServiceRef/colon_but_no_absolute_path_-_return_as-is_(defensive) (0.00s)
    --- PASS: TestExtractPathFromServiceRef/empty_string (0.00s)
    --- PASS: TestExtractPathFromServiceRef/only_colons (0.00s)
    --- PASS: TestExtractPathFromServiceRef/trailing_colon_no_path (0.00s)
    --- PASS: TestExtractPathFromServiceRef/windows-style_path_(not_supported,_returned_as-is) (0.00s)
    --- PASS: TestExtractPathFromServiceRef/path_with_special_characters (0.00s)
    --- PASS: TestExtractPathFromServiceRef/path_with_unicode_characters (0.00s)
    --- PASS: TestExtractPathFromServiceRef/path_with_url_encoding_(already_decoded) (0.00s)
    --- PASS: TestExtractPathFromServiceRef/root_path (0.00s)
    --- PASS: TestExtractPathFromServiceRef/deep_nested_path (0.00s)
=== RUN   TestRecordingsStatusHTTP_IdleOmitsError
--- PASS: TestRecordingsStatusHTTP_IdleOmitsError (0.00s)
=== RUN   TestRecordingsStatusHTTP_MetaFailedIncludesError
--- PASS: TestRecordingsStatusHTTP_MetaFailedIncludesError (0.00s)
=== RUN   TestV3_ResponseGolden
=== RUN   TestV3_ResponseGolden/PlaybackInfo_JSON_Shape
=== RUN   TestV3_ResponseGolden/ProblemDetails_JSON_Shape
--- PASS: TestV3_ResponseGolden (0.00s)
    --- PASS: TestV3_ResponseGolden/PlaybackInfo_JSON_Shape (0.00s)
    --- PASS: TestV3_ResponseGolden/ProblemDetails_JSON_Shape (0.00s)
=== RUN   TestRouterParity_HandRouter
--- PASS: TestRouterParity_HandRouter (0.00s)
=== RUN   TestRouterParity_ProductionWiring
--- PASS: TestRouterParity_ProductionWiring (0.01s)
=== RUN   TestRouterParity_AuthZMatrix
--- PASS: TestRouterParity_AuthZMatrix (0.00s)
=== RUN   TestPlaybackInfo_SchemaCompliance
--- PASS: TestPlaybackInfo_SchemaCompliance (0.00s)
=== RUN   TestUpdateSeriesRule_Success
--- PASS: TestUpdateSeriesRule_Success (0.00s)
=== RUN   TestUpdateSeriesRule_NotFound
--- PASS: TestUpdateSeriesRule_NotFound (0.00s)
=== RUN   TestUpdateSeriesRule_EmptyKeyword
--- PASS: TestUpdateSeriesRule_EmptyKeyword (0.00s)
=== RUN   TestMapSessionState
--- PASS: TestMapSessionState (0.00s)
=== RUN   TestMapSessionReason
--- PASS: TestMapSessionReason (0.00s)
=== RUN   TestFindMountForPath
--- PASS: TestFindMountForPath (0.00s)
=== RUN   TestUnescapeMountPath
--- PASS: TestUnescapeMountPath (0.00s)
=== RUN   TestOpenAPIPresence
--- PASS: TestOpenAPIPresence (0.09s)
=== RUN   TestFactoryWiring
--- PASS: TestFactoryWiring (0.00s)
=== RUN   TestContract_PlaybackInfo_Preparing
--- PASS: TestContract_PlaybackInfo_Preparing (0.00s)
=== RUN   TestContract_PlaybackInfo_Forbidden
--- PASS: TestContract_PlaybackInfo_Forbidden (0.00s)
=== RUN   TestContract_PlaybackInfo_NotFound
--- PASS: TestContract_PlaybackInfo_NotFound (0.00s)
=== RUN   TestContract_PlaybackInfo_UpstreamError
--- PASS: TestContract_PlaybackInfo_UpstreamError (0.00s)
=== RUN   TestInvariant_SuccessAlwaysSeekable
--- PASS: TestInvariant_SuccessAlwaysSeekable (0.00s)
=== RUN   TestSystemConfigContract
--- PASS: TestSystemConfigContract (0.00s)
PASS
coverage: 57.8% of statements
ok  	github.com/ManuGH/xg2g/internal/control/http/v3	3.835s	coverage: 57.8% of statements
=== RUN   TestWriteStatus_InvalidID
--- PASS: TestWriteStatus_InvalidID (0.00s)
=== RUN   TestWriteStatus_Success
--- PASS: TestWriteStatus_Success (0.00s)
=== RUN   TestRewritePlaylistType_DiscontinuityPreservation
--- PASS: TestRewritePlaylistType_DiscontinuityPreservation (0.00s)
=== RUN   TestRewritePlaylistType_MultipleDiscontinuities
--- PASS: TestRewritePlaylistType_MultipleDiscontinuities (0.00s)
=== RUN   TestRP41_FinalityLock
--- PASS: TestRP41_FinalityLock (0.00s)
=== RUN   TestRP41_Monotonicity
--- PASS: TestRP41_Monotonicity (0.00s)
=== RUN   TestRP41_SmallDeltaIgnored
--- PASS: TestRP41_SmallDeltaIgnored (0.00s)
=== RUN   TestRP41_FinalUpdateSource
--- PASS: TestRP41_FinalUpdateSource (0.00s)
=== RUN   TestRP41_StateTransitionLegality
--- PASS: TestRP41_StateTransitionLegality (0.00s)
=== RUN   TestRP41_MetaValidation
--- PASS: TestRP41_MetaValidation (0.00s)
=== RUN   TestDeleteRecording_InvalidID
--- PASS: TestDeleteRecording_InvalidID (0.00s)
=== RUN   TestDeleteRecording_Success
--- PASS: TestDeleteRecording_Success (0.00s)
=== RUN   TestDeleteRecording_UpstreamFailure
--- PASS: TestDeleteRecording_UpstreamFailure (0.00s)
=== RUN   TestDeleteRecording_UpstreamErrors
=== RUN   TestDeleteRecording_UpstreamErrors/upstream_404_maps_to_404
=== RUN   TestDeleteRecording_UpstreamErrors/upstream_auth_maps_to_403
=== RUN   TestDeleteRecording_UpstreamErrors/upstream_timeout_maps_to_504
=== RUN   TestDeleteRecording_UpstreamErrors/upstream_unavailable_maps_to_502
=== RUN   TestDeleteRecording_UpstreamErrors/upstream_5xx_maps_to_502
=== RUN   TestDeleteRecording_UpstreamErrors/malformed_upstream_response_maps_to_502
=== RUN   TestDeleteRecording_UpstreamErrors/unknown_error_maps_to_500
--- PASS: TestDeleteRecording_UpstreamErrors (0.00s)
    --- PASS: TestDeleteRecording_UpstreamErrors/upstream_404_maps_to_404 (0.00s)
    --- PASS: TestDeleteRecording_UpstreamErrors/upstream_auth_maps_to_403 (0.00s)
    --- PASS: TestDeleteRecording_UpstreamErrors/upstream_timeout_maps_to_504 (0.00s)
    --- PASS: TestDeleteRecording_UpstreamErrors/upstream_unavailable_maps_to_502 (0.00s)
    --- PASS: TestDeleteRecording_UpstreamErrors/upstream_5xx_maps_to_502 (0.00s)
    --- PASS: TestDeleteRecording_UpstreamErrors/malformed_upstream_response_maps_to_502 (0.00s)
    --- PASS: TestDeleteRecording_UpstreamErrors/unknown_error_maps_to_500 (0.00s)
PASS
coverage: 47.6% of statements
ok  	github.com/ManuGH/xg2g/internal/control/http/v3/recordings	1.033s	coverage: 47.6% of statements
=== RUN   TestArtifactResolver_ResolveSegment
=== RUN   TestArtifactResolver_ResolveSegment/Segment_Traversal_Blocked
=== RUN   TestArtifactResolver_ResolveSegment/Forbidden_Segment_Type
--- PASS: TestArtifactResolver_ResolveSegment (0.00s)
    --- PASS: TestArtifactResolver_ResolveSegment/Segment_Traversal_Blocked (0.00s)
    --- PASS: TestArtifactResolver_ResolveSegment/Forbidden_Segment_Type (0.00s)
PASS
coverage: 6.2% of statements
ok  	github.com/ManuGH/xg2g/internal/control/http/v3/recordings/artifacts	1.033s	coverage: 6.2% of statements
=== RUN   TestVODPlaybackResponse_Contract
--- PASS: TestVODPlaybackResponse_Contract (0.00s)
PASS
coverage: 0.0% of statements
ok  	github.com/ManuGH/xg2g/internal/control/http/v3/types	(cached)	coverage: 0.0% of statements
=== RUN   TestCORS_WildcardReflectsOrigin
--- PASS: TestCORS_WildcardReflectsOrigin (0.00s)
=== RUN   TestCORS_CredentialsToggle
--- PASS: TestCORS_CredentialsToggle (0.00s)
=== RUN   TestCORS_SpecificOrigin
--- PASS: TestCORS_SpecificOrigin (0.00s)
=== RUN   TestCSRFProtection_AllowsSafeMethodsWithoutOrigin
--- PASS: TestCSRFProtection_AllowsSafeMethodsWithoutOrigin (0.00s)
=== RUN   TestCSRFProtection_BlocksUnsafeMethodsWithoutOrigin
--- PASS: TestCSRFProtection_BlocksUnsafeMethodsWithoutOrigin (0.00s)
=== RUN   TestCSRFProtection_AllowsSameOriginNoProxy
--- PASS: TestCSRFProtection_AllowsSameOriginNoProxy (0.00s)
=== RUN   TestCSRFProtection_BlocksProxyHeadersWhenAllowlistEmpty
--- PASS: TestCSRFProtection_BlocksProxyHeadersWhenAllowlistEmpty (0.00s)
=== RUN   TestCSRFProtection_AllowsAllowedOriginEvenWithProxies
--- PASS: TestCSRFProtection_AllowsAllowedOriginEvenWithProxies (0.00s)
=== RUN   TestCSRFProtection_AllowsWildcardOriginEvenWithProxies
--- PASS: TestCSRFProtection_AllowsWildcardOriginEvenWithProxies (0.00s)
=== RUN   TestCSRFProtection_ProblemResponse
--- PASS: TestCSRFProtection_ProblemResponse (0.00s)
=== RUN   TestObservability_ProblemResponseMatchesHeaderTruth
--- PASS: TestObservability_ProblemResponseMatchesHeaderTruth (0.00s)
=== RUN   TestObservability_GeneratedIDMatchesBody
--- PASS: TestObservability_GeneratedIDMatchesBody (0.00s)
=== RUN   TestShouldTrace
=== PAUSE TestShouldTrace
=== RUN   TestSpanNameFormatter
=== PAUSE TestSpanNameFormatter
=== RUN   TestExtractAndAddSpanAttributes
--- PASS: TestExtractAndAddSpanAttributes (0.00s)
=== RUN   TestRateLimit_EnforcesLimit
--- PASS: TestRateLimit_EnforcesLimit (0.00s)
=== RUN   TestRateLimit_DifferentIPsIndependent
--- PASS: TestRateLimit_DifferentIPsIndependent (0.00s)
=== RUN   TestRefreshRateLimit_Configuration
--- PASS: TestRefreshRateLimit_Configuration (0.00s)
=== RUN   TestAPIRateLimit_Configuration
--- PASS: TestAPIRateLimit_Configuration (0.00s)
=== RUN   TestRateLimit_WhitelistCIDR
--- PASS: TestRateLimit_WhitelistCIDR (0.00s)
=== RUN   TestSecurityHeaders_ProxyAwareness
--- PASS: TestSecurityHeaders_ProxyAwareness (0.00s)
=== RUN   TestStack_EnforcesCSRF
--- PASS: TestStack_EnforcesCSRF (0.00s)
=== RUN   TestStack_AllowsSameOrigin
--- PASS: TestStack_AllowsSameOrigin (0.00s)
=== RUN   TestTracing_Success
--- PASS: TestTracing_Success (0.00s)
=== RUN   TestTracing_Error
--- PASS: TestTracing_Error (0.00s)
=== RUN   TestTracing_ClientError
--- PASS: TestTracing_ClientError (0.00s)
=== RUN   TestTracing_WithUserAgent
--- PASS: TestTracing_WithUserAgent (0.00s)
=== RUN   TestTracing_MultipleRequests
--- PASS: TestTracing_MultipleRequests (0.00s)
=== RUN   TestTracing_PreservesResponseWriterInterfaces
--- PASS: TestTracing_PreservesResponseWriterInterfaces (0.00s)
=== CONT  TestShouldTrace
--- PASS: TestShouldTrace (0.00s)
=== CONT  TestSpanNameFormatter
--- PASS: TestSpanNameFormatter (0.00s)
PASS
coverage: 60.7% of statements
ok  	github.com/ManuGH/xg2g/internal/control/middleware	1.033s	coverage: 60.7% of statements
=== RUN   TestPlaybackInfo_G1_Unauthorized_FailsClosed
--- PASS: TestPlaybackInfo_G1_Unauthorized_FailsClosed (0.00s)
=== RUN   TestPlaybackInfo_G2_NotFound_Terminal
--- PASS: TestPlaybackInfo_G2_NotFound_Terminal (0.00s)
=== RUN   TestPlaybackInfo_G3_Preparing_ReturnsPreparing
--- PASS: TestPlaybackInfo_G3_Preparing_ReturnsPreparing (0.00s)
=== RUN   TestPlaybackInfo_G4_DirectPlay_H264_AAC_MP4
--- PASS: TestPlaybackInfo_G4_DirectPlay_H264_AAC_MP4 (0.00s)
=== RUN   TestPlaybackInfo_G5_DirectPlay_SafariNative_HLS
--- PASS: TestPlaybackInfo_G5_DirectPlay_SafariNative_HLS (0.00s)
=== RUN   TestPlaybackInfo_G6_DirectStream_RemuxOnly
--- PASS: TestPlaybackInfo_G6_DirectStream_RemuxOnly (0.00s)
=== RUN   TestPlaybackInfo_G7_Transcode_VideoIncompatible_MPEG2
--- PASS: TestPlaybackInfo_G7_Transcode_VideoIncompatible_MPEG2 (0.00s)
=== RUN   TestPlaybackInfo_G8_Transcode_AudioOnly_AC3
--- PASS: TestPlaybackInfo_G8_Transcode_AudioOnly_AC3 (0.00s)
=== RUN   TestPlaybackInfo_G9_UnknownCodecTruth_FailsClosed
--- PASS: TestPlaybackInfo_G9_UnknownCodecTruth_FailsClosed (0.00s)
=== RUN   TestPlaybackInfo_G10_RepeatedCalls_StableDecision
--- PASS: TestPlaybackInfo_G10_RepeatedCalls_StableDecision (0.00s)
PASS
coverage: 92.7% of statements
ok  	github.com/ManuGH/xg2g/internal/control/playback	(cached)	coverage: 92.7% of statements
=== RUN   TestExtractServiceRef
=== RUN   TestExtractServiceRef/Test_18:_Query_Ref_Wins
=== RUN   TestExtractServiceRef/Test_19:_Path_Fallback
=== RUN   TestExtractServiceRef/Test_20:_Unparseable_URL_Fallback
=== RUN   TestExtractServiceRef/Test_21:_Empty_Returns_Fallback
=== RUN   TestExtractServiceRef/Test_22:_Trims_Trailing_Colon
=== RUN   TestExtractServiceRef/Complex_Query_Precedence
=== RUN   TestExtractServiceRef/Simple_Filename
=== RUN   TestExtractServiceRef/Enigma_Opaque_Ref
--- PASS: TestExtractServiceRef (0.00s)
    --- PASS: TestExtractServiceRef/Test_18:_Query_Ref_Wins (0.00s)
    --- PASS: TestExtractServiceRef/Test_19:_Path_Fallback (0.00s)
    --- PASS: TestExtractServiceRef/Test_20:_Unparseable_URL_Fallback (0.00s)
    --- PASS: TestExtractServiceRef/Test_21:_Empty_Returns_Fallback (0.00s)
    --- PASS: TestExtractServiceRef/Test_22:_Trims_Trailing_Colon (0.00s)
    --- PASS: TestExtractServiceRef/Complex_Query_Precedence (0.00s)
    --- PASS: TestExtractServiceRef/Simple_Filename (0.00s)
    --- PASS: TestExtractServiceRef/Enigma_Opaque_Ref (0.00s)
=== RUN   TestGetStreams_Provider_StateStrictness
--- PASS: TestGetStreams_Provider_StateStrictness (0.00s)
=== RUN   TestGetStreams_Provider_InvalidPlaylistPath
--- PASS: TestGetStreams_Provider_InvalidPlaylistPath (0.00s)
=== RUN   TestGetStreams_Provider_NameResolution
--- PASS: TestGetStreams_Provider_NameResolution (0.00s)
=== RUN   TestGetStreams_Provider_PlaylistOptimization_Test29
--- PASS: TestGetStreams_Provider_PlaylistOptimization_Test29 (0.00s)
=== RUN   TestGetStreams_Provider_ThinClientAudit_Test28
--- PASS: TestGetStreams_Provider_ThinClientAudit_Test28 (0.00s)
=== RUN   TestTimerID
=== RUN   TestTimerID/Simple_Valid
=== RUN   TestTimerID/Complex_ServiceRef
=== RUN   TestTimerID/Invalid_Time_Order
--- PASS: TestTimerID (0.00s)
    --- PASS: TestTimerID/Simple_Valid (0.00s)
    --- PASS: TestTimerID/Complex_ServiceRef (0.00s)
    --- PASS: TestTimerID/Invalid_Time_Order (0.00s)
=== RUN   TestParseTimerID_InvalidInputs
--- PASS: TestParseTimerID_InvalidInputs (0.00s)
=== RUN   TestMapOpenWebIFTimerState_TruthTable
=== RUN   TestMapOpenWebIFTimerState_TruthTable/disabled_wins_even_if_in_progress
=== RUN   TestMapOpenWebIFTimerState_TruthTable/in_progress_maps_to_recording
=== RUN   TestMapOpenWebIFTimerState_TruthTable/future_maps_to_scheduled
=== RUN   TestMapOpenWebIFTimerState_TruthTable/past_unknown_raw_maps_to_unknown
=== RUN   TestMapOpenWebIFTimerState_TruthTable/missing_times_fail_closed_to_unknown
=== RUN   TestMapOpenWebIFTimerState_TruthTable/end_before_begin_still_future_maps_to_scheduled
--- PASS: TestMapOpenWebIFTimerState_TruthTable (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_TruthTable/disabled_wins_even_if_in_progress (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_TruthTable/in_progress_maps_to_recording (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_TruthTable/future_maps_to_scheduled (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_TruthTable/past_unknown_raw_maps_to_unknown (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_TruthTable/missing_times_fail_closed_to_unknown (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_TruthTable/end_before_begin_still_future_maps_to_scheduled (0.00s)
=== RUN   TestMapOpenWebIFTimerState_KnownRawStates_AreHonoredForPast
=== RUN   TestMapOpenWebIFTimerState_KnownRawStates_AreHonoredForPast/completed
=== RUN   TestMapOpenWebIFTimerState_KnownRawStates_AreHonoredForPast/failed
=== RUN   TestMapOpenWebIFTimerState_KnownRawStates_AreHonoredForPast/canceled
--- PASS: TestMapOpenWebIFTimerState_KnownRawStates_AreHonoredForPast (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_KnownRawStates_AreHonoredForPast/completed (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_KnownRawStates_AreHonoredForPast/failed (0.00s)
    --- PASS: TestMapOpenWebIFTimerState_KnownRawStates_AreHonoredForPast/canceled (0.00s)
=== RUN   TestMapOpenWebIFTimerToDTO_SetsTimerIDAndState
--- PASS: TestMapOpenWebIFTimerToDTO_SetsTimerIDAndState (0.00s)
PASS
coverage: 29.1% of statements
ok  	github.com/ManuGH/xg2g/internal/control/read	1.043s	coverage: 29.1% of statements
=== RUN   TestDurationTruth_Read_StoreWins
--- PASS: TestDurationTruth_Read_StoreWins (0.00s)
=== RUN   TestDurationTruth_Read_ProbeFallback
--- PASS: TestDurationTruth_Read_ProbeFallback (0.00s)
=== RUN   TestDurationTruth_Read_Unknown
--- PASS: TestDurationTruth_Read_Unknown (0.00s)
=== RUN   TestDurationTruth_Read_BuildingGate
--- PASS: TestDurationTruth_Read_BuildingGate (0.00s)
=== RUN   TestDurationTruth_Read_ParseErrorMetrics
--- PASS: TestDurationTruth_Read_ParseErrorMetrics (0.00s)
=== RUN   TestClassify_PlaybackErrors
=== RUN   TestClassify_PlaybackErrors/Playback_ErrUpstream_->_ClassUpstream
=== RUN   TestClassify_PlaybackErrors/Playback_ErrNotFound_->_ClassNotFound
=== RUN   TestClassify_PlaybackErrors/Playback_ErrPreparing_->_ClassPreparing
=== RUN   TestClassify_PlaybackErrors/Playback_ErrForbidden_->_ClassForbidden
=== RUN   TestClassify_PlaybackErrors/Local_ErrValidation_(via_InvalidArgument)
=== RUN   TestClassify_PlaybackErrors/Unknown_error_->_ClassInternal
=== RUN   TestClassify_PlaybackErrors/Nil_error_->_empty
--- PASS: TestClassify_PlaybackErrors (0.00s)
    --- PASS: TestClassify_PlaybackErrors/Playback_ErrUpstream_->_ClassUpstream (0.00s)
    --- PASS: TestClassify_PlaybackErrors/Playback_ErrNotFound_->_ClassNotFound (0.00s)
    --- PASS: TestClassify_PlaybackErrors/Playback_ErrPreparing_->_ClassPreparing (0.00s)
    --- PASS: TestClassify_PlaybackErrors/Playback_ErrForbidden_->_ClassForbidden (0.00s)
    --- PASS: TestClassify_PlaybackErrors/Local_ErrValidation_(via_InvalidArgument) (0.00s)
    --- PASS: TestClassify_PlaybackErrors/Unknown_error_->_ClassInternal (0.00s)
    --- PASS: TestClassify_PlaybackErrors/Nil_error_->_empty (0.00s)
=== RUN   TestGateA_NoForbiddenImports
--- PASS: TestGateA_NoForbiddenImports (0.08s)
=== RUN   TestSingleflightKeyGate
--- PASS: TestSingleflightKeyGate (0.00s)
=== RUN   TestService_List_Success
--- PASS: TestService_List_Success (0.00s)
=== RUN   TestService_ResolvePlayback_Success
--- PASS: TestService_ResolvePlayback_Success (0.00s)
=== RUN   TestService_GetStatus_Ready
--- PASS: TestService_GetStatus_Ready (0.00s)
=== RUN   TestService_Stream_NotReady_TriggersProbe
--- PASS: TestService_Stream_NotReady_TriggersProbe (0.00s)
=== RUN   TestService_Delete_Success
--- PASS: TestService_Delete_Success (0.00s)
=== RUN   TestResolvePlayback_TruthPropagation
--- PASS: TestResolvePlayback_TruthPropagation (0.00s)
=== RUN   TestService_ClassifyFilePresence_Regression
=== RUN   TestService_ClassifyFilePresence_Regression/Case_A:_Filesize_Missing_(Nil)_->_Failure_Mode
=== RUN   TestService_ClassifyFilePresence_Regression/Case_B:_Filesize_Valid_(1.35GB)_->_Success_Mode
=== RUN   TestService_ClassifyFilePresence_Regression/Case_C:_Filesize_0_->_Small
=== RUN   TestService_ClassifyFilePresence_Regression/Case_D:_Filesize_Numerical_Valid
--- PASS: TestService_ClassifyFilePresence_Regression (0.00s)
    --- PASS: TestService_ClassifyFilePresence_Regression/Case_A:_Filesize_Missing_(Nil)_->_Failure_Mode (0.00s)
    --- PASS: TestService_ClassifyFilePresence_Regression/Case_B:_Filesize_Valid_(1.35GB)_->_Success_Mode (0.00s)
    --- PASS: TestService_ClassifyFilePresence_Regression/Case_C:_Filesize_0_->_Small (0.00s)
    --- PASS: TestService_ClassifyFilePresence_Regression/Case_D:_Filesize_Numerical_Valid (0.00s)
=== RUN   TestStatus_EndToEnd_Regression
--- PASS: TestStatus_EndToEnd_Regression (0.00s)
=== RUN   TestPR42_SourceResolutionAndKeyHygiene
=== RUN   TestPR42_SourceResolutionAndKeyHygiene/Receiver_URL_escaping_uses_RawPath_correctly
=== RUN   TestPR42_SourceResolutionAndKeyHygiene/Local_mapping_uses_extracted_path
=== RUN   TestPR42_SourceResolutionAndKeyHygiene/Local_mapping_escapes_spaces_in_file_URL
=== RUN   TestPR42_SourceResolutionAndKeyHygiene/Singleflight_key_is_hashed
--- PASS: TestPR42_SourceResolutionAndKeyHygiene (0.00s)
    --- PASS: TestPR42_SourceResolutionAndKeyHygiene/Receiver_URL_escaping_uses_RawPath_correctly (0.00s)
    --- PASS: TestPR42_SourceResolutionAndKeyHygiene/Local_mapping_uses_extracted_path (0.00s)
    --- PASS: TestPR42_SourceResolutionAndKeyHygiene/Local_mapping_escapes_spaces_in_file_URL (0.00s)
    --- PASS: TestPR42_SourceResolutionAndKeyHygiene/Singleflight_key_is_hashed (0.00s)
=== RUN   TestTruthProvider_ImpossibleProbe_FailsFast
=== RUN   TestTruthProvider_ImpossibleProbe_FailsFast/Impossible:_No_Local_Path_+_No_Probe_Configured
{"level":"info","sref":"ref","kind":"receiver","source":"http://test:0/ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestTruthProvider_ImpossibleProbe_FailsFast/Impossible:_No_Local_Path_+_Remote_Probe_Unsupported
{"level":"info","sref":"ref","kind":"receiver","source":"http://test:0/ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestTruthProvider_ImpossibleProbe_FailsFast/Possible:_Local_Path_Exists
{"level":"info","sref":"ref","kind":"receiver","source":"http://test:0/ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"warn","error":"local probe mock not impl","source":"http://test:0/ref","time":"2026-02-01T14:53:00+01:00","message":"async probe failed"}
--- PASS: TestTruthProvider_ImpossibleProbe_FailsFast (0.00s)
    --- PASS: TestTruthProvider_ImpossibleProbe_FailsFast/Impossible:_No_Local_Path_+_No_Probe_Configured (0.00s)
    --- PASS: TestTruthProvider_ImpossibleProbe_FailsFast/Impossible:_No_Local_Path_+_Remote_Probe_Unsupported (0.00s)
    --- PASS: TestTruthProvider_ImpossibleProbe_FailsFast/Possible:_Local_Path_Exists (0.00s)
=== RUN   TestTruthProvider_ProbeFailure_PersistsState
{"level":"info","sref":"ref","kind":"receiver","source":"//:0/ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"warn","error":"probe failed permanently","source":"//:0/ref","time":"2026-02-01T14:53:00+01:00","message":"async probe failed"}
{"level":"info","sref":"ref","kind":"receiver","source":"//:0/ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
--- PASS: TestTruthProvider_ProbeFailure_PersistsState (0.11s)
=== RUN   TestDurationTruth_Read_StoreWins
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
--- PASS: TestDurationTruth_Read_StoreWins (0.00s)
=== RUN   TestDurationTruth_Read_ProbeFallback
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
--- PASS: TestDurationTruth_Read_ProbeFallback (0.00s)
=== RUN   TestMediaTruth
=== RUN   TestMediaTruth/Hit_Store_+_Meta_Codecs_Complete
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestMediaTruth/Hit_Metadata_(Cache)
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestMediaTruth/Heal:_Store_Hit_+_Codec_Miss
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestMediaTruth/Heal:_Store_Hit_+_Partial_Codec_->_Heal
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestMediaTruth/Heal_Fail:_Timeout_->_ErrPreparing
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"warn","error":"probe: media corrupt or invalid","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"async probe failed"}
=== RUN   TestMediaTruth/Heal_Fail:_Corrupt_->_ErrUpstream
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"warn","error":"probe: media corrupt or invalid","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"async probe failed"}
=== RUN   TestMediaTruth/Probe_Fail_(No_Defaults)
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"warn","error":"probe failed","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"async probe failed"}
=== RUN   TestMediaTruth/Remote_Probe_Unsupported_(No_Codecs)
{"level":"info","sref":"1:0:0:0:0:0:0:0:0:0:/local/x","kind":"receiver","source":"//:0/1:0:0:0:0:0:0:0:0:0:/local/x","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestMediaTruth/Remote_Probe_Failure_(Upstream)
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestMediaTruth/Store_Get_Error_(No_Overwrite)
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
=== RUN   TestMediaTruth/Invariant:_Ready_Meta_!=_Artifact
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
--- PASS: TestMediaTruth (0.00s)
    --- PASS: TestMediaTruth/Hit_Store_+_Meta_Codecs_Complete (0.00s)
    --- PASS: TestMediaTruth/Hit_Metadata_(Cache) (0.00s)
    --- PASS: TestMediaTruth/Heal:_Store_Hit_+_Codec_Miss (0.00s)
    --- PASS: TestMediaTruth/Heal:_Store_Hit_+_Partial_Codec_->_Heal (0.00s)
    --- PASS: TestMediaTruth/Heal_Fail:_Timeout_->_ErrPreparing (0.00s)
    --- PASS: TestMediaTruth/Heal_Fail:_Corrupt_->_ErrUpstream (0.00s)
    --- PASS: TestMediaTruth/Probe_Fail_(No_Defaults) (0.00s)
    --- PASS: TestMediaTruth/Remote_Probe_Unsupported_(No_Codecs) (0.00s)
    --- PASS: TestMediaTruth/Remote_Probe_Failure_(Upstream) (0.00s)
    --- PASS: TestMediaTruth/Store_Get_Error_(No_Overwrite) (0.00s)
    --- PASS: TestMediaTruth/Invariant:_Ready_Meta_!=_Artifact (0.00s)
=== RUN   TestAsyncProbe_NoHiddenWork
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
--- PASS: TestAsyncProbe_NoHiddenWork (0.00s)
=== RUN   TestAsyncProbe_Singleflight
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
{"level":"info","sref":"service:ref","kind":"receiver","source":"//:0/service:ref","time":"2026-02-01T14:53:00+01:00","message":"GetMediaTruth: source resolved"}
--- PASS: TestAsyncProbe_Singleflight (0.01s)
PASS
coverage: 61.0% of statements
ok  	github.com/ManuGH/xg2g/internal/control/recordings	1.256s	coverage: 61.0% of statements
=== RUN   TestAPIVersionAllowlist
--- PASS: TestAPIVersionAllowlist (0.00s)
=== RUN   TestCapabilitiesVersionStrict
--- PASS: TestCapabilitiesVersionStrict (0.00s)
=== RUN   TestReasonPriorityPolicyOverCapability
--- PASS: TestReasonPriorityPolicyOverCapability (0.00s)
=== RUN   TestTranscodeRequiresHLSSupport
--- PASS: TestTranscodeRequiresHLSSupport (0.00s)
=== RUN   TestDecodeDecisionInput_FailClosed_UnknownRootKey
--- PASS: TestDecodeDecisionInput_FailClosed_UnknownRootKey (0.00s)
=== RUN   TestDecodeDecisionInput_RootObjectsAreObjects
=== RUN   TestDecodeDecisionInput_RootObjectsAreObjects/caps_is_string
=== RUN   TestDecodeDecisionInput_RootObjectsAreObjects/caps_is_number
=== RUN   TestDecodeDecisionInput_RootObjectsAreObjects/policy_is_null
=== RUN   TestDecodeDecisionInput_RootObjectsAreObjects/policy_is_array
--- PASS: TestDecodeDecisionInput_RootObjectsAreObjects (0.00s)
    --- PASS: TestDecodeDecisionInput_RootObjectsAreObjects/caps_is_string (0.00s)
    --- PASS: TestDecodeDecisionInput_RootObjectsAreObjects/caps_is_number (0.00s)
    --- PASS: TestDecodeDecisionInput_RootObjectsAreObjects/policy_is_null (0.00s)
    --- PASS: TestDecodeDecisionInput_RootObjectsAreObjects/policy_is_array (0.00s)
=== RUN   TestGetSchemaType
=== RUN   TestGetSchemaType/compact_schema
=== RUN   TestGetSchemaType/legacy_schema
=== RUN   TestGetSchemaType/mixed_schema
=== RUN   TestGetSchemaType/unknown_keys
=== RUN   TestGetSchemaType/malformed
=== RUN   TestGetSchemaType/empty
--- PASS: TestGetSchemaType (0.00s)
    --- PASS: TestGetSchemaType/compact_schema (0.00s)
    --- PASS: TestGetSchemaType/legacy_schema (0.00s)
    --- PASS: TestGetSchemaType/mixed_schema (0.00s)
    --- PASS: TestGetSchemaType/unknown_keys (0.00s)
    --- PASS: TestGetSchemaType/malformed (0.00s)
    --- PASS: TestGetSchemaType/empty (0.00s)
=== RUN   TestIsJSONObject
=== RUN   TestIsJSONObject/object
=== RUN   TestIsJSONObject/object_with_whitespace
=== RUN   TestIsJSONObject/array
=== RUN   TestIsJSONObject/string
=== RUN   TestIsJSONObject/number
=== RUN   TestIsJSONObject/null
=== RUN   TestIsJSONObject/boolean
=== RUN   TestIsJSONObject/empty
--- PASS: TestIsJSONObject (0.00s)
    --- PASS: TestIsJSONObject/object (0.00s)
    --- PASS: TestIsJSONObject/object_with_whitespace (0.00s)
    --- PASS: TestIsJSONObject/array (0.00s)
    --- PASS: TestIsJSONObject/string (0.00s)
    --- PASS: TestIsJSONObject/number (0.00s)
    --- PASS: TestIsJSONObject/null (0.00s)
    --- PASS: TestIsJSONObject/boolean (0.00s)
    --- PASS: TestIsJSONObject/empty (0.00s)
=== RUN   TestGate_DecisionInput_Drift
--- PASS: TestGate_DecisionInput_Drift (0.00s)
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003
=== RUN   TestNormalizeInput_NilToEmpty_INV_NORM_004
=== PAUSE TestNormalizeInput_NilToEmpty_INV_NORM_004
=== RUN   TestNormalizeInput_NilSupportsRange_INV_NORM_005
=== PAUSE TestNormalizeInput_NilSupportsRange_INV_NORM_005
=== RUN   TestNormalizeInput_RequestIDPreserved_INV_NORM_006
=== PAUSE TestNormalizeInput_RequestIDPreserved_INV_NORM_006
=== RUN   TestValidateOutputInvariants_Negative
=== RUN   TestValidateOutputInvariants_Negative/Invariant_#9:_DirectPlay_with_Wrong_Kind
=== RUN   TestValidateOutputInvariants_Negative/Invariant_#9:_DirectPlay_with_Missing_Range_Support
=== RUN   TestValidateOutputInvariants_Negative/Invariant_#9:_DirectPlay_with_Bad_Container
=== RUN   TestValidateOutputInvariants_Negative/Invariant_#10:_Transcode_with_Wrong_Kind
=== RUN   TestValidateOutputInvariants_Negative/Invariant_#11:_Deny_with_Output_URL
=== RUN   TestValidateOutputInvariants_Negative/Invariant_#11:_Deny_with_Non-Empty_Kind
=== RUN   TestValidateOutputInvariants_Negative/Invariant_#11:_Deny_with_Outputs_List
--- PASS: TestValidateOutputInvariants_Negative (0.00s)
    --- PASS: TestValidateOutputInvariants_Negative/Invariant_#9:_DirectPlay_with_Wrong_Kind (0.00s)
    --- PASS: TestValidateOutputInvariants_Negative/Invariant_#9:_DirectPlay_with_Missing_Range_Support (0.00s)
    --- PASS: TestValidateOutputInvariants_Negative/Invariant_#9:_DirectPlay_with_Bad_Container (0.00s)
    --- PASS: TestValidateOutputInvariants_Negative/Invariant_#10:_Transcode_with_Wrong_Kind (0.00s)
    --- PASS: TestValidateOutputInvariants_Negative/Invariant_#11:_Deny_with_Output_URL (0.00s)
    --- PASS: TestValidateOutputInvariants_Negative/Invariant_#11:_Deny_with_Non-Empty_Kind (0.00s)
    --- PASS: TestValidateOutputInvariants_Negative/Invariant_#11:_Deny_with_Outputs_List (0.00s)
=== RUN   TestProp_FailClosed_InvalidSchema
--- PASS: TestProp_FailClosed_InvalidSchema (0.00s)
=== RUN   TestProp_FailClosed_IncompatibleButValid
--- PASS: TestProp_FailClosed_IncompatibleButValid (0.00s)
=== RUN   TestProp_Determinism
--- PASS: TestProp_Determinism (0.13s)
=== RUN   TestProp_Monotonicity_AllowTranscode
--- PASS: TestProp_Monotonicity_AllowTranscode (0.02s)
=== RUN   TestProp_Monotonicity_DenyTranscodePolicy
--- PASS: TestProp_Monotonicity_DenyTranscodePolicy (0.01s)
=== RUN   TestProp_ContainerMismatch_BlocksOnlyDirectPlay
--- PASS: TestProp_ContainerMismatch_BlocksOnlyDirectPlay (0.01s)
=== RUN   TestProp_ContainerMismatch_DoesNotForceTranscode
--- PASS: TestProp_ContainerMismatch_DoesNotForceTranscode (0.01s)
=== RUN   TestProp_Normalization_DirectPlay
--- PASS: TestProp_Normalization_DirectPlay (0.00s)
=== RUN   TestProp_Canonicalization_NoDuplicateDrift
--- PASS: TestProp_Canonicalization_NoDuplicateDrift (0.00s)
=== RUN   TestProp_SemanticEquivalence_NilEmptySlices
--- PASS: TestProp_SemanticEquivalence_NilEmptySlices (0.00s)
=== RUN   TestProp_NormalizedEquivalence_Strict
--- PASS: TestProp_NormalizedEquivalence_Strict (0.02s)
=== RUN   TestProp_PermutationInvariance
--- PASS: TestProp_PermutationInvariance (0.01s)
=== RUN   TestProp_NormalizeIdempotence
--- PASS: TestProp_NormalizeIdempotence (0.00s)
=== RUN   TestProp_MissingFields_Always400
--- PASS: TestProp_MissingFields_Always400 (0.00s)
=== RUN   TestProp_EmptyObject_Always400
--- PASS: TestProp_EmptyObject_Always400 (0.00s)
=== RUN   TestProp_SmallAPIVersionMatch
--- PASS: TestProp_SmallAPIVersionMatch (0.00s)
=== RUN   TestProp_EmptyBody_Always400
--- PASS: TestProp_EmptyBody_Always400 (0.00s)
=== RUN   TestProp_SchemaLess_Always400
--- PASS: TestProp_SchemaLess_Always400 (0.00s)
=== RUN   TestProp_UnknownRootKey_Always400
--- PASS: TestProp_UnknownRootKey_Always400 (0.00s)
=== RUN   TestProp_SourceMustBeObject_Compact
--- PASS: TestProp_SourceMustBeObject_Compact (0.00s)
=== RUN   TestProp_CapsMustBeObject_Compact
--- PASS: TestProp_CapsMustBeObject_Compact (0.00s)
=== RUN   TestProp_PolicyMustBeObject_Legacy
--- PASS: TestProp_PolicyMustBeObject_Legacy (0.00s)
=== RUN   TestProp_SourceNull_Always400
--- PASS: TestProp_SourceNull_Always400 (0.00s)
=== RUN   TestProp_SourceArray_Always400
--- PASS: TestProp_SourceArray_Always400 (0.00s)
=== RUN   TestProp_CapsNull_Always400
--- PASS: TestProp_CapsNull_Always400 (0.00s)
=== RUN   TestProp_APIMissing_Always400
--- PASS: TestProp_APIMissing_Always400 (0.00s)
=== RUN   TestProp_UnrecognizedValues_NeverDenyIfTranscodeAllowed
--- PASS: TestProp_UnrecognizedValues_NeverDenyIfTranscodeAllowed (0.00s)
=== RUN   TestProp_DualDecode_Compatibility
--- PASS: TestProp_DualDecode_Compatibility (0.00s)
=== RUN   TestProp_UnicodeWhitespace_Equivalence
--- PASS: TestProp_UnicodeWhitespace_Equivalence (0.01s)
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/source_vs_Source
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/caps_vs_Capabilities
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/policy_vs_Policy
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/api_vs_APIVersion
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/rid_vs_RequestID
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/Nested_source_mix
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/Nested_caps_mix
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/Symmetric_inner_(comp_in_legacy_src)
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/Symmetric_inner_(comp_in_legacy_cap)
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/Symmetric_inner_(comp_in_legacy_pol)
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/Cross-Mix_Source+Caps
=== RUN   TestProp_NoMixedSchemaAmbiguity_Exhaustive/Cross-Mix_source+Capabilities
--- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/source_vs_Source (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/caps_vs_Capabilities (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/policy_vs_Policy (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/api_vs_APIVersion (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/rid_vs_RequestID (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/Nested_source_mix (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/Nested_caps_mix (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/Symmetric_inner_(comp_in_legacy_src) (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/Symmetric_inner_(comp_in_legacy_cap) (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/Symmetric_inner_(comp_in_legacy_pol) (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/Cross-Mix_Source+Caps (0.00s)
    --- PASS: TestProp_NoMixedSchemaAmbiguity_Exhaustive/Cross-Mix_source+Capabilities (0.00s)
=== RUN   TestProp_FPSAllowed_Compact
--- PASS: TestProp_FPSAllowed_Compact (0.00s)
=== RUN   TestProp_FPSAllowed_Legacy
--- PASS: TestProp_FPSAllowed_Legacy (0.00s)
=== RUN   TestProp_FPSDoesNotBypassMixedDetection
--- PASS: TestProp_FPSDoesNotBypassMixedDetection (0.00s)
=== RUN   TestKeyRules_Guardrail_NoIdenticalPairs
--- PASS: TestKeyRules_Guardrail_NoIdenticalPairs (0.00s)
=== RUN   TestProp_PresenceAwareMerge_ZeroValues
--- PASS: TestProp_PresenceAwareMerge_ZeroValues (0.00s)
=== RUN   TestProp_OptionalPolicy_DefaultStability
--- PASS: TestProp_OptionalPolicy_DefaultStability (0.00s)
=== RUN   TestProp_Explainability_NoEmptyReasonsOnDeny
--- PASS: TestProp_Explainability_NoEmptyReasonsOnDeny (0.00s)
=== RUN   TestProp_Explainability_NoEmptyReasonsOnTranscode
--- PASS: TestProp_Explainability_NoEmptyReasonsOnTranscode (0.00s)
=== RUN   TestProp_ReplayArtifact_ReproducesDecision
--- PASS: TestProp_ReplayArtifact_ReproducesDecision (0.01s)
=== RUN   TestModelConsistency
--- PASS: TestModelConsistency (0.14s)
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002
=== CONT  TestNormalizeInput_NilSupportsRange_INV_NORM_005
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/empty_input
--- PASS: TestNormalizeInput_NilSupportsRange_INV_NORM_005 (0.00s)
=== CONT  TestNormalizeInput_RequestIDPreserved_INV_NORM_006
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003
--- PASS: TestNormalizeInput_RequestIDPreserved_INV_NORM_006 (0.00s)
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/whitespace_variants_container
=== CONT  TestNormalizeInput_NilToEmpty_INV_NORM_004
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/whitespace_variants_container
--- PASS: TestNormalizeInput_NilToEmpty_INV_NORM_004 (0.00s)
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/nbsp_edge_trim
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/empty_input
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/empty_input
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/nbsp_edge_trim
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/basic_normalized
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_space_edge_trim
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/empty_input
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/basic_normalized
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/basic_normalized
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/mixed_case_strings
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/basic_normalized
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_space_edge_trim
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/mixed_case_strings
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/whitespace_heavy
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/whitespace_heavy
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/unicode_invisible_chars
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/unicode_invisible_chars
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/mixed_case_strings
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_non_joiner_edge_trim
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/nil_slices
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/nil_slices
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/mixed_case_strings
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_non_joiner_edge_trim
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_joiner_edge_trim
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/empty_slices
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/empty_slices
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/whitespace_heavy
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_joiner_edge_trim
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/duplicate_values_in_slices
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/whitespace_heavy
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/bom_edge_trim
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/bom_edge_trim
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/duplicate_values_in_slices
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/unicode_invisible_chars
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/unicode_invisible_chars
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/case_folding_mixed
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/unsorted_slices
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/nil_slices
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/case_folding_mixed
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/unsorted_slices
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/empty_strings_in_slices
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/empty_strings_in_slices
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/supports_range_true
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/nil_slices
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/tabs_and_newlines
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/supports_range_true
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/supports_range_false
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/supports_range_false
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/empty_slices
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/empty_slices
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/tabs_and_newlines
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/slice_order_independence
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/supports_range_nil
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/duplicate_values_in_slices
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/duplicate_values_in_slices
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/slice_order_independence
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/supports_range_nil
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/all_fields_populated
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/all_fields_populated
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/unsorted_slices
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/unsorted_slices
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/empty_strings_in_slices
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/empty_strings_in_slices
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_true
=== RUN   TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/slice_deduplication
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_true
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_false
=== RUN   TestNormalizeInput_Determinism_INV_NORM_002/api_version_whitespace
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_false
=== PAUSE TestNormalizeInput_Determinism_INV_NORM_002/api_version_whitespace
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_nil
=== PAUSE TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/slice_deduplication
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_nil
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/nbsp_edge_trim
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/empty_input
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/slice_deduplication
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/slice_order_independence
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_space_edge_trim
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/all_fields_populated
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/all_fields_populated
=== RUN   TestNormalizeInput_Idempotence_INV_NORM_001/api_version_whitespace
=== PAUSE TestNormalizeInput_Idempotence_INV_NORM_001/api_version_whitespace
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/whitespace_variants_container
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/case_folding_mixed
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/empty_strings_in_slices
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/tabs_and_newlines
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/supports_range_nil
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/supports_range_false
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_joiner_edge_trim
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/bom_edge_trim
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/api_version_whitespace
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/unsorted_slices
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/unicode_invisible_chars
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/duplicate_values_in_slices
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/nil_slices
=== CONT  TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_non_joiner_edge_trim
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/empty_slices
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/empty_input
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/whitespace_heavy
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_nil
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/unicode_invisible_chars
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/duplicate_values_in_slices
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/unsorted_slices
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/nil_slices
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/mixed_case_strings
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/whitespace_heavy
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/empty_slices
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/all_fields_populated
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_false
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/api_version_whitespace
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/basic_normalized
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_true
=== CONT  TestNormalizeInput_Idempotence_INV_NORM_001/empty_strings_in_slices
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/supports_range_true
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/all_fields_populated
--- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003 (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/nbsp_edge_trim (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/slice_deduplication (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/slice_order_independence (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_space_edge_trim (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/whitespace_variants_container (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/case_folding_mixed (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/tabs_and_newlines (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_joiner_edge_trim (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/bom_edge_trim (0.00s)
    --- PASS: TestNormalizeInput_EdgeTrimCaseFold_INV_NORM_003/zero_width_non_joiner_edge_trim (0.00s)
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/mixed_case_strings
--- PASS: TestNormalizeInput_Idempotence_INV_NORM_001 (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/empty_input (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_nil (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/unicode_invisible_chars (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/duplicate_values_in_slices (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/unsorted_slices (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/nil_slices (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/mixed_case_strings (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/whitespace_heavy (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/empty_slices (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/all_fields_populated (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_false (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/api_version_whitespace (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/basic_normalized (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/supports_range_true (0.00s)
    --- PASS: TestNormalizeInput_Idempotence_INV_NORM_001/empty_strings_in_slices (0.00s)
=== CONT  TestNormalizeInput_Determinism_INV_NORM_002/basic_normalized
--- PASS: TestNormalizeInput_Determinism_INV_NORM_002 (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/empty_input (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/supports_range_nil (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/empty_strings_in_slices (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/api_version_whitespace (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/unicode_invisible_chars (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/supports_range_false (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/nil_slices (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/unsorted_slices (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/duplicate_values_in_slices (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/empty_slices (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/supports_range_true (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/whitespace_heavy (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/mixed_case_strings (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/basic_normalized (0.00s)
    --- PASS: TestNormalizeInput_Determinism_INV_NORM_002/all_fields_populated (0.00s)
PASS
coverage: 87.5% of statements
ok  	github.com/ManuGH/xg2g/internal/control/recordings/decision	1.428s	coverage: 87.5% of statements
# github.com/ManuGH/xg2g/internal/fsutil
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/infra/bus
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/infra/ffmpeg
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/infra/media/stub
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/infra/platform
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/library
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/netutil
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/pipeline/exec
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/pipeline/hardware
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/pipeline/lease
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/internal/testutil
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# github.com/ManuGH/xg2g/test/helpers
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
=== RUN   TestVOD_Cleanup_OnStall
{"level":"debug","jobId":"test-stall","input":"","time":"2026-02-01T14:53:00+01:00","message":"VOD build monitor started"}
{"level":"debug","jobId":"test-stall","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: entering select loop"}
{"level":"debug","jobId":"test-stall","reason":"STALL","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifyFailure called"}
{"level":"debug","jobId":"test-stall","hasCallback":false,"time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifyFailure executing"}
--- PASS: TestVOD_Cleanup_OnStall (0.01s)
=== RUN   TestVOD_Cleanup_OnCrash
{"level":"debug","jobId":"test-crash","input":"","time":"2026-02-01T14:53:00+01:00","message":"VOD build monitor started"}
{"level":"debug","jobId":"test-crash","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: entering select loop"}
{"level":"debug","jobId":"test-crash","error":"ffmpeg crashed","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: process exited, examining error"}
{"level":"error","error":"ffmpeg crashed","jobId":"test-crash","diagnostics":["mock=true"],"time":"2026-02-01T14:53:00+01:00","message":"VOD build process failed"}
{"level":"debug","jobId":"test-crash","reason":"CRASH","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifyFailure called"}
{"level":"debug","jobId":"test-crash","hasCallback":false,"time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifyFailure executing"}
--- PASS: TestVOD_Cleanup_OnCrash (0.00s)
=== RUN   TestVOD_Cleanup_OnStartFail
{"level":"error","error":"start failed","jobId":"test-startfail","time":"2026-02-01T14:53:00+01:00","message":"VOD build runner failed to start"}
{"level":"debug","jobId":"test-startfail","reason":"START_FAIL","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifyFailure called"}
{"level":"debug","jobId":"test-startfail","hasCallback":false,"time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifyFailure executing"}
--- PASS: TestVOD_Cleanup_OnStartFail (0.00s)
=== RUN   TestVOD_AtomicPublish_Success
{"level":"debug","jobId":"test-success","input":"","time":"2026-02-01T14:53:00+01:00","message":"VOD build monitor started"}
{"level":"debug","jobId":"test-success","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: entering select loop"}
{"level":"debug","jobId":"test-success","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: progress event received"}
{"level":"debug","jobId":"test-success","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: process exited, examining error"}
{"level":"info","jobId":"test-success","time":"2026-02-01T14:53:00+01:00","message":"VOD build process completed successfully"}
{"level":"debug","jobId":"test-success","finalPath":"/recordings/final.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: finalPath set, attempting publish"}
{"level":"info","jobId":"test-success","finalPath":"/recordings/final.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD build published successfully"}
{"level":"debug","jobId":"test-success","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: about to call setState(StateSucceeded)"}
{"level":"debug","jobId":"test-success","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: about to call notifySuccess()"}
{"level":"debug","jobId":"test-success","finalPath":"/recordings/final.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifySuccess called"}
{"level":"debug","jobId":"test-success","hasCallback":false,"time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifySuccess executing"}
{"level":"debug","jobId":"test-success","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifySuccess() returned, exiting Run()"}
--- PASS: TestVOD_AtomicPublish_Success (0.00s)
=== RUN   TestVOD_AtomicPublish_Failure_NoFinal
{"level":"debug","jobId":"test-failure","input":"","time":"2026-02-01T14:53:00+01:00","message":"VOD build monitor started"}
{"level":"debug","jobId":"test-failure","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: entering select loop"}
{"level":"debug","jobId":"test-failure","error":"crash during build","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: process exited, examining error"}
{"level":"error","error":"crash during build","jobId":"test-failure","diagnostics":["mock=true"],"time":"2026-02-01T14:53:00+01:00","message":"VOD build process failed"}
{"level":"debug","jobId":"test-failure","reason":"CRASH","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifyFailure called"}
{"level":"debug","jobId":"test-failure","hasCallback":false,"time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifyFailure executing"}
--- PASS: TestVOD_AtomicPublish_Failure_NoFinal (0.00s)
=== RUN   TestCallbackExecution
=== RUN   TestCallbackExecution/success_callback_updates_metadata_to_READY
{"level":"debug","jobId":"test-recording-id","input":"/fake/input.ts","time":"2026-02-01T14:53:00+01:00","message":"VOD build monitor started"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: entering select loop"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: progress event received"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: progress event received"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: process exited, examining error"}
{"level":"info","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD build process completed successfully"}
{"level":"debug","jobId":"test-recording-id","finalPath":"/tmp/test-vod-callback/index.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: finalPath set, attempting publish"}
{"level":"info","jobId":"test-recording-id","finalPath":"/tmp/test-vod-callback/index.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD build published successfully"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: about to call setState(StateSucceeded)"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: about to call notifySuccess()"}
{"level":"debug","jobId":"test-recording-id","finalPath":"/tmp/test-vod-callback/index.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifySuccess called"}
{"level":"debug","jobId":"test-recording-id","hasCallback":true,"time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifySuccess executing"}
{"level":"debug","jobId":"test-recording-id","metaId":"test-recording-id","finalPath":"/tmp/test-vod-callback/index.m3u8","time":"2026-02-01T14:53:00+01:00","message":"VOD manager: markReadyFromBuild called"}
{"level":"info","jobId":"test-recording-id","metaId":"test-recording-id","oldState":"","newState":"READY","playlistPath":"/tmp/test-vod-callback/index.m3u8","stateGen":1,"time":"2026-02-01T14:53:00+01:00","message":"VOD manager: metadata updated"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD manager: job removed from jobs map"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: success callback completed"}
{"level":"debug","jobId":"test-recording-id","time":"2026-02-01T14:53:00+01:00","message":"VOD monitor: notifySuccess() returned, exiting Run()"}
    manager_callback_test.go:73: SUCCESS: Callback executed, metadata updated to READY, job cleaned up
=== RUN   TestCallbackExecution/failure_callback_updates_metadata_to_FAILED
{"level":"debug","jobId":"test-recording-fail","input":"/fake/input-fail.ts","time":"2026-02-01T14:53:01+01:00","message":"VOD build monitor started"}
{"level":"debug","jobId":"test-recording-fail","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: entering select loop"}
{"level":"debug","jobId":"test-recording-fail","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: progress event received"}
{"level":"debug","jobId":"test-recording-fail","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: progress event received"}
{"level":"debug","jobId":"test-recording-fail","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: progress event received"}
{"level":"debug","jobId":"test-recording-fail","error":"process exited with code 1","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: process exited, examining error"}
{"level":"error","error":"process exited with code 1","jobId":"test-recording-fail","diagnostics":["fake process failed"],"time":"2026-02-01T14:53:01+01:00","message":"VOD build process failed"}
{"level":"debug","jobId":"test-recording-fail","reason":"CRASH","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: notifyFailure called"}
{"level":"debug","jobId":"test-recording-fail","hasCallback":true,"time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: notifyFailure executing"}
{"level":"debug","jobId":"test-recording-fail","metaId":"test-recording-fail","reason":"CRASH","time":"2026-02-01T14:53:01+01:00","message":"VOD manager: markFailedFromBuild called"}
{"level":"info","jobId":"test-recording-fail","metaId":"test-recording-fail","oldState":"","newState":"FAILED","error":"CRASH","stateGen":1,"time":"2026-02-01T14:53:01+01:00","message":"VOD manager: metadata updated to FAILED"}
{"level":"debug","jobId":"test-recording-fail","time":"2026-02-01T14:53:01+01:00","message":"VOD manager: job removed from jobs map"}
{"level":"debug","jobId":"test-recording-fail","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: failure callback completed"}
    manager_callback_test.go:128: SUCCESS: Failure callback executed, metadata updated to FAILED, job cleaned up
--- PASS: TestCallbackExecution (0.40s)
    --- PASS: TestCallbackExecution/success_callback_updates_metadata_to_READY (0.20s)
    --- PASS: TestCallbackExecution/failure_callback_updates_metadata_to_FAILED (0.20s)
=== RUN   TestExitErrorString
--- PASS: TestExitErrorString (0.00s)
=== RUN   TestManager_MarkProbed_PreservesFields
--- PASS: TestManager_MarkProbed_PreservesFields (0.00s)
=== RUN   TestManager_MarkFailure_PreservesFields
--- PASS: TestManager_MarkFailure_PreservesFields (0.00s)
=== RUN   TestManager_PruneMetadata_TTLAndLimit
--- PASS: TestManager_PruneMetadata_TTLAndLimit (0.00s)
=== RUN   TestManager_PruneMetadata_MaxEntries
--- PASS: TestManager_PruneMetadata_MaxEntries (0.00s)
=== RUN   TestManager_PruneMetadata_Concurrent
--- PASS: TestManager_PruneMetadata_Concurrent (0.01s)
=== RUN   TestStateGenGuard_Deterministic
--- PASS: TestStateGenGuard_Deterministic (0.00s)
=== RUN   TestTouchHelper
--- PASS: TestTouchHelper (0.00s)
=== RUN   TestUpdatedAtGovernance
--- PASS: TestUpdatedAtGovernance (0.00s)
=== RUN   TestManager_MarkFailed_PreservesFields
--- PASS: TestManager_MarkFailed_PreservesFields (0.00s)
=== RUN   TestManager_MarkFailed_InitializeUnknown
--- PASS: TestManager_MarkFailed_InitializeUnknown (0.00s)
=== RUN   TestMockRunner_StartFailure
--- PASS: TestMockRunner_StartFailure (0.00s)
=== RUN   TestMockRunner_Success
--- PASS: TestMockRunner_Success (0.00s)
=== RUN   TestMockRunner_Crash
--- PASS: TestMockRunner_Crash (0.00s)
=== RUN   TestMockRunner_StopUnblocksWait
--- PASS: TestMockRunner_StopUnblocksWait (0.01s)
=== RUN   TestBuildMonitor_BuildingRequiresRunnerArtifacts
{"level":"debug","jobId":"contract-job","input":"","time":"2026-02-01T14:53:01+01:00","message":"VOD build monitor started"}
{"level":"debug","jobId":"contract-job","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: entering select loop"}
{"level":"debug","jobId":"contract-job","reason":"CANCELED","time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: notifyFailure called"}
{"level":"debug","jobId":"contract-job","hasCallback":false,"time":"2026-02-01T14:53:01+01:00","message":"VOD monitor: notifyFailure executing"}
--- PASS: TestBuildMonitor_BuildingRequiresRunnerArtifacts (0.03s)
=== RUN   TestBuildMonitor_ContractViolationFails
{"level":"error","error":"runner contract violation: output temp missing","jobId":"contract-fail","time":"2026-02-01T14:53:11+01:00","message":"VOD build runner contract violation"}
{"level":"debug","jobId":"contract-fail","reason":"RUNNER_CONTRACT","time":"2026-02-01T14:53:11+01:00","message":"VOD monitor: notifyFailure called"}
{"level":"debug","jobId":"contract-fail","hasCallback":false,"time":"2026-02-01T14:53:11+01:00","message":"VOD monitor: notifyFailure executing"}
--- PASS: TestBuildMonitor_ContractViolationFails (10.00s)
=== RUN   TestVOD_Heartbeat
{"level":"debug","jobId":"test-job","input":"","time":"2026-02-01T14:53:11+01:00","message":"VOD build monitor started"}
{"level":"debug","jobId":"test-job","time":"2026-02-01T14:53:11+01:00","message":"VOD monitor: entering select loop"}
{"level":"debug","jobId":"test-job","time":"2026-02-01T14:53:11+01:00","message":"VOD monitor: progress event received"}
{"level":"debug","jobId":"test-job","reason":"STALL","time":"2026-02-01T14:53:11+01:00","message":"VOD monitor: notifyFailure called"}
{"level":"debug","jobId":"test-job","hasCallback":false,"time":"2026-02-01T14:53:11+01:00","message":"VOD monitor: notifyFailure executing"}
--- PASS: TestVOD_Heartbeat (0.01s)
=== RUN   TestDecideProfile_HEVC
--- PASS: TestDecideProfile_HEVC (0.00s)
=== RUN   TestDecideProfile_H264_10bit
--- PASS: TestDecideProfile_H264_10bit (0.00s)
=== RUN   TestDecideProfile_H264_8bit_AAC
--- PASS: TestDecideProfile_H264_8bit_AAC (0.00s)
=== RUN   TestDecideProfile_MPEG2
--- PASS: TestDecideProfile_MPEG2 (0.00s)
=== RUN   TestRunProbe_UsesResolvedPathFromMetadata
{"level":"info","id":"1:0:0:0:0:0:0:0:0:/media/test.ts","path":"/tmp/probe-meta-3502265253.ts","time":"2026-02-01T14:53:11+01:00","message":"probing recording duration"}
{"level":"debug","id":"1:0:0:0:0:0:0:0:0:/media/test.ts","duration":60,"time":"2026-02-01T14:53:11+01:00","message":"recording probe complete"}
--- PASS: TestRunProbe_UsesResolvedPathFromMetadata (0.00s)
=== RUN   TestRunProbe_UsesPathMapperWhenInputEmpty
{"level":"info","id":"1:0:0:0:0:0:0:0:0:/media/test.ts","path":"/tmp/probe-map-1626761250.ts","time":"2026-02-01T14:53:11+01:00","message":"probing recording duration"}
{"level":"debug","id":"1:0:0:0:0:0:0:0:0:/media/test.ts","duration":60,"time":"2026-02-01T14:53:11+01:00","message":"recording probe complete"}
--- PASS: TestRunProbe_UsesPathMapperWhenInputEmpty (0.00s)
=== RUN   TestRunProbe_EmptyInputFailsWithoutResolver
{"level":"warn","id":"1:0:0:0:0:0:0:0:0:/media/test.ts","time":"2026-02-01T14:53:11+01:00","message":"probe failed: missing input path"}
--- PASS: TestRunProbe_EmptyInputFailsWithoutResolver (0.00s)
=== RUN   TestTruth_Write_B1_Success
{"level":"info","id":"test:ref","path":"/tmp/test3474301184.mp4","time":"2026-02-01T14:53:11+01:00","message":"probing recording duration"}
{"level":"debug","id":"test:ref","duration":61,"time":"2026-02-01T14:53:11+01:00","message":"recording probe complete"}
--- PASS: TestTruth_Write_B1_Success (0.00s)
=== RUN   TestTruth_Write_B2_ZeroDuration_Guard
{"level":"info","id":"test:ref","path":"/tmp/test3988146798.mp4","time":"2026-02-01T14:53:11+01:00","message":"probing recording duration"}
{"level":"warn","id":"test:ref","duration":0,"time":"2026-02-01T14:53:11+01:00","message":"probe returned invalid duration"}
--- PASS: TestTruth_Write_B2_ZeroDuration_Guard (0.00s)
=== RUN   TestTruth_Write_B3_Timeout_Mapping
{"level":"info","id":"test:ref","path":"/tmp/test2093347338.mp4","time":"2026-02-01T14:53:11+01:00","message":"probing recording duration"}
{"level":"warn","error":"context deadline exceeded","id":"test:ref","time":"2026-02-01T14:53:11+01:00","message":"probe failed"}
--- PASS: TestTruth_Write_B3_Timeout_Mapping (0.00s)
=== RUN   TestTruth_Write_B4_Corrupt
{"level":"info","id":"test:ref","path":"/tmp/test1412196512.mp4","time":"2026-02-01T14:53:11+01:00","message":"probing recording duration"}
{"level":"warn","error":"corrupt file","id":"test:ref","time":"2026-02-01T14:53:11+01:00","message":"probe failed"}
--- PASS: TestTruth_Write_B4_Corrupt (0.00s)
=== RUN   TestTruth_Write_B5_ProbeFailPreservesDuration
{"level":"info","id":"test:ref:b5","path":"/tmp/test1365488983.mp4","time":"2026-02-01T14:53:11+01:00","message":"probing recording duration"}
{"level":"warn","error":"network unreachable","id":"test:ref:b5","time":"2026-02-01T14:53:11+01:00","message":"probe failed"}
--- PASS: TestTruth_Write_B5_ProbeFailPreservesDuration (0.00s)
=== RUN   TestTruth_Write_B6_MarkProbedClearsArtifactPathForNonMP4
--- PASS: TestTruth_Write_B6_MarkProbedClearsArtifactPathForNonMP4 (0.00s)
=== RUN   TestTruth_Write_B7_MarkProbedSetsPlaylistPathForM3U8
--- PASS: TestTruth_Write_B7_MarkProbedSetsPlaylistPathForM3U8 (0.00s)
=== RUN   TestTruth_Write_B8_MarkProbedDoesNotDegradeVideoFields
--- PASS: TestTruth_Write_B8_MarkProbedDoesNotDegradeVideoFields (0.00s)
=== RUN   TestTruth_Write_B9_CanceledIsFailed
{"level":"info","id":"test:ref:b9","path":"/tmp/test4292959992.mp4","time":"2026-02-01T14:53:11+01:00","message":"probing recording duration"}
{"level":"warn","error":"context canceled","id":"test:ref:b9","time":"2026-02-01T14:53:11+01:00","message":"probe failed"}
--- PASS: TestTruth_Write_B9_CanceledIsFailed (0.00s)
=== RUN   TestEvictRecordingCache_TTL
--- PASS: TestEvictRecordingCache_TTL (0.00s)
=== RUN   TestEvictRecordingCache_MaxEntries
--- PASS: TestEvictRecordingCache_MaxEntries (0.00s)
=== RUN   TestEvictRecordingCache_LongSequence
--- PASS: TestEvictRecordingCache_LongSequence (0.03s)
=== RUN   TestEvictRecordingCache_Concurrent
--- PASS: TestEvictRecordingCache_Concurrent (0.01s)
=== RUN   TestVOD_StateMachine
=== RUN   TestVOD_StateMachine/Idle->Building_on_Start
=== RUN   TestVOD_StateMachine/Building->Finalizing_on_BuildComplete
=== RUN   TestVOD_StateMachine/Building->Failed_on_Fail
=== RUN   TestVOD_StateMachine/Building->Canceled_on_Cancel
=== RUN   TestVOD_StateMachine/Finalizing->Succeeded_on_PublishComplete
=== RUN   TestVOD_StateMachine/Finalizing->Failed_on_Fail
=== RUN   TestVOD_StateMachine/Idle->Finalizing_invalid
=== RUN   TestVOD_StateMachine/Idle->Failed_invalid
=== RUN   TestVOD_StateMachine/Building->Succeeded_invalid
=== RUN   TestVOD_StateMachine/Succeeded->Building_invalid_(terminal)
=== RUN   TestVOD_StateMachine/Failed->Building_invalid_(terminal)
=== RUN   TestVOD_StateMachine/Canceled->Building_invalid_(terminal)
--- PASS: TestVOD_StateMachine (0.00s)
    --- PASS: TestVOD_StateMachine/Idle->Building_on_Start (0.00s)
    --- PASS: TestVOD_StateMachine/Building->Finalizing_on_BuildComplete (0.00s)
    --- PASS: TestVOD_StateMachine/Building->Failed_on_Fail (0.00s)
    --- PASS: TestVOD_StateMachine/Building->Canceled_on_Cancel (0.00s)
    --- PASS: TestVOD_StateMachine/Finalizing->Succeeded_on_PublishComplete (0.00s)
    --- PASS: TestVOD_StateMachine/Finalizing->Failed_on_Fail (0.00s)
    --- PASS: TestVOD_StateMachine/Idle->Finalizing_invalid (0.00s)
    --- PASS: TestVOD_StateMachine/Idle->Failed_invalid (0.00s)
    --- PASS: TestVOD_StateMachine/Building->Succeeded_invalid (0.00s)
    --- PASS: TestVOD_StateMachine/Succeeded->Building_invalid_(terminal) (0.00s)
    --- PASS: TestVOD_StateMachine/Failed->Building_invalid_(terminal) (0.00s)
    --- PASS: TestVOD_StateMachine/Canceled->Building_invalid_(terminal) (0.00s)
=== RUN   TestState_IsTerminal
--- PASS: TestState_IsTerminal (0.00s)
=== RUN   TestState_String
--- PASS: TestState_String (0.00s)
PASS
coverage: 66.1% of statements
ok  	github.com/ManuGH/xg2g/internal/control/vod	11.550s	coverage: 66.1% of statements
=== RUN   TestHTTPPreflightProvider_Unreachable
--- PASS: TestHTTPPreflightProvider_Unreachable (0.00s)
=== RUN   TestHTTPPreflightProvider_Timeout
--- PASS: TestHTTPPreflightProvider_Timeout (0.01s)
=== RUN   TestHTTPPreflightProvider_CanceledContext
--- PASS: TestHTTPPreflightProvider_CanceledContext (0.00s)
=== RUN   TestHTTPPreflightProvider_StatusMapping
=== RUN   TestHTTPPreflightProvider_StatusMapping/ok
=== PAUSE TestHTTPPreflightProvider_StatusMapping/ok
=== RUN   TestHTTPPreflightProvider_StatusMapping/unauthorized
=== PAUSE TestHTTPPreflightProvider_StatusMapping/unauthorized
=== RUN   TestHTTPPreflightProvider_StatusMapping/forbidden
=== PAUSE TestHTTPPreflightProvider_StatusMapping/forbidden
=== RUN   TestHTTPPreflightProvider_StatusMapping/not_found
=== PAUSE TestHTTPPreflightProvider_StatusMapping/not_found
=== RUN   TestHTTPPreflightProvider_StatusMapping/bad_gateway
=== PAUSE TestHTTPPreflightProvider_StatusMapping/bad_gateway
=== CONT  TestHTTPPreflightProvider_StatusMapping/ok
=== CONT  TestHTTPPreflightProvider_StatusMapping/bad_gateway
=== CONT  TestHTTPPreflightProvider_StatusMapping/unauthorized
=== CONT  TestHTTPPreflightProvider_StatusMapping/forbidden
=== CONT  TestHTTPPreflightProvider_StatusMapping/not_found
--- PASS: TestHTTPPreflightProvider_StatusMapping (0.00s)
    --- PASS: TestHTTPPreflightProvider_StatusMapping/forbidden (0.00s)
    --- PASS: TestHTTPPreflightProvider_StatusMapping/unauthorized (0.00s)
    --- PASS: TestHTTPPreflightProvider_StatusMapping/bad_gateway (0.00s)
    --- PASS: TestHTTPPreflightProvider_StatusMapping/not_found (0.00s)
    --- PASS: TestHTTPPreflightProvider_StatusMapping/ok (0.00s)
=== RUN   TestHTTPPreflightProvider_NoRedirect
--- PASS: TestHTTPPreflightProvider_NoRedirect (0.00s)
=== RUN   TestMapPreflightOutcome
--- PASS: TestMapPreflightOutcome (0.00s)
PASS
coverage: 81.2% of statements
ok  	github.com/ManuGH/xg2g/internal/control/vod/preflight	(cached)	coverage: 81.2% of statements
=== RUN   TestNewManager_ValidDeps
--- PASS: TestNewManager_ValidDeps (0.00s)
=== RUN   TestNewManager_MissingLogger
--- PASS: TestNewManager_MissingLogger (0.00s)
=== RUN   TestNewManager_MissingAPIHandler
--- PASS: TestNewManager_MissingAPIHandler (0.00s)
=== RUN   TestManager_StartStop_OK
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","listen":"127.0.0.1:0","read_timeout":1000,"write_timeout":1000,"shutdown_timeout":2000,"time":"2026-02-01T14:53:02+01:00","message":"Starting daemon manager"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","addr":"127.0.0.1:0","time":"2026-02-01T14:53:02+01:00","message":"API server listening (HTTP)"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Shutdown signal received"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Shutting down daemon manager"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Daemon manager stopped cleanly"}
--- PASS: TestManager_StartStop_OK (0.11s)
=== RUN   TestManager_Shutdown_TimesOut
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","listen":"127.0.0.1:0","read_timeout":1000,"write_timeout":1000,"shutdown_timeout":100,"time":"2026-02-01T14:53:02+01:00","message":"Starting daemon manager"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","addr":"127.0.0.1:0","time":"2026-02-01T14:53:02+01:00","message":"API server listening (HTTP)"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Shutdown signal received"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Shutting down daemon manager"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Daemon manager stopped cleanly"}
--- PASS: TestManager_Shutdown_TimesOut (0.10s)
=== RUN   TestManager_Shutdown_NotStarted
--- PASS: TestManager_Shutdown_NotStarted (0.00s)
=== RUN   TestManager_WithMetrics
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","listen":"127.0.0.1:0","read_timeout":1000,"write_timeout":1000,"shutdown_timeout":2000,"time":"2026-02-01T14:53:02+01:00","message":"Starting daemon manager"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","addr":"127.0.0.1:0","time":"2026-02-01T14:53:02+01:00","message":"API server listening (HTTP)"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Shutdown signal received"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Shutting down daemon manager"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Daemon manager stopped cleanly"}
--- PASS: TestManager_WithMetrics (0.20s)
=== RUN   TestManager_PropagatesListenErrors
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","listen":"127.0.0.1:34703","read_timeout":1000,"write_timeout":1000,"shutdown_timeout":1000,"time":"2026-02-01T14:53:02+01:00","message":"Starting daemon manager"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","addr":"127.0.0.1:34703","time":"2026-02-01T14:53:02+01:00","message":"API server listening (HTTP)"}
{"level":"error","service":"xg2g","version":"","component":"test","component":"manager","error":"listen tcp 127.0.0.1:34703: bind: address already in use","event":"api.server.failed","time":"2026-02-01T14:53:02+01:00","message":"API server (HTTP) failed"}
{"level":"error","service":"xg2g","version":"","component":"test","component":"manager","error":"API server (HTTP): listen tcp 127.0.0.1:34703: bind: address already in use","time":"2026-02-01T14:53:02+01:00","message":"Server error, initiating shutdown"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Shutting down daemon manager"}
{"level":"info","service":"xg2g","version":"","component":"test","component":"manager","time":"2026-02-01T14:53:02+01:00","message":"Daemon manager stopped cleanly"}
--- PASS: TestManager_PropagatesListenErrors (0.00s)
PASS
coverage: 27.0% of statements
ok  	github.com/ManuGH/xg2g/internal/daemon	1.444s	coverage: 27.0% of statements
=== RUN   TestDeriveRecordingStatus
=== RUN   TestDeriveRecordingStatus/Filter:_JustPlay_timer_is_ignored_->_Unknown_(no_file)
=== RUN   TestDeriveRecordingStatus/Filter:_Disabled_timer_is_ignored_->_Unknown_(no_file)
=== RUN   TestDeriveRecordingStatus/Recording:_Running=true_(File_Missing)_->_RECORDING
=== RUN   TestDeriveRecordingStatus/Recording:_Running=false_but_File_Present_(Small)_->_RECORDING
=== RUN   TestDeriveRecordingStatus/Recording:_Running=false_but_File_Present_(Partial)_->_RECORDING
=== RUN   TestDeriveRecordingStatus/Recording:_Running=false_and_File_Missing_->_UNKNOWN_(No_explicit_signal)
=== RUN   TestDeriveRecordingStatus/Scheduled:_Timer_in_future_->_SCHEDULED
=== RUN   TestDeriveRecordingStatus/Failed:_Timer_Past_Grace_+_File_Missing_->_FAILED
=== RUN   TestDeriveRecordingStatus/Failed:_Timer_Past_Grace_+_File_Small_->_FAILED
=== RUN   TestDeriveRecordingStatus/Failed:_Timer_Past_Grace_+_File_Partial_->_FAILED
=== RUN   TestDeriveRecordingStatus/Completed:_File_OK_+_No_Timer_->_COMPLETED
=== RUN   TestDeriveRecordingStatus/Completed:_File_OK_+_Past_Timer_(Grace_over)_->_COMPLETED
=== RUN   TestDeriveRecordingStatus/Debris:_Small_File_+_No_Timer_->_FAILED
=== RUN   TestDeriveRecordingStatus/Debris:_Partial_File_+_No_Timer_->_FAILED
=== RUN   TestDeriveRecordingStatus/Unknown:_Nothing_->_UNKNOWN
--- PASS: TestDeriveRecordingStatus (0.00s)
    --- PASS: TestDeriveRecordingStatus/Filter:_JustPlay_timer_is_ignored_->_Unknown_(no_file) (0.00s)
    --- PASS: TestDeriveRecordingStatus/Filter:_Disabled_timer_is_ignored_->_Unknown_(no_file) (0.00s)
    --- PASS: TestDeriveRecordingStatus/Recording:_Running=true_(File_Missing)_->_RECORDING (0.00s)
    --- PASS: TestDeriveRecordingStatus/Recording:_Running=false_but_File_Present_(Small)_->_RECORDING (0.00s)
    --- PASS: TestDeriveRecordingStatus/Recording:_Running=false_but_File_Present_(Partial)_->_RECORDING (0.00s)
    --- PASS: TestDeriveRecordingStatus/Recording:_Running=false_and_File_Missing_->_UNKNOWN_(No_explicit_signal) (0.00s)
    --- PASS: TestDeriveRecordingStatus/Scheduled:_Timer_in_future_->_SCHEDULED (0.00s)
    --- PASS: TestDeriveRecordingStatus/Failed:_Timer_Past_Grace_+_File_Missing_->_FAILED (0.00s)
    --- PASS: TestDeriveRecordingStatus/Failed:_Timer_Past_Grace_+_File_Small_->_FAILED (0.00s)
    --- PASS: TestDeriveRecordingStatus/Failed:_Timer_Past_Grace_+_File_Partial_->_FAILED (0.00s)
    --- PASS: TestDeriveRecordingStatus/Completed:_File_OK_+_No_Timer_->_COMPLETED (0.00s)
    --- PASS: TestDeriveRecordingStatus/Completed:_File_OK_+_Past_Timer_(Grace_over)_->_COMPLETED (0.00s)
    --- PASS: TestDeriveRecordingStatus/Debris:_Small_File_+_No_Timer_->_FAILED (0.00s)
    --- PASS: TestDeriveRecordingStatus/Debris:_Partial_File_+_No_Timer_->_FAILED (0.00s)
    --- PASS: TestDeriveRecordingStatus/Unknown:_Nothing_->_UNKNOWN (0.00s)
PASS
coverage: 100.0% of statements
ok  	github.com/ManuGH/xg2g/internal/domain/recordings/model	(cached)	coverage: 100.0% of statements
=== RUN   TestTerminalOutcome_TruthTable
=== RUN   TestTerminalOutcome_TruthTable/stop_intent_wins_over_cancel
=== RUN   TestTerminalOutcome_TruthTable/stop_intent_wins_over_deadline_exceeded
=== RUN   TestTerminalOutcome_TruthTable/plain_cancel_maps_to_cancelled
=== RUN   TestTerminalOutcome_TruthTable/deadline_exceeded_during_start_maps_to_tune_timeout
=== RUN   TestTerminalOutcome_TruthTable/deadline_exceeded_outside_start_is_distinct
=== RUN   TestTerminalOutcome_TruthTable/vod_completion_returns_draining
--- PASS: TestTerminalOutcome_TruthTable (0.00s)
    --- PASS: TestTerminalOutcome_TruthTable/stop_intent_wins_over_cancel (0.00s)
    --- PASS: TestTerminalOutcome_TruthTable/stop_intent_wins_over_deadline_exceeded (0.00s)
    --- PASS: TestTerminalOutcome_TruthTable/plain_cancel_maps_to_cancelled (0.00s)
    --- PASS: TestTerminalOutcome_TruthTable/deadline_exceeded_during_start_maps_to_tune_timeout (0.00s)
    --- PASS: TestTerminalOutcome_TruthTable/deadline_exceeded_outside_start_is_distinct (0.00s)
    --- PASS: TestTerminalOutcome_TruthTable/vod_completion_returns_draining (0.00s)
=== RUN   TestTerminalOutcome_StopWinsRace
--- PASS: TestTerminalOutcome_StopWinsRace (0.00s)
=== RUN   TestTransitionTable_Coverage
--- PASS: TestTransitionTable_Coverage (0.00s)
=== RUN   FuzzTerminalOutcomeInvariants
=== RUN   FuzzTerminalOutcomeInvariants/seed#0
=== RUN   FuzzTerminalOutcomeInvariants/seed#1
=== RUN   FuzzTerminalOutcomeInvariants/seed#2
--- PASS: FuzzTerminalOutcomeInvariants (0.00s)
    --- PASS: FuzzTerminalOutcomeInvariants/seed#0 (0.00s)
    --- PASS: FuzzTerminalOutcomeInvariants/seed#1 (0.00s)
    --- PASS: FuzzTerminalOutcomeInvariants/seed#2 (0.00s)
PASS
coverage: 10.9% of statements
ok  	github.com/ManuGH/xg2g/internal/domain/session/lifecycle	1.013s	coverage: 10.9% of statements
=== RUN   TestConcurrency_BoundedStart
{"level":"info","service":"xg2g","version":"","cleared_leases":1,"time":"2026-02-01T14:53:02+01:00","message":"startup: flushed stale leases"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","time":"2026-02-01T14:53:02+01:00","message":"starting recovery sweep"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","recovered_count":0,"duration":0.367371,"time":"2026-02-01T14:53:02+01:00","message":"recovery sweep complete"}
{"level":"info","service":"xg2g","version":"","count":0,"time":"2026-02-01T14:53:02+01:00","message":"reconciled tuner metrics from store truth"}
{"level":"info","service":"xg2g","version":"","interval":300000,"time":"2026-02-01T14:53:02+01:00","message":"background sweeper started"}
    concurrency_test.go:96: Max concurrent executions observed: 3 (limit: 3)
--- PASS: TestConcurrency_BoundedStart (0.00s)
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"flood-test-0","session_id":"flood-test-0","profile":"","elapsed_ms":0,"time":"2026-02-01T14:53:02+01:00","message":"playlist ready - transitioning to READY state"}
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"flood-test-0","event":"hls.session_end","sid":"flood-test-0","reason":"R_CANCELLED","profile":"test","time":"2026-02-01T14:53:02+01:00","message":"session ended"}
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"flood-test-2","session_id":"flood-test-2","profile":"","elapsed_ms":0,"time":"2026-02-01T14:53:02+01:00","message":"playlist ready - transitioning to READY state"}
=== RUN   TestConcurrency_ValidationFails
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"flood-test-2","event":"hls.session_end","sid":"flood-test-2","reason":"R_CANCELLED","profile":"test","time":"2026-02-01T14:53:02+01:00","message":"session ended"}
--- PASS: TestConcurrency_ValidationFails (0.00s)
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"flood-test-1","session_id":"flood-test-1","profile":"","elapsed_ms":0,"time":"2026-02-01T14:53:02+01:00","message":"playlist ready - transitioning to READY state"}
=== RUN   TestDeterministicContract_NoSleeps
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"flood-test-1","event":"hls.session_end","sid":"flood-test-1","reason":"R_CANCELLED","profile":"test","time":"2026-02-01T14:53:02+01:00","message":"session ended"}
--- PASS: TestDeterministicContract_NoSleeps (0.03s)
=== RUN   TestRecordSessionStartOutcome_Busy
--- PASS: TestRecordSessionStartOutcome_Busy (0.01s)
=== RUN   TestRecordSessionStartOutcome_Fail
--- PASS: TestRecordSessionStartOutcome_Fail (0.01s)
=== RUN   TestRecordSessionStartOutcome_Success
--- PASS: TestRecordSessionStartOutcome_Success (0.00s)
=== RUN   TestObserveTTF
--- PASS: TestObserveTTF (0.00s)
=== RUN   TestOrchestrator_Observability_TuneFailure
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"sess-obs-1","event":"hls.session_end","sid":"sess-obs-1","reason":"R_TUNE_TIMEOUT","profile":"hd","time":"2026-02-01T14:53:02+01:00","message":"session ended"}
--- PASS: TestOrchestrator_Observability_TuneFailure (0.00s)
=== RUN   TestReconcileTuners_UniqueSlotCount
{"level":"warn","service":"xg2g","version":"","sid":"s2","slot":1,"time":"2026-02-01T14:53:02+01:00","message":"invariant violation: duplicate slot claim detected"}
{"level":"info","service":"xg2g","version":"","count":1,"time":"2026-02-01T14:53:02+01:00","message":"reconciled tuner metrics from store truth"}
--- PASS: TestReconcileTuners_UniqueSlotCount (0.00s)
=== RUN   TestOrchestrator_HandleStart_StubExecution
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"sess-1","event":"hls.session_end","sid":"sess-1","reason":"R_CANCELLED","profile":"hd","time":"2026-02-01T14:53:02+01:00","message":"session ended"}
--- PASS: TestOrchestrator_HandleStart_StubExecution (0.00s)
=== RUN   TestClassifyReason
=== RUN   TestClassifyReason/lease_busy_explicit
=== RUN   TestClassifyReason/detail_sanitized
=== RUN   TestClassifyReason/tune_timeout
=== RUN   TestClassifyReason/tune_failed_upstream
=== RUN   TestClassifyReason/ffmpeg_start_failed
=== RUN   TestClassifyReason/playlist_not_ready
=== RUN   TestClassifyReason/context_canceled
=== RUN   TestClassifyReason/deadline_exceeded
=== RUN   TestClassifyReason/unmapped_error
--- PASS: TestClassifyReason (0.00s)
    --- PASS: TestClassifyReason/lease_busy_explicit (0.00s)
    --- PASS: TestClassifyReason/detail_sanitized (0.00s)
    --- PASS: TestClassifyReason/tune_timeout (0.00s)
    --- PASS: TestClassifyReason/tune_failed_upstream (0.00s)
    --- PASS: TestClassifyReason/ffmpeg_start_failed (0.00s)
    --- PASS: TestClassifyReason/playlist_not_ready (0.00s)
    --- PASS: TestClassifyReason/context_canceled (0.00s)
    --- PASS: TestClassifyReason/deadline_exceeded (0.00s)
    --- PASS: TestClassifyReason/unmapped_error (0.00s)
=== RUN   TestClassifyReason_ProcessExit
--- PASS: TestClassifyReason_ProcessExit (0.00s)
=== RUN   TestReasonError_ErrorIsClass
--- PASS: TestReasonError_ErrorIsClass (0.00s)
=== RUN   TestContention_Blocked
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"session-B","event":"hls.session_end","sid":"session-B","reason":"R_LEASE_BUSY","profile":"p1","detail":"no tuner slots available","time":"2026-02-01T14:53:02+01:00","message":"session ended"}
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"session-A","session_id":"session-A","profile":"","elapsed_ms":0,"time":"2026-02-01T14:53:02+01:00","message":"playlist ready - transitioning to READY state"}
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"session-A","event":"hls.session_end","sid":"session-A","reason":"R_PROCESS_ENDED","profile":"p1","time":"2026-02-01T14:53:02+01:00","message":"session ended"}
--- PASS: TestContention_Blocked (0.00s)
=== RUN   TestRecovery_StaleTunerLease
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","time":"2026-02-01T14:53:02+01:00","message":"starting recovery sweep"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","session_id":"stale-tuner-sess","from_state":"STARTING","to_state":"NEW","time":"2026-02-01T14:53:02+01:00","message":"recovering stale session"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","recovered_count":1,"duration":0.047258,"time":"2026-02-01T14:53:02+01:00","message":"recovery sweep complete"}
--- PASS: TestRecovery_StaleTunerLease (0.00s)
=== RUN   TestRecovery_ActiveTunerLease
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","time":"2026-02-01T14:53:02+01:00","message":"starting recovery sweep"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","recovered_count":0,"duration":0.01109,"time":"2026-02-01T14:53:02+01:00","message":"recovery sweep complete"}
--- PASS: TestRecovery_ActiveTunerLease (0.00s)
=== RUN   TestRecoverySweep_RecoverStale
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","time":"2026-02-01T14:53:02+01:00","message":"starting recovery sweep"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","session_id":"stale-1","from_state":"STARTING","to_state":"NEW","time":"2026-02-01T14:53:02+01:00","message":"recovering stale session"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","recovered_count":1,"duration":3.162103,"time":"2026-02-01T14:53:02+01:00","message":"recovery sweep complete"}
--- PASS: TestRecoverySweep_RecoverStale (0.02s)
=== RUN   TestRecoverySweep_IgnoreActive
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","time":"2026-02-01T14:53:02+01:00","message":"starting recovery sweep"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","recovered_count":0,"duration":0.969418,"time":"2026-02-01T14:53:02+01:00","message":"recovery sweep complete"}
--- PASS: TestRecoverySweep_IgnoreActive (0.01s)
=== RUN   TestRecoverySweep_IgnoreTerminal
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","time":"2026-02-01T14:53:02+01:00","message":"starting recovery sweep"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","recovered_count":0,"duration":0.820801,"time":"2026-02-01T14:53:02+01:00","message":"recovery sweep complete"}
--- PASS: TestRecoverySweep_IgnoreTerminal (0.02s)
=== RUN   TestRecoverySweep_RecoverReady
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","time":"2026-02-01T14:53:02+01:00","message":"starting recovery sweep"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","session_id":"zombie","from_state":"READY","to_state":"FAILED","time":"2026-02-01T14:53:02+01:00","message":"recovering stale session"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","recovered_count":1,"duration":3.02005,"time":"2026-02-01T14:53:02+01:00","message":"recovery sweep complete"}
--- PASS: TestRecoverySweep_RecoverReady (0.02s)
=== RUN   TestStopDuringStart
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"session-stop-start","session_id":"session-stop-start","profile":"","elapsed_ms":0,"time":"2026-02-01T14:53:02+01:00","message":"playlist ready - transitioning to READY state"}
{"level":"info","service":"xg2g","version":"","component":"worker","sid":"session-stop-start","event":"hls.session_end","sid":"session-stop-start","reason":"R_CLIENT_STOP","profile":"p1","time":"2026-02-01T14:53:02+01:00","message":"session ended"}
--- PASS: TestStopDuringStart (0.00s)
=== RUN   TestOrchestrator_Stop_Ready
--- PASS: TestOrchestrator_Stop_Ready (0.00s)
=== RUN   TestOrchestrator_Stop_Starting
--- PASS: TestOrchestrator_Stop_Starting (0.00s)
=== RUN   TestOrchestrator_Stop_Idempotency
--- PASS: TestOrchestrator_Stop_Idempotency (0.00s)
=== RUN   TestSweeper_SweepOnce_PrunesExpiredSessions
{"level":"info","service":"xg2g","version":"","count":1,"time":"2026-02-01T14:53:02+01:00","message":"sweep store removed expired sessions"}
--- PASS: TestSweeper_SweepOnce_PrunesExpiredSessions (0.00s)
=== RUN   TestSweeper_SweepOnce_RemovesFilesForPrunedSession
{"level":"info","service":"xg2g","version":"","count":1,"time":"2026-02-01T14:53:02+01:00","message":"sweep store removed expired sessions"}
--- PASS: TestSweeper_SweepOnce_RemovesFilesForPrunedSession (0.00s)
=== RUN   TestSweeper_SweepOnce_IdleTimeout
--- PASS: TestSweeper_SweepOnce_IdleTimeout (0.00s)
=== RUN   TestSweeper_StoreCleanup
{"level":"info","service":"xg2g","version":"","count":1,"time":"2026-02-01T14:53:02+01:00","message":"sweep store removed expired sessions"}
--- PASS: TestSweeper_StoreCleanup (0.00s)
=== RUN   TestSweeper_FileCleanup
{"level":"info","service":"xg2g","version":"","count":1,"time":"2026-02-01T14:53:02+01:00","message":"sweep files removed orphan directories"}
--- PASS: TestSweeper_FileCleanup (0.00s)
=== RUN   TestSweeper_IdleStop
--- PASS: TestSweeper_IdleStop (0.00s)
=== RUN   TestValidation_MissingConfigFails
=== RUN   TestValidation_MissingConfigFails/missing_StartConcurrency
=== RUN   TestValidation_MissingConfigFails/missing_LeaseTTL
=== RUN   TestValidation_MissingConfigFails/missing_Owner
=== RUN   TestValidation_MissingConfigFails/missing_Sweeper.Interval
{"level":"info","service":"xg2g","version":"","cleared_leases":1,"time":"2026-02-01T14:53:02+01:00","message":"startup: flushed stale leases"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","time":"2026-02-01T14:53:02+01:00","message":"starting recovery sweep"}
{"level":"info","service":"xg2g","version":"","component":"worker.recovery","recovered_count":0,"duration":0.003918,"time":"2026-02-01T14:53:02+01:00","message":"recovery sweep complete"}
{"level":"info","service":"xg2g","version":"","count":0,"time":"2026-02-01T14:53:02+01:00","message":"reconciled tuner metrics from store truth"}
--- PASS: TestValidation_MissingConfigFails (0.00s)
    --- PASS: TestValidation_MissingConfigFails/missing_StartConcurrency (0.00s)
    --- PASS: TestValidation_MissingConfigFails/missing_LeaseTTL (0.00s)
    --- PASS: TestValidation_MissingConfigFails/missing_Owner (0.00s)
    --- PASS: TestValidation_MissingConfigFails/missing_Sweeper.Interval (0.00s)
PASS
coverage: 56.1% of statements
ok  	github.com/ManuGH/xg2g/internal/domain/session/manager	1.160s	coverage: 56.1% of statements
=== RUN   TestDeriveLifecycleState
=== RUN   TestDeriveLifecycleState/Terminal_FAILED_->_error
=== RUN   TestDeriveLifecycleState/Stopping_->_ending
=== RUN   TestDeriveLifecycleState/New_->_starting
=== RUN   TestDeriveLifecycleState/Starting_->_starting
=== RUN   TestDeriveLifecycleState/Priming_->_buffering
=== RUN   TestDeriveLifecycleState/Healthy_running,_playlist_published,_but_no_segments_yet_->_buffering
=== RUN   TestDeriveLifecycleState/Active:_segments_fresh,_access_fresh
=== RUN   TestDeriveLifecycleState/Active_(Grace_Period):_segments_fresh,_access_zero_(newly_published)
=== RUN   TestDeriveLifecycleState/Idle:_segments_fresh,_access_old_(>30s)
=== RUN   TestDeriveLifecycleState/Idle_(Zero_Access_+_Post_Grace):_segments_fresh,_access_zero,_published_old
=== RUN   TestDeriveLifecycleState/Stalled:_segments_seen_but_old_(>12s)
=== RUN   TestDeriveLifecycleState/Stalled_wins_over_Idle
=== RUN   TestDeriveLifecycleState/Ending_wins_over_Stalled
--- PASS: TestDeriveLifecycleState (0.00s)
    --- PASS: TestDeriveLifecycleState/Terminal_FAILED_->_error (0.00s)
    --- PASS: TestDeriveLifecycleState/Stopping_->_ending (0.00s)
    --- PASS: TestDeriveLifecycleState/New_->_starting (0.00s)
    --- PASS: TestDeriveLifecycleState/Starting_->_starting (0.00s)
    --- PASS: TestDeriveLifecycleState/Priming_->_buffering (0.00s)
    --- PASS: TestDeriveLifecycleState/Healthy_running,_playlist_published,_but_no_segments_yet_->_buffering (0.00s)
    --- PASS: TestDeriveLifecycleState/Active:_segments_fresh,_access_fresh (0.00s)
    --- PASS: TestDeriveLifecycleState/Active_(Grace_Period):_segments_fresh,_access_zero_(newly_published) (0.00s)
    --- PASS: TestDeriveLifecycleState/Idle:_segments_fresh,_access_old_(>30s) (0.00s)
    --- PASS: TestDeriveLifecycleState/Idle_(Zero_Access_+_Post_Grace):_segments_fresh,_access_zero,_published_old (0.00s)
    --- PASS: TestDeriveLifecycleState/Stalled:_segments_seen_but_old_(>12s) (0.00s)
    --- PASS: TestDeriveLifecycleState/Stalled_wins_over_Idle (0.00s)
    --- PASS: TestDeriveLifecycleState/Ending_wins_over_Stalled (0.00s)
PASS
coverage: 69.7% of statements
ok  	github.com/ManuGH/xg2g/internal/domain/session/model	1.013s	coverage: 69.7% of statements
=== RUN   TestOpenStateStore_RejectsBoltBadger
=== RUN   TestOpenStateStore_RejectsBoltBadger/bolt
=== RUN   TestOpenStateStore_RejectsBoltBadger/badger
--- PASS: TestOpenStateStore_RejectsBoltBadger (0.00s)
    --- PASS: TestOpenStateStore_RejectsBoltBadger/bolt (0.00s)
    --- PASS: TestOpenStateStore_RejectsBoltBadger/badger (0.00s)
=== RUN   TestOpenStateStore_DefaultsToSqlite
--- PASS: TestOpenStateStore_DefaultsToSqlite (0.01s)
=== RUN   TestOpenStateStore_AllowsMemory
--- PASS: TestOpenStateStore_AllowsMemory (0.00s)
=== RUN   TestOpenStateStore_RejectsUnknown
--- PASS: TestOpenStateStore_RejectsUnknown (0.00s)
=== RUN   TestMemoryStore_ScanSessions_NoLockContention
--- PASS: TestMemoryStore_ScanSessions_NoLockContention (1.04s)
=== RUN   TestMemoryStore_ScanSessions_ContextCancellation
--- PASS: TestMemoryStore_ScanSessions_ContextCancellation (0.00s)
=== RUN   TestMemoryStore_ScanSessions_IsolatedSnapshot
--- PASS: TestMemoryStore_ScanSessions_IsolatedSnapshot (0.00s)
=== RUN   TestInvariant_UpdateSessionPersists
--- PASS: TestInvariant_UpdateSessionPersists (0.03s)
=== RUN   TestSqliteStore_Pragmas
--- PASS: TestSqliteStore_Pragmas (0.01s)
=== RUN   TestSqliteStore_CrashSafeReopen
--- PASS: TestSqliteStore_CrashSafeReopen (0.02s)
=== RUN   TestSqliteStore_Concurrency_WAL
--- PASS: TestSqliteStore_Concurrency_WAL (0.11s)
=== RUN   TestSqliteStore_Idempotency_monotonic
--- PASS: TestSqliteStore_Idempotency_monotonic (0.01s)
=== RUN   TestSqliteStore_Lease_Contention
--- PASS: TestSqliteStore_Lease_Contention (0.26s)
=== RUN   TestSqliteStore_CRUD_Roundtrip_INV_SQLITE_001
=== PAUSE TestSqliteStore_CRUD_Roundtrip_INV_SQLITE_001
=== RUN   TestSqliteStore_ListSessions_DeterministicOrder_INV_SQLITE_002
=== PAUSE TestSqliteStore_ListSessions_DeterministicOrder_INV_SQLITE_002
=== RUN   TestSqliteStore_Transaction_Rollback_INV_SQLITE_003
=== PAUSE TestSqliteStore_Transaction_Rollback_INV_SQLITE_003
=== RUN   TestSqliteStore_Transaction_Commit_Atomic_INV_SQLITE_004
=== PAUSE TestSqliteStore_Transaction_Commit_Atomic_INV_SQLITE_004
=== RUN   TestSqliteStore_SchemaVersion_INV_SQLITE_005
=== PAUSE TestSqliteStore_SchemaVersion_INV_SQLITE_005
=== RUN   TestSqliteStore_SchemaVersion_Preserved_INV_SQLITE_006
=== PAUSE TestSqliteStore_SchemaVersion_Preserved_INV_SQLITE_006
=== RUN   TestSqliteStore_Schema_TablesExist_INV_SQLITE_007
=== PAUSE TestSqliteStore_Schema_TablesExist_INV_SQLITE_007
=== RUN   TestSqliteStore_WAL_ConcurrentReaders_INV_SQLITE_008
=== PAUSE TestSqliteStore_WAL_ConcurrentReaders_INV_SQLITE_008
=== RUN   TestSqliteStore_WAL_ParallelWrites_INV_SQLITE_009
=== PAUSE TestSqliteStore_WAL_ParallelWrites_INV_SQLITE_009
=== RUN   TestSqliteStore_ScanSessions_ContextCancellation_INV_SQLITE_010
=== PAUSE TestSqliteStore_ScanSessions_ContextCancellation_INV_SQLITE_010
=== CONT  TestSqliteStore_CRUD_Roundtrip_INV_SQLITE_001
=== CONT  TestSqliteStore_SchemaVersion_INV_SQLITE_005
=== CONT  TestSqliteStore_ListSessions_DeterministicOrder_INV_SQLITE_002
=== CONT  TestSqliteStore_Transaction_Rollback_INV_SQLITE_003
=== CONT  TestSqliteStore_Schema_TablesExist_INV_SQLITE_007
=== CONT  TestSqliteStore_WAL_ParallelWrites_INV_SQLITE_009
=== CONT  TestSqliteStore_Transaction_Commit_Atomic_INV_SQLITE_004
=== CONT  TestSqliteStore_WAL_ConcurrentReaders_INV_SQLITE_008
--- PASS: TestSqliteStore_Schema_TablesExist_INV_SQLITE_007 (0.04s)
=== CONT  TestSqliteStore_ScanSessions_ContextCancellation_INV_SQLITE_010
=== CONT  TestSqliteStore_SchemaVersion_Preserved_INV_SQLITE_006
--- PASS: TestSqliteStore_SchemaVersion_INV_SQLITE_005 (0.04s)
--- PASS: TestSqliteStore_CRUD_Roundtrip_INV_SQLITE_001 (0.05s)
--- PASS: TestSqliteStore_Transaction_Rollback_INV_SQLITE_003 (0.05s)
--- PASS: TestSqliteStore_Transaction_Commit_Atomic_INV_SQLITE_004 (0.05s)
--- PASS: TestSqliteStore_WAL_ParallelWrites_INV_SQLITE_009 (0.07s)
--- PASS: TestSqliteStore_ListSessions_DeterministicOrder_INV_SQLITE_002 (0.07s)
--- PASS: TestSqliteStore_SchemaVersion_Preserved_INV_SQLITE_006 (0.03s)
--- PASS: TestSqliteStore_ScanSessions_ContextCancellation_INV_SQLITE_010 (0.05s)
--- PASS: TestSqliteStore_WAL_ConcurrentReaders_INV_SQLITE_008 (0.19s)
PASS
coverage: 36.5% of statements
ok  	github.com/ManuGH/xg2g/internal/domain/session/store	2.707s	coverage: 36.5% of statements
=== RUN   TestSeriesEngine_RunOnce
{"level":"info","service":"xg2g","version":"","component":"series_engine","trigger":"manual","rule_id":"700fe80d-ef39-4655-a365-08298533e3f9","time":"2026-02-01T14:53:03+01:00","message":"starting series engine run"}
{"level":"info","service":"xg2g","version":"","component":"series_engine","title":"News at Six","rule":"News","time":"2026-02-01T14:53:03+01:00","message":"scheduling timer"}
{"level":"info","service":"xg2g","version":"","component":"series_engine","trigger":"manual","rule_id":"700fe80d-ef39-4655-a365-08298533e3f9","time":"2026-02-01T14:53:03+01:00","message":"starting series engine run"}
--- PASS: TestSeriesEngine_RunOnce (0.00s)
=== RUN   TestUpdateRule_AllowsLastRunUpdate
--- PASS: TestUpdateRule_AllowsLastRunUpdate (0.00s)
=== RUN   TestUpdateRule_PreservesPartialLastRun
--- PASS: TestUpdateRule_PreservesPartialLastRun (0.00s)
=== RUN   TestUpdateRule_AcceptsZeroSummaryWhenStatusSet
--- PASS: TestUpdateRule_AcceptsZeroSummaryWhenStatusSet (0.00s)
=== RUN   TestScheduler_Loop
{"level":"info","service":"xg2g","version":"","component":"dvr.scheduler","time":"2026-02-01T14:53:03+01:00","message":"Series Scheduler started"}
{"level":"info","service":"xg2g","version":"","component":"series_engine","trigger":"auto","rule_id":"","time":"2026-02-01T14:53:03+01:00","message":"starting series engine run"}
{"level":"info","service":"xg2g","version":"","component":"dvr.scheduler","next_interval":"10m0s","time":"2026-02-01T14:53:03+01:00","message":"Reset scheduler backoff"}
{"level":"info","service":"xg2g","version":"","component":"series_engine","trigger":"auto","rule_id":"","time":"2026-02-01T14:53:03+01:00","message":"starting series engine run"}
{"level":"info","service":"xg2g","version":"","component":"dvr.scheduler","time":"2026-02-01T14:53:03+01:00","message":"Series Scheduler stopping"}
--- PASS: TestScheduler_Loop (0.04s)
PASS
coverage: 52.7% of statements
ok  	github.com/ManuGH/xg2g/internal/dvr	1.059s	coverage: 52.7% of statements
=== RUN   TestXMLTVParsingRoundTrip
=== RUN   TestXMLTVParsingRoundTrip/single_channel_basic
=== RUN   TestXMLTVParsingRoundTrip/multiple_channels_with_icons
=== RUN   TestXMLTVParsingRoundTrip/channel_with_multiple_names
=== RUN   TestXMLTVParsingRoundTrip/special_characters_in_names
=== RUN   TestXMLTVParsingRoundTrip/empty_channel_list
=== RUN   TestXMLTVParsingRoundTrip/channel_with_empty_display_name
--- PASS: TestXMLTVParsingRoundTrip (0.00s)
    --- PASS: TestXMLTVParsingRoundTrip/single_channel_basic (0.00s)
    --- PASS: TestXMLTVParsingRoundTrip/multiple_channels_with_icons (0.00s)
    --- PASS: TestXMLTVParsingRoundTrip/channel_with_multiple_names (0.00s)
    --- PASS: TestXMLTVParsingRoundTrip/special_characters_in_names (0.00s)
    --- PASS: TestXMLTVParsingRoundTrip/empty_channel_list (0.00s)
    --- PASS: TestXMLTVParsingRoundTrip/channel_with_empty_display_name (0.00s)
=== RUN   TestXMLTVErrorCases
=== RUN   TestXMLTVErrorCases/parent_path_is_file
=== RUN   TestXMLTVErrorCases/target_path_is_directory
--- PASS: TestXMLTVErrorCases (0.00s)
    --- PASS: TestXMLTVErrorCases/parent_path_is_file (0.00s)
    --- PASS: TestXMLTVErrorCases/target_path_is_directory (0.00s)
=== RUN   TestChannelIDGeneration
=== RUN   TestChannelIDGeneration/simple_name
=== RUN   TestChannelIDGeneration/name_with_spaces
=== RUN   TestChannelIDGeneration/special_characters
=== RUN   TestChannelIDGeneration/umlauts_and_special
=== RUN   TestChannelIDGeneration/empty_string
=== RUN   TestChannelIDGeneration/only_special_chars
=== RUN   TestChannelIDGeneration/consecutive_separators
--- PASS: TestChannelIDGeneration (0.00s)
    --- PASS: TestChannelIDGeneration/simple_name (0.00s)
    --- PASS: TestChannelIDGeneration/name_with_spaces (0.00s)
    --- PASS: TestChannelIDGeneration/special_characters (0.00s)
    --- PASS: TestChannelIDGeneration/umlauts_and_special (0.00s)
    --- PASS: TestChannelIDGeneration/empty_string (0.00s)
    --- PASS: TestChannelIDGeneration/only_special_chars (0.00s)
    --- PASS: TestChannelIDGeneration/consecutive_separators (0.00s)
=== RUN   TestXMLTVStructValidation
=== RUN   TestXMLTVStructValidation/xml_structure_validity
--- PASS: TestXMLTVStructValidation (0.00s)
    --- PASS: TestXMLTVStructValidation/xml_structure_validity (0.00s)
=== RUN   TestFindBest
=== RUN   TestFindBest/exact_match
=== RUN   TestFindBest/fuzzy_match_distance_1
=== RUN   TestFindBest/fuzzy_match_distance_2
=== RUN   TestFindBest/no_match_exceeds_distance
=== RUN   TestFindBest/empty_input
=== RUN   TestFindBest/case_insensitive_match
=== RUN   TestFindBest/fuzzy_match_max_distance_0
=== RUN   TestFindBest/numeric_channel_match
--- PASS: TestFindBest (0.00s)
    --- PASS: TestFindBest/exact_match (0.00s)
    --- PASS: TestFindBest/fuzzy_match_distance_1 (0.00s)
    --- PASS: TestFindBest/fuzzy_match_distance_2 (0.00s)
    --- PASS: TestFindBest/no_match_exceeds_distance (0.00s)
    --- PASS: TestFindBest/empty_input (0.00s)
    --- PASS: TestFindBest/case_insensitive_match (0.00s)
    --- PASS: TestFindBest/fuzzy_match_max_distance_0 (0.00s)
    --- PASS: TestFindBest/numeric_channel_match (0.00s)
=== RUN   TestLevenshtein
=== RUN   TestLevenshtein/identical_strings
=== RUN   TestLevenshtein/one_insertion
=== RUN   TestLevenshtein/one_deletion
=== RUN   TestLevenshtein/one_substitution
=== RUN   TestLevenshtein/empty_strings
=== RUN   TestLevenshtein/one_empty_string
=== RUN   TestLevenshtein/other_empty_string
=== RUN   TestLevenshtein/completely_different
=== RUN   TestLevenshtein/unicode_characters
=== RUN   TestLevenshtein/long_strings
--- PASS: TestLevenshtein (0.00s)
    --- PASS: TestLevenshtein/identical_strings (0.00s)
    --- PASS: TestLevenshtein/one_insertion (0.00s)
    --- PASS: TestLevenshtein/one_deletion (0.00s)
    --- PASS: TestLevenshtein/one_substitution (0.00s)
    --- PASS: TestLevenshtein/empty_strings (0.00s)
    --- PASS: TestLevenshtein/one_empty_string (0.00s)
    --- PASS: TestLevenshtein/other_empty_string (0.00s)
    --- PASS: TestLevenshtein/completely_different (0.00s)
    --- PASS: TestLevenshtein/unicode_characters (0.00s)
    --- PASS: TestLevenshtein/long_strings (0.00s)
=== RUN   TestNameKey
=== RUN   TestNameKey/lowercase_conversion
=== RUN   TestNameKey/already_lowercase
=== RUN   TestNameKey/mixed_case
=== RUN   TestNameKey/empty_string
=== RUN   TestNameKey/with_numbers
=== RUN   TestNameKey/unicode_characters
--- PASS: TestNameKey (0.00s)
    --- PASS: TestNameKey/lowercase_conversion (0.00s)
    --- PASS: TestNameKey/already_lowercase (0.00s)
    --- PASS: TestNameKey/mixed_case (0.00s)
    --- PASS: TestNameKey/empty_string (0.00s)
    --- PASS: TestNameKey/with_numbers (0.00s)
    --- PASS: TestNameKey/unicode_characters (0.00s)
=== RUN   TestGenerateXMLTV
--- PASS: TestGenerateXMLTV (0.00s)
=== RUN   TestWriteXMLTV
--- PASS: TestWriteXMLTV (0.00s)
=== RUN   TestXMLStructureValidation
--- PASS: TestXMLStructureValidation (0.00s)
=== RUN   TestTitleOmitEmptyLang
--- PASS: TestTitleOmitEmptyLang (0.00s)
=== RUN   TestGoldenXMLTV
--- PASS: TestGoldenXMLTV (0.00s)
=== RUN   TestUmlautsAndUTF8Encoding
--- PASS: TestUmlautsAndUTF8Encoding (0.00s)
=== RUN   TestGoldenFiles
=== RUN   TestGoldenFiles/multi_channel_with_icons
=== RUN   TestGoldenFiles/empty_channels
--- PASS: TestGoldenFiles (0.00s)
    --- PASS: TestGoldenFiles/multi_channel_with_icons (0.00s)
    --- PASS: TestGoldenFiles/empty_channels (0.00s)
=== RUN   TestXMLTVBenchmark
    golden_test.go:131: Generated XMLTV for 1000 channels in 7.64742ms
    golden_test.go:139: Generated file size: 86941 bytes
--- PASS: TestXMLTVBenchmark (0.03s)
=== RUN   TestProgrammesFromEPG
--- PASS: TestProgrammesFromEPG (0.00s)
=== RUN   TestFormatXMLTVTime
--- PASS: TestFormatXMLTVTime (0.00s)
=== RUN   TestBuildDescription
=== RUN   TestBuildDescription/long_desc_different
=== RUN   TestBuildDescription/long_desc_same_as_short
=== RUN   TestBuildDescription/only_short_desc
=== RUN   TestBuildDescription/no_description
--- PASS: TestBuildDescription (0.00s)
    --- PASS: TestBuildDescription/long_desc_different (0.00s)
    --- PASS: TestBuildDescription/long_desc_same_as_short (0.00s)
    --- PASS: TestBuildDescription/only_short_desc (0.00s)
    --- PASS: TestBuildDescription/no_description (0.00s)
=== RUN   TestBuildNameToIDMap_Security
=== RUN   TestBuildNameToIDMap_Security/XXE_Attack
=== RUN   TestBuildNameToIDMap_Security/Malformed_XML
    xmltv_test.go:80: Got error: decode xmltv: xml: encoding "ISO-8859-1" declared but Decoder.CharsetReader is nil
=== RUN   TestBuildNameToIDMap_Security/Billion_Laughs_Attack_(Entity_Expansion)
--- PASS: TestBuildNameToIDMap_Security (0.00s)
    --- PASS: TestBuildNameToIDMap_Security/XXE_Attack (0.00s)
    --- PASS: TestBuildNameToIDMap_Security/Malformed_XML (0.00s)
    --- PASS: TestBuildNameToIDMap_Security/Billion_Laughs_Attack_(Entity_Expansion) (0.00s)
=== RUN   TestBuildNameToIDMap_OversizedInput
    xmltv_test.go:103: Skipping 50MB file generation test
--- SKIP: TestBuildNameToIDMap_OversizedInput (0.00s)
=== RUN   FuzzParseChannelName
=== RUN   FuzzParseChannelName/seed#0
=== RUN   FuzzParseChannelName/seed#1
=== RUN   FuzzParseChannelName/seed#2
=== RUN   FuzzParseChannelName/seed#3
=== RUN   FuzzParseChannelName/seed#4
=== RUN   FuzzParseChannelName/seed#5
=== RUN   FuzzParseChannelName/seed#6
=== RUN   FuzzParseChannelName/seed#7
=== RUN   FuzzParseChannelName/seed#8
=== RUN   FuzzParseChannelName/seed#9
=== RUN   FuzzParseChannelName/seed#10
=== RUN   FuzzParseChannelName/seed#11
--- PASS: FuzzParseChannelName (0.00s)
    --- PASS: FuzzParseChannelName/seed#0 (0.00s)
    --- PASS: FuzzParseChannelName/seed#1 (0.00s)
    --- PASS: FuzzParseChannelName/seed#2 (0.00s)
    --- PASS: FuzzParseChannelName/seed#3 (0.00s)
    --- PASS: FuzzParseChannelName/seed#4 (0.00s)
    --- PASS: FuzzParseChannelName/seed#5 (0.00s)
    --- PASS: FuzzParseChannelName/seed#6 (0.00s)
    --- PASS: FuzzParseChannelName/seed#7 (0.00s)
    --- PASS: FuzzParseChannelName/seed#8 (0.00s)
    --- PASS: FuzzParseChannelName/seed#9 (0.00s)
    --- PASS: FuzzParseChannelName/seed#10 (0.00s)
    --- PASS: FuzzParseChannelName/seed#11 (0.00s)
=== RUN   FuzzXMLTVGeneration
=== RUN   FuzzXMLTVGeneration/seed#0
=== RUN   FuzzXMLTVGeneration/seed#1
=== RUN   FuzzXMLTVGeneration/seed#2
--- PASS: FuzzXMLTVGeneration (0.00s)
    --- PASS: FuzzXMLTVGeneration/seed#0 (0.00s)
    --- PASS: FuzzXMLTVGeneration/seed#1 (0.00s)
    --- PASS: FuzzXMLTVGeneration/seed#2 (0.00s)
=== RUN   FuzzLevenshtein
=== RUN   FuzzLevenshtein/seed#0
=== RUN   FuzzLevenshtein/seed#1
=== RUN   FuzzLevenshtein/seed#2
=== RUN   FuzzLevenshtein/seed#3
--- PASS: FuzzLevenshtein (0.00s)
    --- PASS: FuzzLevenshtein/seed#0 (0.00s)
    --- PASS: FuzzLevenshtein/seed#1 (0.00s)
    --- PASS: FuzzLevenshtein/seed#2 (0.00s)
    --- PASS: FuzzLevenshtein/seed#3 (0.00s)
=== RUN   FuzzBuildNameToIDMap
=== RUN   FuzzBuildNameToIDMap/seed#0
=== RUN   FuzzBuildNameToIDMap/seed#1
=== RUN   FuzzBuildNameToIDMap/seed#2
=== RUN   FuzzBuildNameToIDMap/seed#3
=== RUN   FuzzBuildNameToIDMap/seed#4
=== RUN   FuzzBuildNameToIDMap/seed#5
=== RUN   FuzzBuildNameToIDMap/seed#6
=== RUN   FuzzBuildNameToIDMap/seed#7
--- PASS: FuzzBuildNameToIDMap (0.00s)
    --- PASS: FuzzBuildNameToIDMap/seed#0 (0.00s)
    --- PASS: FuzzBuildNameToIDMap/seed#1 (0.00s)
    --- PASS: FuzzBuildNameToIDMap/seed#2 (0.00s)
    --- PASS: FuzzBuildNameToIDMap/seed#3 (0.00s)
    --- PASS: FuzzBuildNameToIDMap/seed#4 (0.00s)
    --- PASS: FuzzBuildNameToIDMap/seed#5 (0.00s)
    --- PASS: FuzzBuildNameToIDMap/seed#6 (0.00s)
    --- PASS: FuzzBuildNameToIDMap/seed#7 (0.00s)
=== RUN   FuzzNameKey
=== RUN   FuzzNameKey/seed#0
=== RUN   FuzzNameKey/seed#1
=== RUN   FuzzNameKey/seed#2
=== RUN   FuzzNameKey/seed#3
=== RUN   FuzzNameKey/seed#4
=== RUN   FuzzNameKey/seed#5
=== RUN   FuzzNameKey/seed#6
=== RUN   FuzzNameKey/seed#7
--- PASS: FuzzNameKey (0.00s)
    --- PASS: FuzzNameKey/seed#0 (0.00s)
    --- PASS: FuzzNameKey/seed#1 (0.00s)
    --- PASS: FuzzNameKey/seed#2 (0.00s)
    --- PASS: FuzzNameKey/seed#3 (0.00s)
    --- PASS: FuzzNameKey/seed#4 (0.00s)
    --- PASS: FuzzNameKey/seed#5 (0.00s)
    --- PASS: FuzzNameKey/seed#6 (0.00s)
    --- PASS: FuzzNameKey/seed#7 (0.00s)
=== RUN   FuzzNorm
=== RUN   FuzzNorm/seed#0
=== RUN   FuzzNorm/seed#1
=== RUN   FuzzNorm/seed#2
=== RUN   FuzzNorm/seed#3
=== RUN   FuzzNorm/seed#4
=== RUN   FuzzNorm/seed#5
=== RUN   FuzzNorm/seed#6
=== RUN   FuzzNorm/seed#7
=== RUN   FuzzNorm/seed#8
=== RUN   FuzzNorm/seed#9
=== RUN   FuzzNorm/seed#10
=== RUN   FuzzNorm/seed#11
=== RUN   FuzzNorm/seed#12
--- PASS: FuzzNorm (0.00s)
    --- PASS: FuzzNorm/seed#0 (0.00s)
    --- PASS: FuzzNorm/seed#1 (0.00s)
    --- PASS: FuzzNorm/seed#2 (0.00s)
    --- PASS: FuzzNorm/seed#3 (0.00s)
    --- PASS: FuzzNorm/seed#4 (0.00s)
    --- PASS: FuzzNorm/seed#5 (0.00s)
    --- PASS: FuzzNorm/seed#6 (0.00s)
    --- PASS: FuzzNorm/seed#7 (0.00s)
    --- PASS: FuzzNorm/seed#8 (0.00s)
    --- PASS: FuzzNorm/seed#9 (0.00s)
    --- PASS: FuzzNorm/seed#10 (0.00s)
    --- PASS: FuzzNorm/seed#11 (0.00s)
    --- PASS: FuzzNorm/seed#12 (0.00s)
PASS
coverage: 83.6% of statements
ok  	github.com/ManuGH/xg2g/internal/epg	1.077s	coverage: 83.6% of statements
=== RUN   TestNewServer
=== RUN   TestNewServer/default_values
=== RUN   TestNewServer/custom_values
--- PASS: TestNewServer (0.00s)
    --- PASS: TestNewServer/default_values (0.00s)
    --- PASS: TestNewServer/custom_values (0.00s)
=== RUN   TestHandleDiscover
=== RUN   TestHandleDiscover/auto-detect_base_URL
{"level":"info","endpoint":"/discover.json","device_id":"TEST1234","message":"HDHomeRun discovery request"}
=== RUN   TestHandleDiscover/custom_base_URL
{"level":"info","endpoint":"/discover.json","device_id":"TEST1234","message":"HDHomeRun discovery request"}
--- PASS: TestHandleDiscover (0.00s)
    --- PASS: TestHandleDiscover/auto-detect_base_URL (0.00s)
    --- PASS: TestHandleDiscover/custom_base_URL (0.00s)
=== RUN   TestHandleLineupStatus
{"level":"debug","endpoint":"/lineup_status.json","message":"HDHomeRun lineup status request"}
--- PASS: TestHandleLineupStatus (0.00s)
=== RUN   TestHandleLineup
{"level":"debug","endpoint":"/lineup.json","channels":0,"message":"HDHomeRun lineup request"}
--- PASS: TestHandleLineup (0.00s)
=== RUN   TestHandleLineupPost
=== RUN   TestHandleLineupPost/start_scan
{"level":"info","message":"HDHomeRun channel scan started (simulated)"}
=== RUN   TestHandleLineupPost/no_action
--- PASS: TestHandleLineupPost (0.00s)
    --- PASS: TestHandleLineupPost/start_scan (0.00s)
    --- PASS: TestHandleLineupPost/no_action (0.00s)
=== RUN   TestHandleDeviceXML
=== RUN   TestHandleDeviceXML/http_request
{"level":"debug","endpoint":"/device.xml","message":"HDHomeRun device.xml request"}
=== RUN   TestHandleDeviceXML/custom_base_URL
{"level":"debug","endpoint":"/device.xml","message":"HDHomeRun device.xml request"}
--- PASS: TestHandleDeviceXML (0.00s)
    --- PASS: TestHandleDeviceXML/http_request (0.00s)
    --- PASS: TestHandleDeviceXML/custom_base_URL (0.00s)
=== RUN   TestServerGetLocalIP
    hdhr_test.go:307: Local IP detected: 10.10.55.14
--- PASS: TestServerGetLocalIP (0.00s)
=== RUN   TestSSDPIntegration
{"level":"info","interface":"eth0","multicast_addr":"239.255.255.250:49140","message":"joined SSDP multicast group"}
{"level":"info","interface":"br-b747014ef62c","multicast_addr":"239.255.255.250:49140","message":"joined SSDP multicast group"}
{"level":"info","interface":"docker0","multicast_addr":"239.255.255.250:49140","message":"joined SSDP multicast group"}
{"level":"info","interface":"veth6a514b4","multicast_addr":"239.255.255.250:49140","message":"joined SSDP multicast group"}
{"level":"info","multicast_addr":"239.255.255.250:49140","device_id":"SSDP123","message":"SSDP announcer started"}
{"level":"debug","message":"sent SSDP NOTIFY announcement"}
--- PASS: TestSSDPIntegration (0.50s)
PASS
coverage: 65.5% of statements
ok  	github.com/ManuGH/xg2g/internal/hdhr	1.516s	coverage: 65.5% of statements
=== RUN   TestNewManager
--- PASS: TestNewManager (0.00s)
=== RUN   TestManager_Health_NoCheckers
--- PASS: TestManager_Health_NoCheckers (0.00s)
=== RUN   TestManager_Health_WithCheckers
--- PASS: TestManager_Health_WithCheckers (0.00s)
=== RUN   TestManager_Health_Unhealthy
--- PASS: TestManager_Health_Unhealthy (0.00s)
=== RUN   TestManager_Health_Uptime
--- PASS: TestManager_Health_Uptime (1.00s)
=== RUN   TestManager_Ready_NoCheckers
--- PASS: TestManager_Ready_NoCheckers (0.00s)
=== RUN   TestManager_Ready_AllHealthy
--- PASS: TestManager_Ready_AllHealthy (0.00s)
=== RUN   TestManager_Ready_Degraded
--- PASS: TestManager_Ready_Degraded (0.00s)
=== RUN   TestManager_Ready_Unhealthy
--- PASS: TestManager_Ready_Unhealthy (0.00s)
=== RUN   TestManager_Ready_InformationalDoesNotGate
--- PASS: TestManager_Ready_InformationalDoesNotGate (0.00s)
=== RUN   TestManager_ServeHealth
--- PASS: TestManager_ServeHealth (0.00s)
=== RUN   TestManager_ServeHealth_EncodingError
{"level":"error","service":"xg2g","version":"","component":"health","error":"assert.AnError general error for testing","event":"health.encode_error","time":"2026-02-01T14:53:04+01:00","message":"failed to encode health response"}
--- PASS: TestManager_ServeHealth_EncodingError (0.00s)
=== RUN   TestManager_ServeReady
=== RUN   TestManager_ServeReady/healthy
=== RUN   TestManager_ServeReady/degraded
=== RUN   TestManager_ServeReady/unhealthy
--- PASS: TestManager_ServeReady (0.00s)
    --- PASS: TestManager_ServeReady/healthy (0.00s)
    --- PASS: TestManager_ServeReady/degraded (0.00s)
    --- PASS: TestManager_ServeReady/unhealthy (0.00s)
=== RUN   TestManager_ServeReady_EncodingError
{"level":"error","service":"xg2g","version":"","component":"readiness","error":"assert.AnError general error for testing","event":"readiness.encode_error","time":"2026-02-01T14:53:04+01:00","message":"failed to encode readiness response"}
--- PASS: TestManager_ServeReady_EncodingError (0.00s)
=== RUN   TestManager_Ready_StaleOnError
--- PASS: TestManager_Ready_StaleOnError (2.00s)
=== RUN   TestFileChecker_Name
--- PASS: TestFileChecker_Name (0.00s)
=== RUN   TestFileChecker
=== RUN   TestFileChecker/file_exists
=== RUN   TestFileChecker/empty_file
=== RUN   TestFileChecker/file_not_found
=== RUN   TestFileChecker/is_directory
=== RUN   TestFileChecker/not_configured
=== RUN   TestFileChecker/permission_denied_or_other_stat_error
--- PASS: TestFileChecker (0.00s)
    --- PASS: TestFileChecker/file_exists (0.00s)
    --- PASS: TestFileChecker/empty_file (0.00s)
    --- PASS: TestFileChecker/file_not_found (0.00s)
    --- PASS: TestFileChecker/is_directory (0.00s)
    --- PASS: TestFileChecker/not_configured (0.00s)
    --- PASS: TestFileChecker/permission_denied_or_other_stat_error (0.00s)
=== RUN   TestLastRunChecker_Name
--- PASS: TestLastRunChecker_Name (0.00s)
=== RUN   TestLastRunChecker
=== RUN   TestLastRunChecker/no_run_yet
=== RUN   TestLastRunChecker/last_run_failed
=== RUN   TestLastRunChecker/recent_success
=== RUN   TestLastRunChecker/old_success
--- PASS: TestLastRunChecker (0.00s)
    --- PASS: TestLastRunChecker/no_run_yet (0.00s)
    --- PASS: TestLastRunChecker/last_run_failed (0.00s)
    --- PASS: TestLastRunChecker/recent_success (0.00s)
    --- PASS: TestLastRunChecker/old_success (0.00s)
=== RUN   TestWritableDirChecker_CreatesMissingDir
--- PASS: TestWritableDirChecker_CreatesMissingDir (0.00s)
PASS
coverage: 53.8% of statements
ok  	github.com/ManuGH/xg2g/internal/health	4.029s	coverage: 53.8% of statements
=== RUN   TestExtractSegmentTruth_Goldens
=== RUN   TestExtractSegmentTruth_Goldens/VOD_with_PDT
=== RUN   TestExtractSegmentTruth_Goldens/Live_with_PDT
=== RUN   TestExtractSegmentTruth_Goldens/Invalid_Missing_EXTM3U
--- PASS: TestExtractSegmentTruth_Goldens (0.00s)
    --- PASS: TestExtractSegmentTruth_Goldens/VOD_with_PDT (0.00s)
    --- PASS: TestExtractSegmentTruth_Goldens/Live_with_PDT (0.00s)
    --- PASS: TestExtractSegmentTruth_Goldens/Invalid_Missing_EXTM3U (0.00s)
=== RUN   TestExtractSegmentTruth_VOD_NoPDT
--- PASS: TestExtractSegmentTruth_VOD_NoPDT (0.00s)
=== RUN   TestExtractSegmentTruth_Live_FullPDT
--- PASS: TestExtractSegmentTruth_Live_FullPDT (0.00s)
=== RUN   TestExtractSegmentTruth_Live_PartialPDT_FailClosed
--- PASS: TestExtractSegmentTruth_Live_PartialPDT_FailClosed (0.00s)
=== RUN   TestExtractSegmentTruth_Live_NonMonotonic_FailClosed
--- PASS: TestExtractSegmentTruth_Live_NonMonotonic_FailClosed (0.00s)
=== RUN   TestExtractSegmentTruth_VOD_EndList_Implicit
--- PASS: TestExtractSegmentTruth_VOD_EndList_Implicit (0.00s)
PASS
coverage: 88.7% of statements
ok  	github.com/ManuGH/xg2g/internal/hls	1.016s	coverage: 88.7% of statements
=== RUN   TestPreflightTS_SyncOK
--- PASS: TestPreflightTS_SyncOK (0.00s)
=== RUN   TestPreflightTS_SyncMiss
--- PASS: TestPreflightTS_SyncMiss (0.00s)
=== RUN   TestPreflightTS_ShortRead
--- PASS: TestPreflightTS_ShortRead (0.00s)
=== RUN   TestSelectStreamURL_FallbackOffFails
--- PASS: TestSelectStreamURL_FallbackOffFails (0.00s)
=== RUN   TestSelectStreamURL_NoFallbackWhenNotRelay
--- PASS: TestSelectStreamURL_NoFallbackWhenNotRelay (0.00s)
=== RUN   TestSelectStreamURL_FallbackTo8001
--- PASS: TestSelectStreamURL_FallbackTo8001 (0.00s)
=== RUN   TestPreflight_HttpClientWiring
--- PASS: TestPreflight_HttpClientWiring (0.00s)
=== RUN   TestParseFPS
=== RUN   TestParseFPS/25/1
=== RUN   TestParseFPS/30000/1001
=== RUN   TestParseFPS/50/1
=== RUN   TestParseFPS/60/1
=== RUN   TestParseFPS/24000/1001
=== RUN   TestParseFPS/30
=== RUN   TestParseFPS/25
=== RUN   TestParseFPS/0/0
=== RUN   TestParseFPS/0/1
=== RUN   TestParseFPS/1/0
=== RUN   TestParseFPS/abc
=== RUN   TestParseFPS/#00
=== RUN   TestParseFPS/25/1/2
=== RUN   TestParseFPS/24.5
--- PASS: TestParseFPS (0.00s)
    --- PASS: TestParseFPS/25/1 (0.00s)
    --- PASS: TestParseFPS/30000/1001 (0.00s)
    --- PASS: TestParseFPS/50/1 (0.00s)
    --- PASS: TestParseFPS/60/1 (0.00s)
    --- PASS: TestParseFPS/24000/1001 (0.00s)
    --- PASS: TestParseFPS/30 (0.00s)
    --- PASS: TestParseFPS/25 (0.00s)
    --- PASS: TestParseFPS/0/0 (0.00s)
    --- PASS: TestParseFPS/0/1 (0.00s)
    --- PASS: TestParseFPS/1/0 (0.00s)
    --- PASS: TestParseFPS/abc (0.00s)
    --- PASS: TestParseFPS/#00 (0.00s)
    --- PASS: TestParseFPS/25/1/2 (0.00s)
    --- PASS: TestParseFPS/24.5 (0.00s)
PASS
coverage: 37.0% of statements
ok  	github.com/ManuGH/xg2g/internal/infra/media/ffmpeg	1.041s	coverage: 37.0% of statements
=== RUN   TestExtractSRefFromStreamURL
=== RUN   TestExtractSRefFromStreamURL/new_format_-_direct_service_reference
=== RUN   TestExtractSRefFromStreamURL/old_format_-_query_parameter_encoded
=== RUN   TestExtractSRefFromStreamURL/old_format_-_query_parameter_not_encoded
=== RUN   TestExtractSRefFromStreamURL/empty_URL
=== RUN   TestExtractSRefFromStreamURL/invalid_URL
=== RUN   TestExtractSRefFromStreamURL/no_service_reference
=== RUN   TestExtractSRefFromStreamURL/path_without_colons
--- PASS: TestExtractSRefFromStreamURL (0.00s)
    --- PASS: TestExtractSRefFromStreamURL/new_format_-_direct_service_reference (0.00s)
    --- PASS: TestExtractSRefFromStreamURL/old_format_-_query_parameter_encoded (0.00s)
    --- PASS: TestExtractSRefFromStreamURL/old_format_-_query_parameter_not_encoded (0.00s)
    --- PASS: TestExtractSRefFromStreamURL/empty_URL (0.00s)
    --- PASS: TestExtractSRefFromStreamURL/invalid_URL (0.00s)
    --- PASS: TestExtractSRefFromStreamURL/no_service_reference (0.00s)
    --- PASS: TestExtractSRefFromStreamURL/path_without_colons (0.00s)
=== RUN   TestNewEPGAggregator
--- PASS: TestNewEPGAggregator (0.00s)
=== RUN   TestBuildSRefMap
--- PASS: TestBuildSRefMap (0.00s)
=== RUN   TestAggregateEvents
{"level":"info","service":"xg2g","version":"","total_programmes":3,"channels_with_data":2,"total_channels":2,"time":"2026-02-01T14:53:05+01:00","message":"EPG aggregation completed"}
--- PASS: TestAggregateEvents (0.00s)
=== RUN   TestAggregateEvents_EmptyEvents
{"level":"info","service":"xg2g","version":"","total_programmes":0,"channels_with_data":0,"total_channels":1,"time":"2026-02-01T14:53:05+01:00","message":"EPG aggregation completed"}
--- PASS: TestAggregateEvents_EmptyEvents (0.00s)
=== RUN   TestAggregateEvents_NoMatchingChannels
{"level":"info","service":"xg2g","version":"","total_programmes":0,"channels_with_data":0,"total_channels":1,"time":"2026-02-01T14:53:05+01:00","message":"EPG aggregation completed"}
--- PASS: TestAggregateEvents_NoMatchingChannels (0.00s)
=== RUN   TestRefresh_IntegrationSuccess
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:05+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:05+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":1,"time":"2026-02-01T14:53:05+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"services.nested","method":"GET","endpoint":"/api/getservices","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:05+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.services","bouquet_ref":"1:7:***EF:","count":2,"time":"2026-02-01T14:53:05+01:00","message":"fetched services via nested endpoint"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"playlist.write","path":"/tmp/TestRefresh_IntegrationSuccess1520042283/001/playlist.m3u8","channels":2,"time":"2026-02-01T14:53:05+01:00","message":"playlist written"}
{"level":"info","service":"xg2g","version":"","component":"jobs","channel":"Chan A","sref":"1:0:19:AAA:1:1:C00000:0:0:0:","time":"2026-02-01T14:53:05+01:00","message":"Debug: XMLTV Channel"}
{"level":"info","service":"xg2g","version":"","component":"jobs","channel":"Chan B","sref":"1:0:19:BBB:1:1:C00000:0:0:0:","time":"2026-02-01T14:53:05+01:00","message":"Debug: XMLTV Channel"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"xmltv.success","path":"/tmp/TestRefresh_IntegrationSuccess1520042283/001/xmltv.xml","channels":2,"programmes":0,"time":"2026-02-01T14:53:05+01:00","message":"XMLTV generated"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.success","channels":2,"time":"2026-02-01T14:53:05+01:00","message":"refresh completed"}
--- PASS: TestRefresh_IntegrationSuccess (0.00s)
=== RUN   TestRefreshWithClient_Success
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"playlist.write","path":"/tmp/TestRefreshWithClient_Success501702792/001/playlist.m3u8","channels":2,"time":"2026-02-01T14:53:05+01:00","message":"playlist written"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"xmltv.success","path":"xmltv.xml","channels":2,"time":"2026-02-01T14:53:05+01:00","message":"XMLTV generated"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.success","channels":2,"time":"2026-02-01T14:53:05+01:00","message":"refresh completed"}
--- PASS: TestRefreshWithClient_Success (0.00s)
=== RUN   TestRefreshWithClient_EmptyBouquetUsesAll
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"playlist.write","path":"/tmp/TestRefreshWithClient_EmptyBouquetUsesAll2769069587/001/playlist.m3u8","channels":2,"time":"2026-02-01T14:53:05+01:00","message":"playlist written"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"xmltv.success","path":"xmltv.xml","channels":2,"time":"2026-02-01T14:53:05+01:00","message":"XMLTV generated"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.success","channels":2,"time":"2026-02-01T14:53:05+01:00","message":"refresh completed"}
--- PASS: TestRefreshWithClient_EmptyBouquetUsesAll (0.00s)
=== RUN   TestRefreshWithClient_BouquetNotFound
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
--- PASS: TestRefreshWithClient_BouquetNotFound (0.00s)
=== RUN   TestRefreshWithClient_ServicesError
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"playlist.write","path":"/tmp/TestRefreshWithClient_ServicesError649480561/001/playlist.m3u8","channels":0,"time":"2026-02-01T14:53:05+01:00","message":"playlist written"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.success","channels":0,"time":"2026-02-01T14:53:05+01:00","message":"refresh completed"}
--- PASS: TestRefreshWithClient_ServicesError (0.00s)
=== RUN   TestRefresh_InvalidStreamPort
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
--- PASS: TestRefresh_InvalidStreamPort (0.00s)
=== RUN   TestRefresh_ConfigValidation
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
--- PASS: TestRefresh_ConfigValidation (0.00s)
=== RUN   TestRefresh_M3UWriteError
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
--- PASS: TestRefresh_M3UWriteError (0.00s)
=== RUN   TestValidateConfig
=== RUN   TestValidateConfig/http_ok
=== RUN   TestValidateConfig/https_ok
=== RUN   TestValidateConfig/empty_owiabase
=== RUN   TestValidateConfig/missing_scheme
=== RUN   TestValidateConfig/unsupported_scheme
=== RUN   TestValidateConfig/invalid_port
=== RUN   TestValidateConfig/port_too_large
=== RUN   TestValidateConfig/empty_datadir
=== RUN   TestValidateConfig/path_traversal
=== RUN   TestValidateConfig/invalid_stream_port_zero
=== RUN   TestValidateConfig/invalid_stream_port_negative
=== RUN   TestValidateConfig/missing_host
--- PASS: TestValidateConfig (0.00s)
    --- PASS: TestValidateConfig/http_ok (0.00s)
    --- PASS: TestValidateConfig/https_ok (0.00s)
    --- PASS: TestValidateConfig/empty_owiabase (0.00s)
    --- PASS: TestValidateConfig/missing_scheme (0.00s)
    --- PASS: TestValidateConfig/unsupported_scheme (0.00s)
    --- PASS: TestValidateConfig/invalid_port (0.00s)
    --- PASS: TestValidateConfig/port_too_large (0.00s)
    --- PASS: TestValidateConfig/empty_datadir (0.00s)
    --- PASS: TestValidateConfig/path_traversal (0.00s)
    --- PASS: TestValidateConfig/invalid_stream_port_zero (0.00s)
    --- PASS: TestValidateConfig/invalid_stream_port_negative (0.00s)
    --- PASS: TestValidateConfig/missing_host (0.00s)
=== RUN   TestRefresh_VersionPersistence
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.start","time":"2026-02-01T14:53:05+01:00","message":"starting refresh"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"playlist.write","path":"/tmp/TestRefresh_VersionPersistence2069605792/001/playlist.m3u8","channels":1,"time":"2026-02-01T14:53:05+01:00","message":"playlist written"}
{"level":"info","service":"xg2g","version":"","component":"jobs","event":"refresh.success","channels":1,"time":"2026-02-01T14:53:05+01:00","message":"refresh completed"}
--- PASS: TestRefresh_VersionPersistence (0.00s)
=== RUN   TestSlugify
=== RUN   TestSlugify/simple_lowercase
=== RUN   TestSlugify/with_HD_suffix
=== RUN   TestSlugify/german_umlauts
=== RUN   TestSlugify/special_characters
=== RUN   TestSlugify/multiple_spaces
=== RUN   TestSlugify/leading/trailing_spaces
=== RUN   TestSlugify/french_accents
=== RUN   TestSlugify/spanish_characters
=== RUN   TestSlugify/numbers_only
=== RUN   TestSlugify/empty_string
=== RUN   TestSlugify/only_special_chars
=== RUN   TestSlugify/very_long_name
=== RUN   TestSlugify/dots_and_underscores
=== RUN   TestSlugify/plus_signs
=== RUN   TestSlugify/ampersand
--- PASS: TestSlugify (0.00s)
    --- PASS: TestSlugify/simple_lowercase (0.00s)
    --- PASS: TestSlugify/with_HD_suffix (0.00s)
    --- PASS: TestSlugify/german_umlauts (0.00s)
    --- PASS: TestSlugify/special_characters (0.00s)
    --- PASS: TestSlugify/multiple_spaces (0.00s)
    --- PASS: TestSlugify/leading/trailing_spaces (0.00s)
    --- PASS: TestSlugify/french_accents (0.00s)
    --- PASS: TestSlugify/spanish_characters (0.00s)
    --- PASS: TestSlugify/numbers_only (0.00s)
    --- PASS: TestSlugify/empty_string (0.00s)
    --- PASS: TestSlugify/only_special_chars (0.00s)
    --- PASS: TestSlugify/very_long_name (0.00s)
    --- PASS: TestSlugify/dots_and_underscores (0.00s)
    --- PASS: TestSlugify/plus_signs (0.00s)
    --- PASS: TestSlugify/ampersand (0.00s)
=== RUN   TestMakeHumanReadableTvgID
=== RUN   TestMakeHumanReadableTvgID/Das_Erste_HD
=== RUN   TestMakeHumanReadableTvgID/ZDF
=== RUN   TestMakeHumanReadableTvgID/Sport_Channel_HD_with_special_chars
=== RUN   TestMakeHumanReadableTvgID/Channel_with_umlauts
--- PASS: TestMakeHumanReadableTvgID (0.00s)
    --- PASS: TestMakeHumanReadableTvgID/Das_Erste_HD (0.00s)
    --- PASS: TestMakeHumanReadableTvgID/ZDF (0.00s)
    --- PASS: TestMakeHumanReadableTvgID/Sport_Channel_HD_with_special_chars (0.00s)
    --- PASS: TestMakeHumanReadableTvgID/Channel_with_umlauts (0.00s)
=== RUN   TestMakeHumanReadableTvgID_Stability
--- PASS: TestMakeHumanReadableTvgID_Stability (0.00s)
=== RUN   TestMakeHumanReadableTvgID_Uniqueness
--- PASS: TestMakeHumanReadableTvgID_Uniqueness (0.00s)
=== RUN   TestValidateConfig_Comprehensive
=== RUN   TestValidateConfig_Comprehensive/valid_minimal_config
=== RUN   TestValidateConfig_Comprehensive/valid_full_config_with_picons
=== RUN   TestValidateConfig_Comprehensive/valid_config_with_empty_picon_base
=== RUN   TestValidateConfig_Comprehensive/missing_OWIBase
=== RUN   TestValidateConfig_Comprehensive/invalid_OWIBase_scheme_(ftp)
=== RUN   TestValidateConfig_Comprehensive/invalid_OWIBase_format
=== RUN   TestValidateConfig_Comprehensive/OWIBase_missing_host
=== RUN   TestValidateConfig_Comprehensive/invalid_port_zero
=== RUN   TestValidateConfig_Comprehensive/invalid_port_negative
=== RUN   TestValidateConfig_Comprehensive/invalid_port_too_high
=== RUN   TestValidateConfig_Comprehensive/missing_DataDir
=== RUN   TestValidateConfig_Comprehensive/invalid_PiconBase_scheme
=== RUN   TestValidateConfig_Comprehensive/invalid_PiconBase_format
=== RUN   TestValidateConfig_Comprehensive/PiconBase_missing_host
--- PASS: TestValidateConfig_Comprehensive (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/valid_minimal_config (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/valid_full_config_with_picons (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/valid_config_with_empty_picon_base (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/missing_OWIBase (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/invalid_OWIBase_scheme_(ftp) (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/invalid_OWIBase_format (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/OWIBase_missing_host (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/invalid_port_zero (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/invalid_port_negative (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/invalid_port_too_high (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/missing_DataDir (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/invalid_PiconBase_scheme (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/invalid_PiconBase_format (0.00s)
    --- PASS: TestValidateConfig_Comprehensive/PiconBase_missing_host (0.00s)
=== RUN   TestValidateConfig_PiconBase
=== RUN   TestValidateConfig_PiconBase/empty_picon_base_is_valid
=== RUN   TestValidateConfig_PiconBase/valid_http_url
=== RUN   TestValidateConfig_PiconBase/valid_https_url
=== RUN   TestValidateConfig_PiconBase/invalid_scheme
=== RUN   TestValidateConfig_PiconBase/invalid_url
=== RUN   TestValidateConfig_PiconBase/missing_host
--- PASS: TestValidateConfig_PiconBase (0.00s)
    --- PASS: TestValidateConfig_PiconBase/empty_picon_base_is_valid (0.00s)
    --- PASS: TestValidateConfig_PiconBase/valid_http_url (0.00s)
    --- PASS: TestValidateConfig_PiconBase/valid_https_url (0.00s)
    --- PASS: TestValidateConfig_PiconBase/invalid_scheme (0.00s)
    --- PASS: TestValidateConfig_PiconBase/invalid_url (0.00s)
    --- PASS: TestValidateConfig_PiconBase/missing_host (0.00s)
PASS
coverage: 36.9% of statements
ok  	github.com/ManuGH/xg2g/internal/jobs	1.043s	coverage: 36.9% of statements
=== RUN   TestContextWithRequestID
=== RUN   TestContextWithRequestID/nil_context
=== RUN   TestContextWithRequestID/background_context
=== RUN   TestContextWithRequestID/empty_request_ID
--- PASS: TestContextWithRequestID (0.00s)
    --- PASS: TestContextWithRequestID/nil_context (0.00s)
    --- PASS: TestContextWithRequestID/background_context (0.00s)
    --- PASS: TestContextWithRequestID/empty_request_ID (0.00s)
=== RUN   TestContextWithJobID
=== RUN   TestContextWithJobID/nil_context
=== RUN   TestContextWithJobID/background_context
--- PASS: TestContextWithJobID (0.00s)
    --- PASS: TestContextWithJobID/nil_context (0.00s)
    --- PASS: TestContextWithJobID/background_context (0.00s)
=== RUN   TestContextWithCorrelationID
=== RUN   TestContextWithCorrelationID/nil_context
=== RUN   TestContextWithCorrelationID/background_context
=== RUN   TestContextWithCorrelationID/empty_correlation_ID
--- PASS: TestContextWithCorrelationID (0.00s)
    --- PASS: TestContextWithCorrelationID/nil_context (0.00s)
    --- PASS: TestContextWithCorrelationID/background_context (0.00s)
    --- PASS: TestContextWithCorrelationID/empty_correlation_ID (0.00s)
=== RUN   TestRequestIDFromContextEmpty
=== RUN   TestRequestIDFromContextEmpty/nil_context
=== RUN   TestRequestIDFromContextEmpty/context_without_request_ID
=== RUN   TestRequestIDFromContextEmpty/context_with_wrong_type
--- PASS: TestRequestIDFromContextEmpty (0.00s)
    --- PASS: TestRequestIDFromContextEmpty/nil_context (0.00s)
    --- PASS: TestRequestIDFromContextEmpty/context_without_request_ID (0.00s)
    --- PASS: TestRequestIDFromContextEmpty/context_with_wrong_type (0.00s)
=== RUN   TestWithContext
--- PASS: TestWithContext (0.00s)
=== RUN   TestWithComponentFromContext
--- PASS: TestWithComponentFromContext (0.00s)
=== RUN   TestBase
--- PASS: TestBase (0.00s)
=== RUN   TestDerive
--- PASS: TestDerive (0.00s)
=== RUN   TestWithTraceContext
=== RUN   TestWithTraceContext/WithValidSpan
--- PASS: TestWithTraceContext (0.00s)
    --- PASS: TestWithTraceContext/WithValidSpan (0.00s)
=== RUN   TestStructuredBufferWriter_Framing
--- PASS: TestStructuredBufferWriter_Framing (0.00s)
=== RUN   TestStructuredBufferWriter_Bounds
--- PASS: TestStructuredBufferWriter_Bounds (0.01s)
=== RUN   TestStructuredBufferWriter_RelevanceFilter
--- PASS: TestStructuredBufferWriter_RelevanceFilter (0.00s)
PASS
coverage: 68.8% of statements
ok  	github.com/ManuGH/xg2g/internal/log	1.022s	coverage: 68.8% of statements
=== RUN   TestParseRepro
--- PASS: TestParseRepro (0.00s)
PASS
coverage: 100.0% of statements
ok  	github.com/ManuGH/xg2g/internal/m3u	(cached)	coverage: 100.0% of statements
=== RUN   TestWatchdog_StartTimeout
--- PASS: TestWatchdog_StartTimeout (0.05s)
=== RUN   TestWatchdog_StallTimeout
--- PASS: TestWatchdog_StallTimeout (0.05s)
=== RUN   TestWatchdog_MeaningfulProgress
--- PASS: TestWatchdog_MeaningfulProgress (0.00s)
=== RUN   TestWatchdog_ParserRobustness
--- PASS: TestWatchdog_ParserRobustness (0.00s)
PASS
coverage: 85.7% of statements
ok  	github.com/ManuGH/xg2g/internal/media/ffmpeg/watchdog	1.113s	coverage: 85.7% of statements
=== RUN   TestRecordBouquetsCount
=== RUN   TestRecordBouquetsCount/zero_bouquets
=== RUN   TestRecordBouquetsCount/single_bouquet
=== RUN   TestRecordBouquetsCount/multiple_bouquets
=== RUN   TestRecordBouquetsCount/large_count
--- PASS: TestRecordBouquetsCount (0.00s)
    --- PASS: TestRecordBouquetsCount/zero_bouquets (0.00s)
    --- PASS: TestRecordBouquetsCount/single_bouquet (0.00s)
    --- PASS: TestRecordBouquetsCount/multiple_bouquets (0.00s)
    --- PASS: TestRecordBouquetsCount/large_count (0.00s)
=== RUN   TestIncBouquetDiscoveryError
--- PASS: TestIncBouquetDiscoveryError (0.00s)
=== RUN   TestRecordServicesCount
=== RUN   TestRecordServicesCount/Favourites
=== RUN   TestRecordServicesCount/Sports
=== RUN   TestRecordServicesCount/Movies
=== RUN   TestRecordServicesCount/News
--- PASS: TestRecordServicesCount (0.00s)
    --- PASS: TestRecordServicesCount/Favourites (0.00s)
    --- PASS: TestRecordServicesCount/Sports (0.00s)
    --- PASS: TestRecordServicesCount/Movies (0.00s)
    --- PASS: TestRecordServicesCount/News (0.00s)
=== RUN   TestIncServicesResolution
--- PASS: TestIncServicesResolution (0.00s)
=== RUN   TestIncStreamURLBuild
--- PASS: TestIncStreamURLBuild (0.00s)
=== RUN   TestRecordChannelTypeCounts
=== RUN   TestRecordChannelTypeCounts/all_zeros
=== RUN   TestRecordChannelTypeCounts/mixed_counts
=== RUN   TestRecordChannelTypeCounts/only_HD
=== RUN   TestRecordChannelTypeCounts/only_radio
--- PASS: TestRecordChannelTypeCounts (0.00s)
    --- PASS: TestRecordChannelTypeCounts/all_zeros (0.00s)
    --- PASS: TestRecordChannelTypeCounts/mixed_counts (0.00s)
    --- PASS: TestRecordChannelTypeCounts/only_HD (0.00s)
    --- PASS: TestRecordChannelTypeCounts/only_radio (0.00s)
=== RUN   TestRecordXMLTV
=== RUN   TestRecordXMLTV/XMLTV_disabled
=== RUN   TestRecordXMLTV/XMLTV_enabled_with_success
=== RUN   TestRecordXMLTV/XMLTV_enabled_with_error
--- PASS: TestRecordXMLTV (0.00s)
    --- PASS: TestRecordXMLTV/XMLTV_disabled (0.00s)
    --- PASS: TestRecordXMLTV/XMLTV_enabled_with_success (0.00s)
    --- PASS: TestRecordXMLTV/XMLTV_enabled_with_error (0.00s)
=== RUN   TestIncConfigValidationError
--- PASS: TestIncConfigValidationError (0.00s)
=== RUN   TestIncRefreshFailure
--- PASS: TestIncRefreshFailure (0.00s)
=== RUN   TestEPGMetrics
=== RUN   TestEPGMetrics/EPG_channel_error
=== RUN   TestEPGMetrics/EPG_channel_success
=== RUN   TestEPGMetrics/EPG_collection_recording
--- PASS: TestEPGMetrics (0.00s)
    --- PASS: TestEPGMetrics/EPG_channel_error (0.00s)
    --- PASS: TestEPGMetrics/EPG_channel_success (0.00s)
    --- PASS: TestEPGMetrics/EPG_collection_recording (0.00s)
=== RUN   TestMetricsIntegration
--- PASS: TestMetricsIntegration (0.00s)
=== RUN   TestPromhttpExposure
--- PASS: TestPromhttpExposure (0.01s)
=== RUN   TestRecordPlaylistFileValidity
=== RUN   TestRecordPlaylistFileValidity/valid_m3u_file
=== RUN   TestRecordPlaylistFileValidity/invalid_m3u_file
=== RUN   TestRecordPlaylistFileValidity/valid_xmltv_file
=== RUN   TestRecordPlaylistFileValidity/invalid_xmltv_file
--- PASS: TestRecordPlaylistFileValidity (0.01s)
    --- PASS: TestRecordPlaylistFileValidity/valid_m3u_file (0.00s)
    --- PASS: TestRecordPlaylistFileValidity/invalid_m3u_file (0.00s)
    --- PASS: TestRecordPlaylistFileValidity/valid_xmltv_file (0.00s)
    --- PASS: TestRecordPlaylistFileValidity/invalid_xmltv_file (0.00s)
=== RUN   TestRecordPlaylistFileValidity_MultipleTypes
--- PASS: TestRecordPlaylistFileValidity_MultipleTypes (0.00s)
PASS
coverage: 29.1% of statements
ok  	github.com/ManuGH/xg2g/internal/metrics	1.048s	coverage: 29.1% of statements
=== RUN   TestRecordTranscodeLatency
--- PASS: TestRecordTranscodeLatency (0.00s)
=== RUN   TestUpdateGPUUtilization
--- PASS: TestUpdateGPUUtilization (0.00s)
=== RUN   TestUpdateVRAMUsage
--- PASS: TestUpdateVRAMUsage (0.00s)
=== RUN   TestActiveStreamsIncDec
--- PASS: TestActiveStreamsIncDec (0.00s)
=== RUN   TestRecordTranscodeError
--- PASS: TestRecordTranscodeError (0.00s)
=== RUN   TestRecordStreamDetectionError
--- PASS: TestRecordStreamDetectionError (0.00s)
=== RUN   TestMetricLabels
=== RUN   TestMetricLabels/GPUUtilization
=== RUN   TestMetricLabels/GPUVRAMUsage
=== RUN   TestMetricLabels/TranscodeLatency
=== RUN   TestMetricLabels/ActiveStreamsByMode
=== RUN   TestMetricLabels/TranscodeErrors
=== RUN   TestMetricLabels/StreamDetectionErrors
--- PASS: TestMetricLabels (0.00s)
    --- PASS: TestMetricLabels/GPUUtilization (0.00s)
    --- PASS: TestMetricLabels/GPUVRAMUsage (0.00s)
    --- PASS: TestMetricLabels/TranscodeLatency (0.00s)
    --- PASS: TestMetricLabels/ActiveStreamsByMode (0.00s)
    --- PASS: TestMetricLabels/TranscodeErrors (0.00s)
    --- PASS: TestMetricLabels/StreamDetectionErrors (0.00s)
PASS
coverage: 100.0% of statements
ok  	github.com/ManuGH/xg2g/internal/metrics/gpu	(cached)	coverage: 100.0% of statements
=== RUN   TestClientBouquets5xx
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:06+01:00","message":"receiver rate limiting enabled"}
{"level":"error","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":1,"error_class":"http_5xx","status":502,"time":"2026-02-01T14:53:06+01:00","message":"openwebif request failed"}
--- PASS: TestClientBouquets5xx (0.00s)
=== RUN   TestClientBouquetsInvalidJSON
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:06+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:06+01:00","message":"openwebif request completed"}
{"level":"error","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","error":"invalid character 'n' looking for beginning of object key string","event":"openwebif.decode","operation":"bouquets","time":"2026-02-01T14:53:06+01:00","message":"failed to decode bouquets response"}
--- PASS: TestClientBouquetsInvalidJSON (0.00s)
=== RUN   TestClientGetServicesTimeout
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:06+01:00","message":"receiver rate limiting enabled"}
{"level":"error","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"services.nested","method":"GET","endpoint":"/api/getservices","attempt":1,"max_attempts":1,"duration_ms":500,"error_class":"timeout","error":"Get \"http://127.0.0.1:42087/api/getservices?sRef=1%3A0%3A0\": context deadline exceeded (Client.Timeout exceeded while awaiting headers)","time":"2026-02-01T14:53:07+01:00","message":"openwebif request failed"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.services","bouquet_ref":"1:***:0","time":"2026-02-01T14:53:07+01:00","message":"no services found for bouquet"}
--- PASS: TestClientGetServicesTimeout (2.00s)
=== RUN   TestClientGetServicesBouquetNotFoundSchemaOK
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"services.nested","method":"GET","endpoint":"/api/getservices","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:08+01:00","message":"openwebif request completed"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.services","bouquet_ref":"1:***:0","time":"2026-02-01T14:53:08+01:00","message":"no services found for bouquet"}
--- PASS: TestClientGetServicesBouquetNotFoundSchemaOK (0.00s)
=== RUN   TestHardenedClient_ResponseHeaderTimeout
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
{"level":"error","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":50,"error_class":"timeout","error":"Get \"http://127.0.0.1:45457/api/bouquets\": net/http: timeout awaiting response headers","time":"2026-02-01T14:53:08+01:00","message":"openwebif request failed"}
--- PASS: TestHardenedClient_ResponseHeaderTimeout (0.10s)
=== RUN   TestStreamURLScenarios
=== RUN   TestStreamURLScenarios/configured_port
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
=== RUN   TestStreamURLScenarios/existing_port_preserved
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
=== RUN   TestStreamURLScenarios/ipv6_without_port
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"fd00::57","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
=== RUN   TestStreamURLScenarios/ipv6_with_port
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"fd00::57","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
=== RUN   TestStreamURLScenarios/trailing_slash
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.com","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
=== RUN   TestStreamURLScenarios/default_port
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.com","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
--- PASS: TestStreamURLScenarios (0.00s)
    --- PASS: TestStreamURLScenarios/configured_port (0.00s)
    --- PASS: TestStreamURLScenarios/existing_port_preserved (0.00s)
    --- PASS: TestStreamURLScenarios/ipv6_without_port (0.00s)
    --- PASS: TestStreamURLScenarios/ipv6_with_port (0.00s)
    --- PASS: TestStreamURLScenarios/trailing_slash (0.00s)
    --- PASS: TestStreamURLScenarios/default_port (0.00s)
=== RUN   TestStreamURLWebIF
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"example.com","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
--- PASS: TestStreamURLWebIF (0.00s)
=== RUN   TestAbout
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"about","method":"GET","endpoint":"/api/about","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:08+01:00","message":"openwebif request completed"}
--- PASS: TestAbout (0.00s)
=== RUN   TestBouquetsTimeout
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:08+01:00","message":"receiver rate limiting enabled"}
{"level":"error","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":50,"error_class":"timeout","error":"Get \"http://127.0.0.1:45267/api/bouquets\": context deadline exceeded","time":"2026-02-01T14:53:08+01:00","message":"openwebif request failed"}
--- PASS: TestBouquetsTimeout (0.20s)
=== RUN   TestBouquetsRetrySuccess
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:09+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":2,"duration_ms":0,"error_class":"http_5xx","status":502,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request retry"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":2,"max_attempts":2,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":1,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
--- PASS: TestBouquetsRetrySuccess (0.01s)
=== RUN   TestBouquetsRetryFailure
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:09+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":2,"duration_ms":0,"error_class":"http_5xx","status":502,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request retry"}
{"level":"error","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":2,"max_attempts":2,"duration_ms":0,"error_class":"http_5xx","status":502,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request failed"}
--- PASS: TestBouquetsRetryFailure (0.01s)
=== RUN   TestContextCancellationCleanup
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:09+01:00","message":"receiver rate limiting enabled"}
{"level":"error","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":50,"error_class":"timeout","error":"Get \"http://127.0.0.1:40215/api/bouquets\": context deadline exceeded","time":"2026-02-01T14:53:09+01:00","message":"openwebif request failed"}
--- PASS: TestContextCancellationCleanup (0.20s)
=== RUN   TestReceiverRateLimiting
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":5,"burst":5,"time":"2026-02-01T14:53:09+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:09+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:09+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:10+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:10+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:10+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:10+01:00","message":"fetched bouquets"}
    client_test.go:299: 10 requests with 5 req/s limit took 1.000632997s (expected ~1s)
--- PASS: TestReceiverRateLimiting (1.00s)
=== RUN   TestReceiverRateLimitContextCancellation
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":1,"burst":1,"time":"2026-02-01T14:53:10+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:10+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":0,"time":"2026-02-01T14:53:10+01:00","message":"fetched bouquets"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","error":"context canceled","event":"openwebif.rate_limit","operation":"bouquets","time":"2026-02-01T14:53:10+01:00","message":"rate limit wait cancelled"}
    client_test.go:345: cancelled request failed in 32.871µs (expected <50ms)
--- PASS: TestReceiverRateLimitContextCancellation (0.00s)
=== RUN   TestConvertLatin1ToUTF8
=== RUN   TestConvertLatin1ToUTF8/Möglichkeiten
=== RUN   TestConvertLatin1ToUTF8/Kitzbühel
=== RUN   TestConvertLatin1ToUTF8/Österreich
=== RUN   TestConvertLatin1ToUTF8/ASCII_only
=== RUN   TestConvertLatin1ToUTF8/Mixed_ASCII_and_umlauts
--- PASS: TestConvertLatin1ToUTF8 (0.00s)
    --- PASS: TestConvertLatin1ToUTF8/Möglichkeiten (0.00s)
    --- PASS: TestConvertLatin1ToUTF8/Kitzbühel (0.00s)
    --- PASS: TestConvertLatin1ToUTF8/Österreich (0.00s)
    --- PASS: TestConvertLatin1ToUTF8/ASCII_only (0.00s)
    --- PASS: TestConvertLatin1ToUTF8/Mixed_ASCII_and_umlauts (0.00s)
=== RUN   TestNeedsLatin1Conversion
=== RUN   TestNeedsLatin1Conversion/UTF-8_declared
=== RUN   TestNeedsLatin1Conversion/ISO-8859-1_declared
=== RUN   TestNeedsLatin1Conversion/Latin-1_declared
=== RUN   TestNeedsLatin1Conversion/Invalid_UTF-8_without_declaration
=== RUN   TestNeedsLatin1Conversion/Valid_UTF-8_without_declaration
=== RUN   TestNeedsLatin1Conversion/ASCII_only
--- PASS: TestNeedsLatin1Conversion (0.00s)
    --- PASS: TestNeedsLatin1Conversion/UTF-8_declared (0.00s)
    --- PASS: TestNeedsLatin1Conversion/ISO-8859-1_declared (0.00s)
    --- PASS: TestNeedsLatin1Conversion/Latin-1_declared (0.00s)
    --- PASS: TestNeedsLatin1Conversion/Invalid_UTF-8_without_declaration (0.00s)
    --- PASS: TestNeedsLatin1Conversion/Valid_UTF-8_without_declaration (0.00s)
    --- PASS: TestNeedsLatin1Conversion/ASCII_only (0.00s)
=== RUN   TestWrapError_Sentinels
=== RUN   TestWrapError_Sentinels/HTTP_404
=== RUN   TestWrapError_Sentinels/HTTP_403
=== RUN   TestWrapError_Sentinels/HTTP_401
=== RUN   TestWrapError_Sentinels/HTTP_500
=== RUN   TestWrapError_Sentinels/Network_Timeout
=== RUN   TestWrapError_Sentinels/Context_Timeout
=== RUN   TestWrapError_Sentinels/Malformed_JSON_(400)
--- PASS: TestWrapError_Sentinels (0.00s)
    --- PASS: TestWrapError_Sentinels/HTTP_404 (0.00s)
    --- PASS: TestWrapError_Sentinels/HTTP_403 (0.00s)
    --- PASS: TestWrapError_Sentinels/HTTP_401 (0.00s)
    --- PASS: TestWrapError_Sentinels/HTTP_500 (0.00s)
    --- PASS: TestWrapError_Sentinels/Network_Timeout (0.00s)
    --- PASS: TestWrapError_Sentinels/Context_Timeout (0.00s)
    --- PASS: TestWrapError_Sentinels/Malformed_JSON_(400) (0.00s)
=== RUN   TestWrapError_Redaction
--- PASS: TestWrapError_Redaction (0.00s)
=== RUN   TestPiconURL
=== RUN   TestPiconURL/sd_service
=== RUN   TestPiconURL/hd_service_type_19_normalized_to_sd
=== RUN   TestPiconURL/base_with_trailing_slash
=== RUN   TestPiconURL/hd_service_type_1f_hevc
=== RUN   TestPiconURL/empty_sref
=== RUN   TestPiconURL/ipv6_address
--- PASS: TestPiconURL (0.00s)
    --- PASS: TestPiconURL/sd_service (0.00s)
    --- PASS: TestPiconURL/hd_service_type_19_normalized_to_sd (0.00s)
    --- PASS: TestPiconURL/base_with_trailing_slash (0.00s)
    --- PASS: TestPiconURL/hd_service_type_1f_hevc (0.00s)
    --- PASS: TestPiconURL/empty_sref (0.00s)
    --- PASS: TestPiconURL/ipv6_address (0.00s)
=== RUN   TestNormalizeServiceRefForPicon
=== RUN   TestNormalizeServiceRefForPicon/sd_service_unchanged
=== RUN   TestNormalizeServiceRefForPicon/hd_service_type_19_normalized
=== RUN   TestNormalizeServiceRefForPicon/hd_service_type_1f_normalized
--- PASS: TestNormalizeServiceRefForPicon (0.00s)
    --- PASS: TestNormalizeServiceRefForPicon/sd_service_unchanged (0.00s)
    --- PASS: TestNormalizeServiceRefForPicon/hd_service_type_19_normalized (0.00s)
    --- PASS: TestNormalizeServiceRefForPicon/hd_service_type_1f_normalized (0.00s)
=== RUN   TestStringOrNumberString_UnmarshalJSON
--- PASS: TestStringOrNumberString_UnmarshalJSON (0.00s)
=== RUN   TestIntOrStringInt64_UnmarshalJSON
--- PASS: TestIntOrStringInt64_UnmarshalJSON (0.00s)
=== RUN   TestBookmarkList_UnmarshalJSON
--- PASS: TestBookmarkList_UnmarshalJSON (0.00s)
PASS
coverage: 47.5% of statements
ok  	github.com/ManuGH/xg2g/internal/openwebif	4.568s	coverage: 47.5% of statements
=== RUN   TestVerifyIntegrity_Corruption_INV_SQLITE_012
    verify_test.go:66: Detected expected corruption issues: [*** in database main ***
        Tree 2 page 2: btreeInitPage() returns error code 11]
--- PASS: TestVerifyIntegrity_Corruption_INV_SQLITE_012 (0.02s)
PASS
coverage: 81.1% of statements
ok  	github.com/ManuGH/xg2g/internal/persistence/sqlite	1.031s	coverage: 81.1% of statements
?   	github.com/ManuGH/xg2g/internal/pipeline	[no test files]
=== RUN   TestNormalizeProgramDateTimeLine
=== RUN   TestNormalizeProgramDateTimeLine/Already_RFC3339_(Z)
=== RUN   TestNormalizeProgramDateTimeLine/Already_RFC3339_(Colon_Offset)
=== RUN   TestNormalizeProgramDateTimeLine/Fix_+0000_to_Z
=== RUN   TestNormalizeProgramDateTimeLine/Fix_+HHMM_to_+HH:MM
=== RUN   TestNormalizeProgramDateTimeLine/Fix_-HHMM_to_-HH:MM
=== RUN   TestNormalizeProgramDateTimeLine/Ignore_Non-PDT_Lines
=== RUN   TestNormalizeProgramDateTimeLine/Ignore_Malformed_PDT
=== RUN   TestNormalizeProgramDateTimeLine/Trims_trailing_whitespace_when_normalizing
--- PASS: TestNormalizeProgramDateTimeLine (0.00s)
    --- PASS: TestNormalizeProgramDateTimeLine/Already_RFC3339_(Z) (0.00s)
    --- PASS: TestNormalizeProgramDateTimeLine/Already_RFC3339_(Colon_Offset) (0.00s)
    --- PASS: TestNormalizeProgramDateTimeLine/Fix_+0000_to_Z (0.00s)
    --- PASS: TestNormalizeProgramDateTimeLine/Fix_+HHMM_to_+HH:MM (0.00s)
    --- PASS: TestNormalizeProgramDateTimeLine/Fix_-HHMM_to_-HH:MM (0.00s)
    --- PASS: TestNormalizeProgramDateTimeLine/Ignore_Non-PDT_Lines (0.00s)
    --- PASS: TestNormalizeProgramDateTimeLine/Ignore_Malformed_PDT (0.00s)
    --- PASS: TestNormalizeProgramDateTimeLine/Trims_trailing_whitespace_when_normalizing (0.00s)
=== RUN   TestServeHLS_DVRWithStartTag
--- PASS: TestServeHLS_DVRWithStartTag (0.00s)
=== RUN   TestServeHLS_VODNoStartTag
--- PASS: TestServeHLS_VODNoStartTag (0.00s)
=== RUN   TestServeHLS_LiveNoStartTag
--- PASS: TestServeHLS_LiveNoStartTag (0.00s)
=== RUN   TestServeHLS_NegativePreparingJSON
{"level":"info","service":"xg2g","version":"","sid":"failure-test-session","file":"index.m3u8","path":"/tmp/TestServeHLS_NegativePreparingJSON3299425896/001/sessions/failure-test-session/index.m3u8","state":"READY","state":"READY","time":"2026-02-01T14:53:06+01:00","message":"playlist missing, not polling (state mismatch)"}
{"level":"warn","service":"xg2g","version":"","sid":"failure-test-session","file":"index.m3u8","path":"/tmp/TestServeHLS_NegativePreparingJSON3299425896/001/sessions/failure-test-session/index.m3u8","state":"READY","error":"stat /tmp/TestServeHLS_NegativePreparingJSON3299425896/001/sessions/failure-test-session/index.m3u8: no such file or directory","time":"2026-02-01T14:53:06+01:00","message":"file not found (final)"}
--- PASS: TestServeHLS_NegativePreparingJSON (0.00s)
PASS
coverage: 56.1% of statements
ok  	github.com/ManuGH/xg2g/internal/pipeline/api	1.019s	coverage: 56.1% of statements
=== RUN   TestMemoryBusDropMetrics
--- PASS: TestMemoryBusDropMetrics (0.00s)
PASS
coverage: 86.2% of statements
ok  	github.com/ManuGH/xg2g/internal/pipeline/bus	1.017s	coverage: 86.2% of statements
=== RUN   TestClient_Zap
--- PASS: TestClient_Zap (0.00s)
=== RUN   TestClient_GetCurrent
--- PASS: TestClient_GetCurrent (0.00s)
=== RUN   TestClient_GetSignal
--- PASS: TestClient_GetSignal (0.00s)
=== RUN   TestReadyChecker_HappyPath
--- PASS: TestReadyChecker_HappyPath (0.04s)
=== RUN   TestReadyChecker_Timeout
--- PASS: TestReadyChecker_Timeout (0.10s)
=== RUN   TestReadyChecker_WrongRef
--- PASS: TestReadyChecker_WrongRef (0.10s)
=== RUN   TestTuner_Tune_Success
{"level":"info","service":"xg2g","version":"","slot":0,"ref":"1:0:1:123:0","time":"2026-02-01T14:53:08+01:00","message":"tuner locked and ready (settled)"}
--- PASS: TestTuner_Tune_Success (0.52s)
=== RUN   TestTuner_Tune_Timeout
--- PASS: TestTuner_Tune_Timeout (0.10s)
PASS
coverage: 57.2% of statements
ok  	github.com/ManuGH/xg2g/internal/pipeline/exec/enigma2	1.883s	coverage: 57.2% of statements
=== RUN   TestHWAccelForceWithoutGPU
--- PASS: TestHWAccelForceWithoutGPU (0.00s)
=== RUN   TestHWAccelOffAlwaysCPU
=== RUN   TestHWAccelOffAlwaysCPU/off+gpu_→_cpu
=== RUN   TestHWAccelOffAlwaysCPU/off+no-gpu_→_cpu
--- PASS: TestHWAccelOffAlwaysCPU (0.00s)
    --- PASS: TestHWAccelOffAlwaysCPU/off+gpu_→_cpu (0.00s)
    --- PASS: TestHWAccelOffAlwaysCPU/off+no-gpu_→_cpu (0.00s)
=== RUN   TestHWAccelAutoRespectGPU
=== RUN   TestHWAccelAutoRespectGPU/auto+gpu_→_vaapi
=== RUN   TestHWAccelAutoRespectGPU/auto+no-gpu_→_cpu
--- PASS: TestHWAccelAutoRespectGPU (0.00s)
    --- PASS: TestHWAccelAutoRespectGPU/auto+gpu_→_vaapi (0.00s)
    --- PASS: TestHWAccelAutoRespectGPU/auto+no-gpu_→_cpu (0.00s)
=== RUN   TestHWAccelHEVCProfiles
=== RUN   TestHWAccelHEVCProfiles/safari_hevc_hw+auto+gpu_→_vaapi
=== RUN   TestHWAccelHEVCProfiles/safari_hevc_hw+auto+no-gpu_→_x265
=== RUN   TestHWAccelHEVCProfiles/safari_hevc_hw+off+gpu_→_x265
=== RUN   TestHWAccelHEVCProfiles/safari_hevc_hw_ll+force+gpu_→_vaapi+llhls
--- PASS: TestHWAccelHEVCProfiles (0.00s)
    --- PASS: TestHWAccelHEVCProfiles/safari_hevc_hw+auto+gpu_→_vaapi (0.00s)
    --- PASS: TestHWAccelHEVCProfiles/safari_hevc_hw+auto+no-gpu_→_x265 (0.00s)
    --- PASS: TestHWAccelHEVCProfiles/safari_hevc_hw+off+gpu_→_x265 (0.00s)
    --- PASS: TestHWAccelHEVCProfiles/safari_hevc_hw_ll+force+gpu_→_vaapi+llhls (0.00s)
=== RUN   TestHWAccelPassthroughIgnored
--- PASS: TestHWAccelPassthroughIgnored (0.00s)
=== RUN   TestHWAccelDeterminism
--- PASS: TestHWAccelDeterminism (0.00s)
=== RUN   TestResolve_AutoSafari
--- PASS: TestResolve_AutoSafari (0.00s)
=== RUN   TestResolve_SmartScan
--- PASS: TestResolve_SmartScan (0.00s)
=== RUN   TestResolve_UnknownCap
--- PASS: TestResolve_UnknownCap (0.00s)
PASS
coverage: 61.2% of statements
ok  	github.com/ManuGH/xg2g/internal/pipeline/profiles	1.022s	coverage: 61.2% of statements
=== RUN   TestNewStore_RejectsBolt
--- PASS: TestNewStore_RejectsBolt (0.00s)
=== RUN   TestNewStore_RejectsBadger
--- PASS: TestNewStore_RejectsBadger (0.00s)
=== RUN   TestNewStore_DefaultsToSqlite
--- PASS: TestNewStore_DefaultsToSqlite (0.01s)
=== RUN   TestNewStore_AllowsMemory
--- PASS: TestNewStore_AllowsMemory (0.00s)
=== RUN   TestNewStore_RejectsUnknown
--- PASS: TestNewStore_RejectsUnknown (0.00s)
PASS
coverage: 38.4% of statements
ok  	github.com/ManuGH/xg2g/internal/pipeline/resume	1.023s	coverage: 38.4% of statements
=== RUN   TestNewStore_RejectsJson
--- PASS: TestNewStore_RejectsJson (0.00s)
=== RUN   TestNewStore_DefaultsToSqlite
--- PASS: TestNewStore_DefaultsToSqlite (0.01s)
=== RUN   TestNewStore_AllowsSqlite
--- PASS: TestNewStore_AllowsSqlite (0.01s)
=== RUN   TestNewStore_RejectsUnknown
--- PASS: TestNewStore_RejectsUnknown (0.00s)
PASS
coverage: 10.7% of statements
ok  	github.com/ManuGH/xg2g/internal/pipeline/scan	1.032s	coverage: 10.7% of statements
=== RUN   TestClient_Fire_Idempotency
--- PASS: TestClient_Fire_Idempotency (0.10s)
=== RUN   TestClient_Fire_TimeoutHelper
--- PASS: TestClient_Fire_TimeoutHelper (0.00s)
PASS
coverage: 80.5% of statements
ok  	github.com/ManuGH/xg2g/internal/pipeline/shadow	1.118s	coverage: 80.5% of statements
=== RUN   TestConfineRelPath
=== RUN   TestConfineRelPath/valid_simple_file
=== RUN   TestConfineRelPath/valid_subdir_file
=== RUN   TestConfineRelPath/traversal_attempt_..
=== RUN   TestConfineRelPath/traversal_attempt_/
=== RUN   TestConfineRelPath/symlink_escape
--- PASS: TestConfineRelPath (0.00s)
    --- PASS: TestConfineRelPath/valid_simple_file (0.00s)
    --- PASS: TestConfineRelPath/valid_subdir_file (0.00s)
    --- PASS: TestConfineRelPath/traversal_attempt_.. (0.00s)
    --- PASS: TestConfineRelPath/traversal_attempt_/ (0.00s)
    --- PASS: TestConfineRelPath/symlink_escape (0.00s)
=== RUN   TestConfineAbsPath
=== RUN   TestConfineAbsPath/valid_absolute_path
=== RUN   TestConfineAbsPath/outside_absolute_path
=== RUN   TestConfineAbsPath/relative_path_input_(error)
--- PASS: TestConfineAbsPath (0.00s)
    --- PASS: TestConfineAbsPath/valid_absolute_path (0.00s)
    --- PASS: TestConfineAbsPath/outside_absolute_path (0.00s)
    --- PASS: TestConfineAbsPath/relative_path_input_(error) (0.00s)
PASS
coverage: 58.6% of statements
ok  	github.com/ManuGH/xg2g/internal/platform/fs	(cached)	coverage: 58.6% of statements
=== RUN   TestValidateOutboundURL
=== RUN   TestValidateOutboundURL/disabled
=== RUN   TestValidateOutboundURL/reject_metadata_ip
=== RUN   TestValidateOutboundURL/reject_loopback_ip
=== RUN   TestValidateOutboundURL/reject_private_ip_not_allowlisted
=== RUN   TestValidateOutboundURL/allow_allowlisted_host+port+scheme
=== RUN   TestValidateOutboundURL/allow_allowlisted_cidr
--- PASS: TestValidateOutboundURL (0.00s)
    --- PASS: TestValidateOutboundURL/disabled (0.00s)
    --- PASS: TestValidateOutboundURL/reject_metadata_ip (0.00s)
    --- PASS: TestValidateOutboundURL/reject_loopback_ip (0.00s)
    --- PASS: TestValidateOutboundURL/reject_private_ip_not_allowlisted (0.00s)
    --- PASS: TestValidateOutboundURL/allow_allowlisted_host+port+scheme (0.00s)
    --- PASS: TestValidateOutboundURL/allow_allowlisted_cidr (0.00s)
=== RUN   TestParseDirectHTTPURL
--- PASS: TestParseDirectHTTPURL (0.00s)
=== RUN   TestNormalizeAuthority
--- PASS: TestNormalizeAuthority (0.00s)
PASS
coverage: 62.0% of statements
ok  	github.com/ManuGH/xg2g/internal/platform/net	(cached)	coverage: 62.0% of statements
=== RUN   TestResolveHLSRoot_Matrix
=== RUN   TestResolveHLSRoot_Matrix/Explicit_New_Env
=== RUN   TestResolveHLSRoot_Matrix/Explicit_Legacy_Env
{"level":"warn","service":"xg2g","version":"","legacy":"/custom/old","time":"2026-02-01T14:53:09+01:00","message":"DEPRECATED: XG2G_V3_HLS_ROOT is set. Please migrate to XG2G_HLS_ROOT."}
=== RUN   TestResolveHLSRoot_Matrix/Both_Env_New_Wins
{"level":"warn","service":"xg2g","version":"","new":"/custom/new","legacy":"/custom/old","time":"2026-02-01T14:53:09+01:00","message":"Both XG2G_HLS_ROOT and XG2G_V3_HLS_ROOT are set; ignoring legacy"}
=== RUN   TestResolveHLSRoot_Matrix/Default_NoDirs
=== RUN   TestResolveHLSRoot_Matrix/Default_TargetExists
=== RUN   TestResolveHLSRoot_Matrix/Default_LegacyExists_NoTarget_Migrates
{"level":"info","service":"xg2g","version":"","from":"/tmp/TestResolveHLSRoot_Matrix1540755751/001/Default_LegacyExists_NoTarget_Migrates/v3-hls","to":"/tmp/TestResolveHLSRoot_Matrix1540755751/001/Default_LegacyExists_NoTarget_Migrates/hls","time":"2026-02-01T14:53:09+01:00","message":"Migration: Renaming legacy HLS root to new location"}
=== RUN   TestResolveHLSRoot_Matrix/Default_LegacySymlink_SkipsMigration
{"level":"warn","service":"xg2g","version":"","legacy":"/tmp/TestResolveHLSRoot_Matrix1540755751/001/Default_LegacySymlink_SkipsMigration/v3-hls","time":"2026-02-01T14:53:09+01:00","message":"Migration: Legacy HLS root is a symlink. Skipping migration and using legacy path."}
=== RUN   TestResolveHLSRoot_Matrix/Default_BothExist_LegacyContent_TargetWins
{"level":"warn","service":"xg2g","version":"","target":"/tmp/TestResolveHLSRoot_Matrix1540755751/001/Default_BothExist_LegacyContent_TargetWins/hls","legacy":"/tmp/TestResolveHLSRoot_Matrix1540755751/001/Default_BothExist_LegacyContent_TargetWins/v3-hls","time":"2026-02-01T14:53:09+01:00","message":"Migration: Using target HLS root, but legacy directory also exists and is not empty. Manual cleanup may be required."}
=== RUN   TestResolveHLSRoot_Matrix/Error_TargetIsFile
--- PASS: TestResolveHLSRoot_Matrix (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Explicit_New_Env (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Explicit_Legacy_Env (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Both_Env_New_Wins (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Default_NoDirs (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Default_TargetExists (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Default_LegacyExists_NoTarget_Migrates (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Default_LegacySymlink_SkipsMigration (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Default_BothExist_LegacyContent_TargetWins (0.00s)
    --- PASS: TestResolveHLSRoot_Matrix/Error_TargetIsFile (0.00s)
=== RUN   TestValidatePlaylistPath
=== RUN   TestValidatePlaylistPath/valid_m3u
=== RUN   TestValidatePlaylistPath/valid_m3u8_in_subdir
=== RUN   TestValidatePlaylistPath/cleaned_dotdot_within_base
=== RUN   TestValidatePlaylistPath/empty
=== RUN   TestValidatePlaylistPath/absolute_path
=== RUN   TestValidatePlaylistPath/traversal
=== RUN   TestValidatePlaylistPath/invalid_extension
=== RUN   TestValidatePlaylistPath/backslash_path
=== RUN   TestValidatePlaylistPath/mixed_case_extension
=== RUN   TestValidatePlaylistPath/dot_path
=== RUN   TestValidatePlaylistPath/escaped_traversal
--- PASS: TestValidatePlaylistPath (0.00s)
    --- PASS: TestValidatePlaylistPath/valid_m3u (0.00s)
    --- PASS: TestValidatePlaylistPath/valid_m3u8_in_subdir (0.00s)
    --- PASS: TestValidatePlaylistPath/cleaned_dotdot_within_base (0.00s)
    --- PASS: TestValidatePlaylistPath/empty (0.00s)
    --- PASS: TestValidatePlaylistPath/absolute_path (0.00s)
    --- PASS: TestValidatePlaylistPath/traversal (0.00s)
    --- PASS: TestValidatePlaylistPath/invalid_extension (0.00s)
    --- PASS: TestValidatePlaylistPath/backslash_path (0.00s)
    --- PASS: TestValidatePlaylistPath/mixed_case_extension (0.00s)
    --- PASS: TestValidatePlaylistPath/dot_path (0.00s)
    --- PASS: TestValidatePlaylistPath/escaped_traversal (0.00s)
=== RUN   TestValidatePlaylistPath_SymlinkEscape
--- PASS: TestValidatePlaylistPath_SymlinkEscape (0.00s)
PASS
coverage: 64.2% of statements
ok  	github.com/ManuGH/xg2g/internal/platform/paths	1.015s	coverage: 64.2% of statements
=== RUN   TestWriteM3UTable
=== RUN   TestWriteM3UTable/basic_with_logo_and_channel_number
=== RUN   TestWriteM3UTable/missing_logo_keeps_stable_tvg-id
--- PASS: TestWriteM3UTable (0.00s)
    --- PASS: TestWriteM3UTable/basic_with_logo_and_channel_number (0.00s)
    --- PASS: TestWriteM3UTable/missing_logo_keeps_stable_tvg-id (0.00s)
=== RUN   FuzzWriteM3U
=== RUN   FuzzWriteM3U/seed#0
=== RUN   FuzzWriteM3U/seed#1
=== RUN   FuzzWriteM3U/seed#2
=== RUN   FuzzWriteM3U/seed#3
--- PASS: FuzzWriteM3U (0.00s)
    --- PASS: FuzzWriteM3U/seed#0 (0.00s)
    --- PASS: FuzzWriteM3U/seed#1 (0.00s)
    --- PASS: FuzzWriteM3U/seed#2 (0.00s)
    --- PASS: FuzzWriteM3U/seed#3 (0.00s)
PASS
coverage: 85.0% of statements
ok  	github.com/ManuGH/xg2g/internal/playlist	(cached)	coverage: 85.0% of statements
=== RUN   TestGroupKill
--- PASS: TestGroupKill (0.00s)
=== RUN   TestKillGroupAlreadyGone
--- PASS: TestKillGroupAlreadyGone (0.00s)
PASS
coverage: 48.3% of statements
ok  	github.com/ManuGH/xg2g/internal/procgroup	1.014s	coverage: 48.3% of statements
=== RUN   TestClassifyLibrary_HappyPath
=== RUN   TestClassifyLibrary_HappyPath/stable_+_valid_→_finished
=== RUN   TestClassifyLibrary_HappyPath/unstable_(<_30s)_→_recording
=== RUN   TestClassifyLibrary_HappyPath/too_small_(<_1MB)_→_recording
=== RUN   TestClassifyLibrary_HappyPath/wrong_extension_→_recording
=== RUN   TestClassifyLibrary_HappyPath/valid_.mkv_→_finished
=== RUN   TestClassifyLibrary_HappyPath/valid_.mp4_→_finished
--- PASS: TestClassifyLibrary_HappyPath (0.00s)
    --- PASS: TestClassifyLibrary_HappyPath/stable_+_valid_→_finished (0.00s)
    --- PASS: TestClassifyLibrary_HappyPath/unstable_(<_30s)_→_recording (0.00s)
    --- PASS: TestClassifyLibrary_HappyPath/too_small_(<_1MB)_→_recording (0.00s)
    --- PASS: TestClassifyLibrary_HappyPath/wrong_extension_→_recording (0.00s)
    --- PASS: TestClassifyLibrary_HappyPath/valid_.mkv_→_finished (0.00s)
    --- PASS: TestClassifyLibrary_HappyPath/valid_.mp4_→_finished (0.00s)
=== RUN   TestClassifyLibrary_LockMarkers
=== RUN   TestClassifyLibrary_LockMarkers/.partial_suffix_→_recording
=== RUN   TestClassifyLibrary_LockMarkers/.lock_suffix_→_recording
=== RUN   TestClassifyLibrary_LockMarkers/.tmp_suffix_→_recording
--- PASS: TestClassifyLibrary_LockMarkers (0.00s)
    --- PASS: TestClassifyLibrary_LockMarkers/.partial_suffix_→_recording (0.00s)
    --- PASS: TestClassifyLibrary_LockMarkers/.lock_suffix_→_recording (0.00s)
    --- PASS: TestClassifyLibrary_LockMarkers/.tmp_suffix_→_recording (0.00s)
=== RUN   TestClassifyLibrary_SiblingLock
--- PASS: TestClassifyLibrary_SiblingLock (0.01s)
=== RUN   TestClassifyLibrary_EdgeCases
=== RUN   TestClassifyLibrary_EdgeCases/exactly_30s_old_→_finished
=== RUN   TestClassifyLibrary_EdgeCases/exactly_1MB_→_finished
=== RUN   TestClassifyLibrary_EdgeCases/uppercase_extension_→_finished
=== RUN   TestClassifyLibrary_EdgeCases/mixed_case_.MkV_→_finished
--- PASS: TestClassifyLibrary_EdgeCases (0.00s)
    --- PASS: TestClassifyLibrary_EdgeCases/exactly_30s_old_→_finished (0.00s)
    --- PASS: TestClassifyLibrary_EdgeCases/exactly_1MB_→_finished (0.00s)
    --- PASS: TestClassifyLibrary_EdgeCases/uppercase_extension_→_finished (0.00s)
    --- PASS: TestClassifyLibrary_EdgeCases/mixed_case_.MkV_→_finished (0.00s)
=== RUN   TestPathMapper_ResolveLocalExisting
=== RUN   TestPathMapper_ResolveLocalExisting/Happy_Path_Existing_File
=== RUN   TestPathMapper_ResolveLocalExisting/Non-Existent_File
=== RUN   TestPathMapper_ResolveLocalExisting/Traversal_Attempt
=== RUN   TestPathMapper_ResolveLocalExisting/Symlink_Escape_(Direct)
=== RUN   TestPathMapper_ResolveLocalExisting/Valid_Symlink
=== RUN   TestPathMapper_ResolveLocalExisting/Prefix_Confusion
--- PASS: TestPathMapper_ResolveLocalExisting (0.00s)
    --- PASS: TestPathMapper_ResolveLocalExisting/Happy_Path_Existing_File (0.00s)
    --- PASS: TestPathMapper_ResolveLocalExisting/Non-Existent_File (0.00s)
    --- PASS: TestPathMapper_ResolveLocalExisting/Traversal_Attempt (0.00s)
    --- PASS: TestPathMapper_ResolveLocalExisting/Symlink_Escape_(Direct) (0.00s)
    --- PASS: TestPathMapper_ResolveLocalExisting/Valid_Symlink (0.00s)
    --- PASS: TestPathMapper_ResolveLocalExisting/Prefix_Confusion (0.00s)
=== RUN   TestPathMapper_ResolveLocalUnsafe_Success
=== RUN   TestPathMapper_ResolveLocalUnsafe_Success/simple_file_mapping
=== RUN   TestPathMapper_ResolveLocalUnsafe_Success/nested_file_mapping
=== RUN   TestPathMapper_ResolveLocalUnsafe_Success/exact_root_match
--- PASS: TestPathMapper_ResolveLocalUnsafe_Success (0.00s)
    --- PASS: TestPathMapper_ResolveLocalUnsafe_Success/simple_file_mapping (0.00s)
    --- PASS: TestPathMapper_ResolveLocalUnsafe_Success/nested_file_mapping (0.00s)
    --- PASS: TestPathMapper_ResolveLocalUnsafe_Success/exact_root_match (0.00s)
=== RUN   TestPathMapper_LongestPrefixWins
=== RUN   TestPathMapper_LongestPrefixWins/movie2_path_should_match_movie2_mapping
=== RUN   TestPathMapper_LongestPrefixWins/movie_path_should_match_movie_mapping
--- PASS: TestPathMapper_LongestPrefixWins (0.00s)
    --- PASS: TestPathMapper_LongestPrefixWins/movie2_path_should_match_movie2_mapping (0.00s)
    --- PASS: TestPathMapper_LongestPrefixWins/movie_path_should_match_movie_mapping (0.00s)
=== RUN   TestPathMapper_TraversalBlocked
=== RUN   TestPathMapper_TraversalBlocked/parent_directory_traversal
=== RUN   TestPathMapper_TraversalBlocked/traversal_with_dots
=== RUN   TestPathMapper_TraversalBlocked/relative_path_with_traversal
--- PASS: TestPathMapper_TraversalBlocked (0.00s)
    --- PASS: TestPathMapper_TraversalBlocked/parent_directory_traversal (0.00s)
    --- PASS: TestPathMapper_TraversalBlocked/traversal_with_dots (0.00s)
    --- PASS: TestPathMapper_TraversalBlocked/relative_path_with_traversal (0.00s)
=== RUN   TestPathMapper_NonAbsolutePathBlocked
=== RUN   TestPathMapper_NonAbsolutePathBlocked/relative_path
=== RUN   TestPathMapper_NonAbsolutePathBlocked/current_directory
=== RUN   TestPathMapper_NonAbsolutePathBlocked/empty_path
--- PASS: TestPathMapper_NonAbsolutePathBlocked (0.00s)
    --- PASS: TestPathMapper_NonAbsolutePathBlocked/relative_path (0.00s)
    --- PASS: TestPathMapper_NonAbsolutePathBlocked/current_directory (0.00s)
    --- PASS: TestPathMapper_NonAbsolutePathBlocked/empty_path (0.00s)
=== RUN   TestPathMapper_PathNormalization
=== RUN   TestPathMapper_PathNormalization/double_slashes_normalized
=== RUN   TestPathMapper_PathNormalization/dot_segments_normalized
=== RUN   TestPathMapper_PathNormalization/complex_normalization
--- PASS: TestPathMapper_PathNormalization (0.00s)
    --- PASS: TestPathMapper_PathNormalization/double_slashes_normalized (0.00s)
    --- PASS: TestPathMapper_PathNormalization/dot_segments_normalized (0.00s)
    --- PASS: TestPathMapper_PathNormalization/complex_normalization (0.00s)
=== RUN   TestPathMapper_NoMapping
=== RUN   TestPathMapper_NoMapping/unmapped_path
=== RUN   TestPathMapper_NoMapping/different_root
=== RUN   TestPathMapper_NoMapping/root_only
--- PASS: TestPathMapper_NoMapping (0.00s)
    --- PASS: TestPathMapper_NoMapping/unmapped_path (0.00s)
    --- PASS: TestPathMapper_NoMapping/different_root (0.00s)
    --- PASS: TestPathMapper_NoMapping/root_only (0.00s)
=== RUN   TestPathMapper_InvalidMappingsSkipped
--- PASS: TestPathMapper_InvalidMappingsSkipped (0.00s)
=== RUN   TestPathMapper_EmptyMappings
--- PASS: TestPathMapper_EmptyMappings (0.00s)
=== RUN   TestIsStable_StableFile
--- PASS: TestIsStable_StableFile (0.10s)
=== RUN   TestIsStable_WritingFile
--- PASS: TestIsStable_WritingFile (0.10s)
=== RUN   TestIsStable_NonExistentFile
--- PASS: TestIsStable_NonExistentFile (0.00s)
=== RUN   TestIsStable_FileDeletedDuringCheck
--- PASS: TestIsStable_FileDeletedDuringCheck (0.10s)
=== RUN   TestIsStable_ZeroWindow
--- PASS: TestIsStable_ZeroWindow (0.00s)
=== RUN   TestIsStable_LargeWindow
--- PASS: TestIsStable_LargeWindow (0.50s)
=== RUN   TestIsStable_EmptyFile
--- PASS: TestIsStable_EmptyFile (0.10s)
=== RUN   TestIsStable_ContextCancelled
--- PASS: TestIsStable_ContextCancelled (0.05s)
=== RUN   TestIsStable_LegacyWrapper
--- PASS: TestIsStable_LegacyWrapper (0.10s)
PASS
coverage: 88.6% of statements
ok  	github.com/ManuGH/xg2g/internal/recordings	2.082s	coverage: 88.6% of statements
=== RUN   TestCircuitBreaker_SlidingWindowPruning
--- PASS: TestCircuitBreaker_SlidingWindowPruning (0.00s)
=== RUN   TestCircuitBreaker_TechnicalFailureTrigger
--- PASS: TestCircuitBreaker_TechnicalFailureTrigger (0.00s)
=== RUN   TestCircuitBreaker_Exclusions
--- PASS: TestCircuitBreaker_Exclusions (0.00s)
=== RUN   TestCircuitBreaker_HalfOpenBehavior
--- PASS: TestCircuitBreaker_HalfOpenBehavior (0.00s)
=== RUN   TestCircuitBreaker_BoundedMemory
--- PASS: TestCircuitBreaker_BoundedMemory (0.01s)
=== RUN   TestVODBreaker_StateTransitions
{"level":"error","service":"xg2g","version":"","breaker":"test_root","reason":"consecutive_failures","time":"2026-02-01T14:53:10+01:00","message":"circuit breaker TRIPPED (OPEN)"}
{"level":"info","service":"xg2g","version":"","breaker":"test_root","time":"2026-02-01T14:53:10+01:00","message":"circuit breaker entering HALF-OPEN state"}
{"level":"warn","service":"xg2g","version":"","breaker":"test_root","time":"2026-02-01T14:53:10+01:00","message":"circuit breaker RE-OPENED (probe failed)"}
{"level":"info","service":"xg2g","version":"","breaker":"test_root","time":"2026-02-01T14:53:10+01:00","message":"circuit breaker entering HALF-OPEN state"}
{"level":"info","service":"xg2g","version":"","breaker":"test_root","time":"2026-02-01T14:53:10+01:00","message":"circuit breaker CLOSED (probe succeeded)"}
--- PASS: TestVODBreaker_StateTransitions (0.30s)
=== RUN   TestVODBreaker_FailureRate
{"level":"error","service":"xg2g","version":"","breaker":"test_rate","reason":"failure_rate","time":"2026-02-01T14:53:10+01:00","message":"circuit breaker TRIPPED (OPEN)"}
--- PASS: TestVODBreaker_FailureRate (0.00s)
PASS
coverage: 77.9% of statements
ok  	github.com/ManuGH/xg2g/internal/resilience	1.327s	coverage: 77.9% of statements
=== RUN   TestHTTPAttributes
--- PASS: TestHTTPAttributes (0.00s)
=== RUN   TestStreamAttributes
=== RUN   TestStreamAttributes/all_fields
=== RUN   TestStreamAttributes/only_channel
=== RUN   TestStreamAttributes/empty_fields
--- PASS: TestStreamAttributes (0.00s)
    --- PASS: TestStreamAttributes/all_fields (0.00s)
    --- PASS: TestStreamAttributes/only_channel (0.00s)
    --- PASS: TestStreamAttributes/empty_fields (0.00s)
=== RUN   TestTranscodeAttributes
--- PASS: TestTranscodeAttributes (0.00s)
=== RUN   TestEPGAttributes
--- PASS: TestEPGAttributes (0.00s)
=== RUN   TestJobAttributes
--- PASS: TestJobAttributes (0.00s)
=== RUN   TestErrorAttributes
--- PASS: TestErrorAttributes (0.00s)
=== RUN   TestAttributeKeys_Consistency
--- PASS: TestAttributeKeys_Consistency (0.00s)
=== RUN   TestNewProvider_Disabled
--- PASS: TestNewProvider_Disabled (0.00s)
=== RUN   TestNewProvider_InvalidExporter
--- PASS: TestNewProvider_InvalidExporter (0.00s)
=== RUN   TestNewProvider_SamplingRates
=== RUN   TestNewProvider_SamplingRates/always_sample
=== RUN   TestNewProvider_SamplingRates/never_sample
=== RUN   TestNewProvider_SamplingRates/ratio_sample
--- PASS: TestNewProvider_SamplingRates (0.00s)
    --- PASS: TestNewProvider_SamplingRates/always_sample (0.00s)
    --- PASS: TestNewProvider_SamplingRates/never_sample (0.00s)
    --- PASS: TestNewProvider_SamplingRates/ratio_sample (0.00s)
=== RUN   TestProvider_Shutdown
--- PASS: TestProvider_Shutdown (0.00s)
=== RUN   TestProvider_ShutdownTimeout
--- PASS: TestProvider_ShutdownTimeout (0.00s)
=== RUN   TestTracer
--- PASS: TestTracer (0.00s)
=== RUN   TestConfig_DefaultValues
--- PASS: TestConfig_DefaultValues (0.00s)
=== RUN   TestProvider_ConcurrentShutdown
--- PASS: TestProvider_ConcurrentShutdown (0.00s)
PASS
coverage: 55.8% of statements
ok  	github.com/ManuGH/xg2g/internal/telemetry	(cached)	coverage: 55.8% of statements
=== RUN   TestGenerateSelfSigned
--- PASS: TestGenerateSelfSigned (0.00s)
=== RUN   TestEnsureCertificates_Generate
--- PASS: TestEnsureCertificates_Generate (0.00s)
=== RUN   TestEnsureCertificates_Existing
--- PASS: TestEnsureCertificates_Existing (0.00s)
=== RUN   TestEnsureCertificates_IncompleteRegenerate
--- PASS: TestEnsureCertificates_IncompleteRegenerate (0.00s)
=== RUN   TestEnsureCertificates_DefaultPaths
--- PASS: TestEnsureCertificates_DefaultPaths (0.00s)
=== RUN   TestGetNetworkIPs
    network_test.go:44: Found network IP: 10.10.55.14
    network_test.go:44: Found network IP: fdd0:a67d:6956:4fb5:be24:11ff:fe9b:1a8c
    network_test.go:44: Found network IP: 172.18.0.1
    network_test.go:44: Found network IP: 172.17.0.1
--- PASS: TestGetNetworkIPs (0.00s)
=== RUN   TestGenerateSelfSignedWithIPs
--- PASS: TestGenerateSelfSignedWithIPs (0.00s)
=== RUN   TestGenerateSelfSignedWithIPs_Deduplication
--- PASS: TestGenerateSelfSignedWithIPs_Deduplication (0.00s)
PASS
coverage: 80.6% of statements
ok  	github.com/ManuGH/xg2g/internal/tls	(cached)	coverage: 80.6% of statements
=== RUN   TestFeatureFlag_String
=== RUN   TestFeatureFlag_String/audio_transcoding
=== RUN   TestFeatureFlag_String/GPU_transcode
=== RUN   TestFeatureFlag_String/EPG
=== RUN   TestFeatureFlag_String/telemetry
=== RUN   TestFeatureFlag_String/metrics
--- PASS: TestFeatureFlag_String (0.00s)
    --- PASS: TestFeatureFlag_String/audio_transcoding (0.00s)
    --- PASS: TestFeatureFlag_String/GPU_transcode (0.00s)
    --- PASS: TestFeatureFlag_String/EPG (0.00s)
    --- PASS: TestFeatureFlag_String/telemetry (0.00s)
    --- PASS: TestFeatureFlag_String/metrics (0.00s)
=== RUN   TestFeatureFlag_EnvVarName
=== RUN   TestFeatureFlag_EnvVarName/audio_transcoding
=== RUN   TestFeatureFlag_EnvVarName/GPU_transcode
=== RUN   TestFeatureFlag_EnvVarName/EPG
=== RUN   TestFeatureFlag_EnvVarName/telemetry
=== RUN   TestFeatureFlag_EnvVarName/metrics
--- PASS: TestFeatureFlag_EnvVarName (0.00s)
    --- PASS: TestFeatureFlag_EnvVarName/audio_transcoding (0.00s)
    --- PASS: TestFeatureFlag_EnvVarName/GPU_transcode (0.00s)
    --- PASS: TestFeatureFlag_EnvVarName/EPG (0.00s)
    --- PASS: TestFeatureFlag_EnvVarName/telemetry (0.00s)
    --- PASS: TestFeatureFlag_EnvVarName/metrics (0.00s)
=== RUN   TestFeatureFlag_IsValid
=== RUN   TestFeatureFlag_IsValid/audio_transcoding_valid
=== RUN   TestFeatureFlag_IsValid/GPU_transcode_valid
=== RUN   TestFeatureFlag_IsValid/EPG_valid
=== RUN   TestFeatureFlag_IsValid/telemetry_valid
=== RUN   TestFeatureFlag_IsValid/metrics_valid
=== RUN   TestFeatureFlag_IsValid/invalid_empty
=== RUN   TestFeatureFlag_IsValid/invalid_unknown
=== RUN   TestFeatureFlag_IsValid/invalid_lowercase
--- PASS: TestFeatureFlag_IsValid (0.00s)
    --- PASS: TestFeatureFlag_IsValid/audio_transcoding_valid (0.00s)
    --- PASS: TestFeatureFlag_IsValid/GPU_transcode_valid (0.00s)
    --- PASS: TestFeatureFlag_IsValid/EPG_valid (0.00s)
    --- PASS: TestFeatureFlag_IsValid/telemetry_valid (0.00s)
    --- PASS: TestFeatureFlag_IsValid/metrics_valid (0.00s)
    --- PASS: TestFeatureFlag_IsValid/invalid_empty (0.00s)
    --- PASS: TestFeatureFlag_IsValid/invalid_unknown (0.00s)
    --- PASS: TestFeatureFlag_IsValid/invalid_lowercase (0.00s)
=== RUN   TestAllFeatureFlags
--- PASS: TestAllFeatureFlags (0.00s)
=== RUN   TestJobStatus_String
=== RUN   TestJobStatus_String/pending
=== RUN   TestJobStatus_String/running
=== RUN   TestJobStatus_String/completed
=== RUN   TestJobStatus_String/failed
=== RUN   TestJobStatus_String/cancelled
--- PASS: TestJobStatus_String (0.00s)
    --- PASS: TestJobStatus_String/pending (0.00s)
    --- PASS: TestJobStatus_String/running (0.00s)
    --- PASS: TestJobStatus_String/completed (0.00s)
    --- PASS: TestJobStatus_String/failed (0.00s)
    --- PASS: TestJobStatus_String/cancelled (0.00s)
=== RUN   TestJobStatus_IsValid
=== RUN   TestJobStatus_IsValid/pending_valid
=== RUN   TestJobStatus_IsValid/running_valid
=== RUN   TestJobStatus_IsValid/completed_valid
=== RUN   TestJobStatus_IsValid/failed_valid
=== RUN   TestJobStatus_IsValid/cancelled_valid
=== RUN   TestJobStatus_IsValid/invalid_empty
=== RUN   TestJobStatus_IsValid/invalid_unknown
=== RUN   TestJobStatus_IsValid/invalid_typo
--- PASS: TestJobStatus_IsValid (0.00s)
    --- PASS: TestJobStatus_IsValid/pending_valid (0.00s)
    --- PASS: TestJobStatus_IsValid/running_valid (0.00s)
    --- PASS: TestJobStatus_IsValid/completed_valid (0.00s)
    --- PASS: TestJobStatus_IsValid/failed_valid (0.00s)
    --- PASS: TestJobStatus_IsValid/cancelled_valid (0.00s)
    --- PASS: TestJobStatus_IsValid/invalid_empty (0.00s)
    --- PASS: TestJobStatus_IsValid/invalid_unknown (0.00s)
    --- PASS: TestJobStatus_IsValid/invalid_typo (0.00s)
=== RUN   TestJobStatus_IsTerminal
=== RUN   TestJobStatus_IsTerminal/pending_not_terminal
=== RUN   TestJobStatus_IsTerminal/running_not_terminal
=== RUN   TestJobStatus_IsTerminal/completed_terminal
=== RUN   TestJobStatus_IsTerminal/failed_terminal
=== RUN   TestJobStatus_IsTerminal/cancelled_terminal
--- PASS: TestJobStatus_IsTerminal (0.00s)
    --- PASS: TestJobStatus_IsTerminal/pending_not_terminal (0.00s)
    --- PASS: TestJobStatus_IsTerminal/running_not_terminal (0.00s)
    --- PASS: TestJobStatus_IsTerminal/completed_terminal (0.00s)
    --- PASS: TestJobStatus_IsTerminal/failed_terminal (0.00s)
    --- PASS: TestJobStatus_IsTerminal/cancelled_terminal (0.00s)
=== RUN   TestJobStatus_CanTransitionTo
=== RUN   TestJobStatus_CanTransitionTo/pending_to_running
=== RUN   TestJobStatus_CanTransitionTo/pending_to_cancelled
=== RUN   TestJobStatus_CanTransitionTo/pending_to_completed
=== RUN   TestJobStatus_CanTransitionTo/pending_to_failed
=== RUN   TestJobStatus_CanTransitionTo/running_to_completed
=== RUN   TestJobStatus_CanTransitionTo/running_to_failed
=== RUN   TestJobStatus_CanTransitionTo/running_to_cancelled
=== RUN   TestJobStatus_CanTransitionTo/running_to_pending
=== RUN   TestJobStatus_CanTransitionTo/completed_to_running
=== RUN   TestJobStatus_CanTransitionTo/failed_to_running
=== RUN   TestJobStatus_CanTransitionTo/cancelled_to_running
--- PASS: TestJobStatus_CanTransitionTo (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/pending_to_running (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/pending_to_cancelled (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/pending_to_completed (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/pending_to_failed (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/running_to_completed (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/running_to_failed (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/running_to_cancelled (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/running_to_pending (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/completed_to_running (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/failed_to_running (0.00s)
    --- PASS: TestJobStatus_CanTransitionTo/cancelled_to_running (0.00s)
=== RUN   TestJobStatus_MarshalJSON
=== RUN   TestJobStatus_MarshalJSON/pending
=== RUN   TestJobStatus_MarshalJSON/running
=== RUN   TestJobStatus_MarshalJSON/completed
=== RUN   TestJobStatus_MarshalJSON/failed
=== RUN   TestJobStatus_MarshalJSON/cancelled
--- PASS: TestJobStatus_MarshalJSON (0.00s)
    --- PASS: TestJobStatus_MarshalJSON/pending (0.00s)
    --- PASS: TestJobStatus_MarshalJSON/running (0.00s)
    --- PASS: TestJobStatus_MarshalJSON/completed (0.00s)
    --- PASS: TestJobStatus_MarshalJSON/failed (0.00s)
    --- PASS: TestJobStatus_MarshalJSON/cancelled (0.00s)
=== RUN   TestJobStatus_UnmarshalJSON
=== RUN   TestJobStatus_UnmarshalJSON/pending
=== RUN   TestJobStatus_UnmarshalJSON/running
=== RUN   TestJobStatus_UnmarshalJSON/completed
=== RUN   TestJobStatus_UnmarshalJSON/failed
=== RUN   TestJobStatus_UnmarshalJSON/cancelled
=== RUN   TestJobStatus_UnmarshalJSON/invalid
=== RUN   TestJobStatus_UnmarshalJSON/malformed
--- PASS: TestJobStatus_UnmarshalJSON (0.00s)
    --- PASS: TestJobStatus_UnmarshalJSON/pending (0.00s)
    --- PASS: TestJobStatus_UnmarshalJSON/running (0.00s)
    --- PASS: TestJobStatus_UnmarshalJSON/completed (0.00s)
    --- PASS: TestJobStatus_UnmarshalJSON/failed (0.00s)
    --- PASS: TestJobStatus_UnmarshalJSON/cancelled (0.00s)
    --- PASS: TestJobStatus_UnmarshalJSON/invalid (0.00s)
    --- PASS: TestJobStatus_UnmarshalJSON/malformed (0.00s)
=== RUN   TestParseJobStatus
=== RUN   TestParseJobStatus/pending
=== RUN   TestParseJobStatus/running
=== RUN   TestParseJobStatus/completed
=== RUN   TestParseJobStatus/failed
=== RUN   TestParseJobStatus/cancelled
=== RUN   TestParseJobStatus/invalid_empty
=== RUN   TestParseJobStatus/invalid_unknown
=== RUN   TestParseJobStatus/invalid_typo
--- PASS: TestParseJobStatus (0.00s)
    --- PASS: TestParseJobStatus/pending (0.00s)
    --- PASS: TestParseJobStatus/running (0.00s)
    --- PASS: TestParseJobStatus/completed (0.00s)
    --- PASS: TestParseJobStatus/failed (0.00s)
    --- PASS: TestParseJobStatus/cancelled (0.00s)
    --- PASS: TestParseJobStatus/invalid_empty (0.00s)
    --- PASS: TestParseJobStatus/invalid_unknown (0.00s)
    --- PASS: TestParseJobStatus/invalid_typo (0.00s)
=== RUN   TestAllJobStatuses
--- PASS: TestAllJobStatuses (0.00s)
=== RUN   TestJobStatus_JSONRoundTrip
--- PASS: TestJobStatus_JSONRoundTrip (0.00s)
PASS
coverage: 59.3% of statements
ok  	github.com/ManuGH/xg2g/internal/types	(cached)	coverage: 59.3% of statements
=== RUN   TestContractDriftGate
--- PASS: TestContractDriftGate (0.01s)
=== RUN   TestLayeringRules
--- PASS: TestLayeringRules (0.05s)
=== RUN   TestDeprecatedPackages
--- PASS: TestDeprecatedPackages (0.00s)
=== RUN   TestNoUtilsPackages
--- PASS: TestNoUtilsPackages (0.00s)
=== RUN   TestValidator_URL
=== RUN   TestValidator_URL/valid_http
=== RUN   TestValidator_URL/valid_https
=== RUN   TestValidator_URL/empty_url
=== RUN   TestValidator_URL/no_host
=== RUN   TestValidator_URL/invalid_scheme
=== RUN   TestValidator_URL/no_scheme
=== RUN   TestValidator_URL/with_port
=== RUN   TestValidator_URL/with_path
--- PASS: TestValidator_URL (0.00s)
    --- PASS: TestValidator_URL/valid_http (0.00s)
    --- PASS: TestValidator_URL/valid_https (0.00s)
    --- PASS: TestValidator_URL/empty_url (0.00s)
    --- PASS: TestValidator_URL/no_host (0.00s)
    --- PASS: TestValidator_URL/invalid_scheme (0.00s)
    --- PASS: TestValidator_URL/no_scheme (0.00s)
    --- PASS: TestValidator_URL/with_port (0.00s)
    --- PASS: TestValidator_URL/with_path (0.00s)
=== RUN   TestValidator_Port
=== RUN   TestValidator_Port/valid_port_80
=== RUN   TestValidator_Port/valid_port_8080
=== RUN   TestValidator_Port/valid_port_65535
=== RUN   TestValidator_Port/valid_port_1
=== RUN   TestValidator_Port/invalid_port_0
=== RUN   TestValidator_Port/invalid_port_-1
=== RUN   TestValidator_Port/invalid_port_65536
=== RUN   TestValidator_Port/invalid_port_100000
--- PASS: TestValidator_Port (0.00s)
    --- PASS: TestValidator_Port/valid_port_80 (0.00s)
    --- PASS: TestValidator_Port/valid_port_8080 (0.00s)
    --- PASS: TestValidator_Port/valid_port_65535 (0.00s)
    --- PASS: TestValidator_Port/valid_port_1 (0.00s)
    --- PASS: TestValidator_Port/invalid_port_0 (0.00s)
    --- PASS: TestValidator_Port/invalid_port_-1 (0.00s)
    --- PASS: TestValidator_Port/invalid_port_65536 (0.00s)
    --- PASS: TestValidator_Port/invalid_port_100000 (0.00s)
=== RUN   TestValidator_Range
=== RUN   TestValidator_Range/in_range
=== RUN   TestValidator_Range/at_min
=== RUN   TestValidator_Range/at_max
=== RUN   TestValidator_Range/below_min
=== RUN   TestValidator_Range/above_max
=== RUN   TestValidator_Range/negative_range
--- PASS: TestValidator_Range (0.00s)
    --- PASS: TestValidator_Range/in_range (0.00s)
    --- PASS: TestValidator_Range/at_min (0.00s)
    --- PASS: TestValidator_Range/at_max (0.00s)
    --- PASS: TestValidator_Range/below_min (0.00s)
    --- PASS: TestValidator_Range/above_max (0.00s)
    --- PASS: TestValidator_Range/negative_range (0.00s)
=== RUN   TestValidator_Directory
=== RUN   TestValidator_Directory/existing_dir
=== RUN   TestValidator_Directory/existing_dir_no_mustExist
=== RUN   TestValidator_Directory/nonexistent_mustExist
=== RUN   TestValidator_Directory/nonexistent_create
=== RUN   TestValidator_Directory/empty_path
=== RUN   TestValidator_Directory/path_traversal
--- PASS: TestValidator_Directory (0.00s)
    --- PASS: TestValidator_Directory/existing_dir (0.00s)
    --- PASS: TestValidator_Directory/existing_dir_no_mustExist (0.00s)
    --- PASS: TestValidator_Directory/nonexistent_mustExist (0.00s)
    --- PASS: TestValidator_Directory/nonexistent_create (0.00s)
    --- PASS: TestValidator_Directory/empty_path (0.00s)
    --- PASS: TestValidator_Directory/path_traversal (0.00s)
=== RUN   TestValidator_NotEmpty
=== RUN   TestValidator_NotEmpty/non-empty
=== RUN   TestValidator_NotEmpty/empty
=== RUN   TestValidator_NotEmpty/whitespace_only
=== RUN   TestValidator_NotEmpty/tab_only
=== RUN   TestValidator_NotEmpty/newline_only
--- PASS: TestValidator_NotEmpty (0.00s)
    --- PASS: TestValidator_NotEmpty/non-empty (0.00s)
    --- PASS: TestValidator_NotEmpty/empty (0.00s)
    --- PASS: TestValidator_NotEmpty/whitespace_only (0.00s)
    --- PASS: TestValidator_NotEmpty/tab_only (0.00s)
    --- PASS: TestValidator_NotEmpty/newline_only (0.00s)
=== RUN   TestValidator_OneOf
=== RUN   TestValidator_OneOf/valid_red
=== RUN   TestValidator_OneOf/valid_green
=== RUN   TestValidator_OneOf/valid_blue
=== RUN   TestValidator_OneOf/invalid_yellow
=== RUN   TestValidator_OneOf/invalid_empty
--- PASS: TestValidator_OneOf (0.00s)
    --- PASS: TestValidator_OneOf/valid_red (0.00s)
    --- PASS: TestValidator_OneOf/valid_green (0.00s)
    --- PASS: TestValidator_OneOf/valid_blue (0.00s)
    --- PASS: TestValidator_OneOf/invalid_yellow (0.00s)
    --- PASS: TestValidator_OneOf/invalid_empty (0.00s)
=== RUN   TestValidator_Positive
=== RUN   TestValidator_Positive/positive_1
=== RUN   TestValidator_Positive/positive_100
=== RUN   TestValidator_Positive/zero
=== RUN   TestValidator_Positive/negative
--- PASS: TestValidator_Positive (0.00s)
    --- PASS: TestValidator_Positive/positive_1 (0.00s)
    --- PASS: TestValidator_Positive/positive_100 (0.00s)
    --- PASS: TestValidator_Positive/zero (0.00s)
    --- PASS: TestValidator_Positive/negative (0.00s)
=== RUN   TestValidator_NonNegative
=== RUN   TestValidator_NonNegative/positive_1
=== RUN   TestValidator_NonNegative/zero
=== RUN   TestValidator_NonNegative/negative
--- PASS: TestValidator_NonNegative (0.00s)
    --- PASS: TestValidator_NonNegative/positive_1 (0.00s)
    --- PASS: TestValidator_NonNegative/zero (0.00s)
    --- PASS: TestValidator_NonNegative/negative (0.00s)
=== RUN   TestValidator_Custom
=== RUN   TestValidator_Custom/passes_custom_validation
=== RUN   TestValidator_Custom/fails_custom_validation
--- PASS: TestValidator_Custom (0.00s)
    --- PASS: TestValidator_Custom/passes_custom_validation (0.00s)
    --- PASS: TestValidator_Custom/fails_custom_validation (0.00s)
=== RUN   TestValidator_MultipleErrors
--- PASS: TestValidator_MultipleErrors (0.00s)
=== RUN   TestValidator_Chaining
--- PASS: TestValidator_Chaining (0.00s)
=== RUN   TestValidator_DirectoryCreation
--- PASS: TestValidator_DirectoryCreation (0.00s)
=== RUN   TestLogLevel_IsValid
=== RUN   TestLogLevel_IsValid/debug
=== RUN   TestLogLevel_IsValid/info
=== RUN   TestLogLevel_IsValid/warn
=== RUN   TestLogLevel_IsValid/error
=== RUN   TestLogLevel_IsValid/invalid
=== RUN   TestLogLevel_IsValid/#00
--- PASS: TestLogLevel_IsValid (0.00s)
    --- PASS: TestLogLevel_IsValid/debug (0.00s)
    --- PASS: TestLogLevel_IsValid/info (0.00s)
    --- PASS: TestLogLevel_IsValid/warn (0.00s)
    --- PASS: TestLogLevel_IsValid/error (0.00s)
    --- PASS: TestLogLevel_IsValid/invalid (0.00s)
    --- PASS: TestLogLevel_IsValid/#00 (0.00s)
=== RUN   TestParseLogLevel
=== RUN   TestParseLogLevel/debug
=== RUN   TestParseLogLevel/info
=== RUN   TestParseLogLevel/warn
=== RUN   TestParseLogLevel/error
=== RUN   TestParseLogLevel/invalid
=== RUN   TestParseLogLevel/#00
--- PASS: TestParseLogLevel (0.00s)
    --- PASS: TestParseLogLevel/debug (0.00s)
    --- PASS: TestParseLogLevel/info (0.00s)
    --- PASS: TestParseLogLevel/warn (0.00s)
    --- PASS: TestParseLogLevel/error (0.00s)
    --- PASS: TestParseLogLevel/invalid (0.00s)
    --- PASS: TestParseLogLevel/#00 (0.00s)
=== RUN   TestValidatePath_Security
=== RUN   TestValidatePath_Security/valid_relative_path
=== RUN   TestValidatePath_Security/valid_subdirectory
=== RUN   TestValidatePath_Security/empty_path_allowed
=== RUN   TestValidatePath_Security/absolute_path
=== RUN   TestValidatePath_Security/traversal_with_dotdot
=== RUN   TestValidatePath_Security/traversal_encoded
=== RUN   TestValidatePath_Security/windows-style_traversal
=== RUN   TestValidatePath_Security/hidden_traversal_in_subdirectory
--- PASS: TestValidatePath_Security (0.00s)
    --- PASS: TestValidatePath_Security/valid_relative_path (0.00s)
    --- PASS: TestValidatePath_Security/valid_subdirectory (0.00s)
    --- PASS: TestValidatePath_Security/empty_path_allowed (0.00s)
    --- PASS: TestValidatePath_Security/absolute_path (0.00s)
    --- PASS: TestValidatePath_Security/traversal_with_dotdot (0.00s)
    --- PASS: TestValidatePath_Security/traversal_encoded (0.00s)
    --- PASS: TestValidatePath_Security/windows-style_traversal (0.00s)
    --- PASS: TestValidatePath_Security/hidden_traversal_in_subdirectory (0.00s)
=== RUN   TestValidatePath_Integration
--- PASS: TestValidatePath_Integration (0.00s)
=== RUN   TestPathWithinRoot_Security
=== RUN   TestPathWithinRoot_Security/valid_file_within_root
=== RUN   TestPathWithinRoot_Security/absolute_path_rejected
=== RUN   TestPathWithinRoot_Security/traversal_attack
=== RUN   TestPathWithinRoot_Security/symlink_escape_attempt
=== RUN   TestPathWithinRoot_Security/nonexistent_file_is_okay
--- PASS: TestPathWithinRoot_Security (0.00s)
    --- PASS: TestPathWithinRoot_Security/valid_file_within_root (0.00s)
    --- PASS: TestPathWithinRoot_Security/absolute_path_rejected (0.00s)
    --- PASS: TestPathWithinRoot_Security/traversal_attack (0.00s)
    --- PASS: TestPathWithinRoot_Security/symlink_escape_attempt (0.00s)
    --- PASS: TestPathWithinRoot_Security/nonexistent_file_is_okay (0.00s)
=== RUN   TestValidator_StreamURL
=== RUN   TestValidator_StreamURL/valid_http_stream_with_path
=== RUN   TestValidator_StreamURL/valid_https_stream_with_query_params
=== RUN   TestValidator_StreamURL/valid_stream_with_port_and_path
=== RUN   TestValidator_StreamURL/empty_URL
=== RUN   TestValidator_StreamURL/invalid_URL_syntax
=== RUN   TestValidator_StreamURL/unsupported_scheme_ftp
=== RUN   TestValidator_StreamURL/unsupported_scheme_rtsp
=== RUN   TestValidator_StreamURL/missing_host
=== RUN   TestValidator_StreamURL/missing_path
=== RUN   TestValidator_StreamURL/root_path_only
=== RUN   TestValidator_StreamURL/no_scheme
--- PASS: TestValidator_StreamURL (0.00s)
    --- PASS: TestValidator_StreamURL/valid_http_stream_with_path (0.00s)
    --- PASS: TestValidator_StreamURL/valid_https_stream_with_query_params (0.00s)
    --- PASS: TestValidator_StreamURL/valid_stream_with_port_and_path (0.00s)
    --- PASS: TestValidator_StreamURL/empty_URL (0.00s)
    --- PASS: TestValidator_StreamURL/invalid_URL_syntax (0.00s)
    --- PASS: TestValidator_StreamURL/unsupported_scheme_ftp (0.00s)
    --- PASS: TestValidator_StreamURL/unsupported_scheme_rtsp (0.00s)
    --- PASS: TestValidator_StreamURL/missing_host (0.00s)
    --- PASS: TestValidator_StreamURL/missing_path (0.00s)
    --- PASS: TestValidator_StreamURL/root_path_only (0.00s)
    --- PASS: TestValidator_StreamURL/no_scheme (0.00s)
=== RUN   TestValidator_StreamURL_Integration
--- PASS: TestValidator_StreamURL_Integration (0.00s)
=== RUN   TestWritableDirectory
=== RUN   TestWritableDirectory/ValidExisting
=== RUN   TestWritableDirectory/ValidNew
=== RUN   TestWritableDirectory/ReadOnly
    writable_test.go:42: Skipping ReadOnly test running as root (always writable)
=== RUN   TestWritableDirectory/MissingMustExist
=== RUN   TestWritableDirectory/ParentReadOnly
    writable_test.go:74: Skipping ParentReadOnly test running as root
--- PASS: TestWritableDirectory (0.00s)
    --- PASS: TestWritableDirectory/ValidExisting (0.00s)
    --- PASS: TestWritableDirectory/ValidNew (0.00s)
    --- SKIP: TestWritableDirectory/ReadOnly (0.00s)
    --- PASS: TestWritableDirectory/MissingMustExist (0.00s)
    --- SKIP: TestWritableDirectory/ParentReadOnly (0.00s)
PASS
coverage: 79.4% of statements
ok  	github.com/ManuGH/xg2g/internal/validate	1.073s	coverage: 79.4% of statements
=== RUN   TestFileStore_Roundtrip
--- PASS: TestFileStore_Roundtrip (0.00s)
=== RUN   TestFileStore_AtomicWrite
--- PASS: TestFileStore_AtomicWrite (0.00s)
=== RUN   TestFileStore_Sanitization
--- PASS: TestFileStore_Sanitization (0.00s)
=== RUN   TestWorker_SkipIfBusy
--- PASS: TestWorker_SkipIfBusy (0.05s)
=== RUN   TestWorker_ChangeOnlyWrite
{"level":"warn","service":"xg2g","version":"","component":"verification","event":"drift_detected","kind":"config","mismatches":1,"time":"2026-02-01T14:53:11+01:00","message":"verification drift detected"}
--- PASS: TestWorker_ChangeOnlyWrite (0.15s)
=== RUN   TestWorker_ContentChangeTriggersWrite
--- PASS: TestWorker_ContentChangeTriggersWrite (0.00s)
PASS
coverage: 83.2% of statements
ok  	github.com/ManuGH/xg2g/internal/verification	1.218s	coverage: 83.2% of statements
=== RUN   TestConfigChecker_Drift
--- PASS: TestConfigChecker_Drift (0.00s)
=== RUN   TestRuntimeChecker_FFmpeg
--- PASS: TestRuntimeChecker_FFmpeg (0.00s)
=== RUN   TestRuntimeChecker_Mismatch
--- PASS: TestRuntimeChecker_Mismatch (0.00s)
PASS
coverage: 73.2% of statements
ok  	github.com/ManuGH/xg2g/internal/verification/checks	1.023s	coverage: 73.2% of statements
?   	github.com/ManuGH/xg2g/internal/version	[no test files]
=== RUN   TestRegression_DirectPlay_Fallback
--- PASS: TestRegression_DirectPlay_Fallback (0.00s)
PASS
coverage: [no statements]
ok  	github.com/ManuGH/xg2g/test/contract	1.012s	coverage: [no statements]
=== RUN   TestContractMatrix_P4_1
=== RUN   TestContractMatrix_P4_1/01_happy_directplay_h264_aac_mp4.input.json
=== RUN   TestContractMatrix_P4_1/02_directstream_mkv_to_hls_h264_aac.input.json
=== RUN   TestContractMatrix_P4_1/03_transcode_video_hevc_to_h264.input.json
=== RUN   TestContractMatrix_P4_1/04_transcode_audio_ac3_to_aac.input.json
=== RUN   TestContractMatrix_P4_1/05_policy_denies_transcode.input.json
=== RUN   TestContractMatrix_P4_1/06_fail_closed_capabilities_missing.input.json
=== RUN   TestContractMatrix_P4_1/07_fail_closed_capabilities_invalid_version.input.json
=== RUN   TestContractMatrix_P4_1/08_fail_closed_media_truth_unknown.input.json
--- PASS: TestContractMatrix_P4_1 (0.01s)
    --- PASS: TestContractMatrix_P4_1/01_happy_directplay_h264_aac_mp4.input.json (0.00s)
    --- PASS: TestContractMatrix_P4_1/02_directstream_mkv_to_hls_h264_aac.input.json (0.00s)
    --- PASS: TestContractMatrix_P4_1/03_transcode_video_hevc_to_h264.input.json (0.00s)
    --- PASS: TestContractMatrix_P4_1/04_transcode_audio_ac3_to_aac.input.json (0.00s)
    --- PASS: TestContractMatrix_P4_1/05_policy_denies_transcode.input.json (0.00s)
    --- PASS: TestContractMatrix_P4_1/06_fail_closed_capabilities_missing.input.json (0.00s)
    --- PASS: TestContractMatrix_P4_1/07_fail_closed_capabilities_invalid_version.input.json (0.00s)
    --- PASS: TestContractMatrix_P4_1/08_fail_closed_media_truth_unknown.input.json (0.00s)
PASS
coverage: [no statements]
ok  	github.com/ManuGH/xg2g/test/contract/p4_1	1.020s	coverage: [no statements]
# github.com/ManuGH/xg2g/tools
# internal/unsafeheader
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/byteorder
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goarch
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goexperiment
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/asan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/goos
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/rtcov
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/profilerecord
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/msan
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/godebugs
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode/utf8
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# math/bits
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/cpu
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/trace/tracev2
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# unicode
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# log/internal
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# cmp
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/itoa
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/uleb128
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# encoding
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# sync/atomic
compile: version "go1.25.5" does not match go tool version "go1.25.0"
# internal/coverage/calloc
compile: version "go1.25.5" does not match go tool version "go1.25.0"
=== RUN   TestEndToEndBouquetRetrieval
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
--- PASS: TestEndToEndBouquetRetrieval (0.00s)
=== RUN   TestEndToEndServiceRetrieval
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"services.nested","method":"GET","endpoint":"/api/getservices","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.services","bouquet_ref":"1:7:***uet","count":4,"time":"2026-02-01T14:53:12+01:00","message":"fetched services via nested endpoint"}
--- PASS: TestEndToEndServiceRetrieval (0.00s)
=== RUN   TestEndToEndStreamURLGeneration
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
--- PASS: TestEndToEndStreamURLGeneration (0.00s)
=== RUN   TestEndToEndWithRetries
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":4,"duration_ms":0,"error_class":"http_5xx","status":500,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request retry"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":2,"max_attempts":4,"duration_ms":0,"error_class":"http_5xx","status":500,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request retry"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":3,"max_attempts":4,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
--- PASS: TestEndToEndWithRetries (0.30s)
=== RUN   TestEndToEndWithTimeout
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":2,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
--- PASS: TestEndToEndWithTimeout (0.00s)
=== RUN   TestEndToEndMultipleBouquets
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":4,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"services.nested","method":"GET","endpoint":"/api/getservices","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.services","bouquet_ref":"1:7:***uet","count":1,"time":"2026-02-01T14:53:12+01:00","message":"fetched services via nested endpoint"}
--- PASS: TestEndToEndMultipleBouquets (0.00s)
=== RUN   TestEndToEndContextCancellation
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","error":"context canceled","event":"openwebif.rate_limit","operation":"bouquets","time":"2026-02-01T14:53:12+01:00","message":"rate limit wait cancelled"}
--- PASS: TestEndToEndContextCancellation (0.00s)
=== RUN   TestEndToEndEmptyBouquet
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"error","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"services.nested","method":"GET","endpoint":"/api/getservices","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"http_4xx","status":404,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request failed"}
{"level":"warn","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.services","bouquet_ref":"1:7:***uet","time":"2026-02-01T14:53:12+01:00","message":"no services found for bouquet"}
--- PASS: TestEndToEndEmptyBouquet (0.00s)
=== RUN   TestEndToEndMockServerReset
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":4,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
--- PASS: TestEndToEndMockServerReset (0.00s)
=== RUN   TestEndToEndConcurrentRequests
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
--- PASS: TestEndToEndConcurrentRequests (0.00s)
=== RUN   TestEndToEndHTTPClientReuse
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","rate_limit_rps":10,"burst":20,"time":"2026-02-01T14:53:12+01:00","message":"receiver rate limiting enabled"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.request","operation":"bouquets","method":"GET","endpoint":"/api/bouquets","attempt":1,"max_attempts":1,"duration_ms":0,"error_class":"ok","status":200,"time":"2026-02-01T14:53:12+01:00","message":"openwebif request completed"}
{"level":"info","service":"xg2g","version":"","component":"openwebif","host":"127.0.0.1","event":"openwebif.bouquets","count":3,"time":"2026-02-01T14:53:12+01:00","message":"fetched bouquets"}
--- PASS: TestEndToEndHTTPClientReuse (0.00s)
PASS
coverage: [no statements]
ok  	github.com/ManuGH/xg2g/test/integration	1.337s	coverage: [no statements]
=== RUN   TestInvariant5_LegacyAnonEqualsWebConservative
--- PASS: TestInvariant5_LegacyAnonEqualsWebConservative (0.00s)
=== RUN   TestInvariant6_AllProfilesMatchFixtures
=== RUN   TestInvariant6_AllProfilesMatchFixtures/web_conservative
=== RUN   TestInvariant6_AllProfilesMatchFixtures/vlc_desktop
=== RUN   TestInvariant6_AllProfilesMatchFixtures/stb_enigma2
=== RUN   TestInvariant6_AllProfilesMatchFixtures/android_tv
=== RUN   TestInvariant6_AllProfilesMatchFixtures/tvos
--- PASS: TestInvariant6_AllProfilesMatchFixtures (0.00s)
    --- PASS: TestInvariant6_AllProfilesMatchFixtures/web_conservative (0.00s)
    --- PASS: TestInvariant6_AllProfilesMatchFixtures/vlc_desktop (0.00s)
    --- PASS: TestInvariant6_AllProfilesMatchFixtures/stb_enigma2 (0.00s)
    --- PASS: TestInvariant6_AllProfilesMatchFixtures/android_tv (0.00s)
    --- PASS: TestInvariant6_AllProfilesMatchFixtures/tvos (0.00s)
=== RUN   TestV31CapsNoServerExtension
--- PASS: TestV31CapsNoServerExtension (0.00s)
=== RUN   TestInvariant7_WebConservativeAC3Transcode
--- PASS: TestInvariant7_WebConservativeAC3Transcode (0.00s)
=== RUN   TestInvariant8_AllowTranscodeConstraint
--- PASS: TestInvariant8_AllowTranscodeConstraint (0.00s)
=== RUN   TestDecisionGoldens
=== RUN   TestDecisionGoldens/legacy_unknown_codec.json
=== RUN   TestDecisionGoldens/missing_truth.json
=== RUN   TestDecisionGoldens/tvos_h265_aac.json
=== RUN   TestDecisionGoldens/vlc_h265_eac3.json
=== RUN   TestDecisionGoldens/web_conservative_ac3.json
=== RUN   TestDecisionGoldens/web_conservative_h264_aac.json
=== RUN   TestDecisionGoldens/web_conservative_mkv.json
--- PASS: TestDecisionGoldens (0.01s)
    --- PASS: TestDecisionGoldens/legacy_unknown_codec.json (0.00s)
    --- PASS: TestDecisionGoldens/missing_truth.json (0.00s)
    --- PASS: TestDecisionGoldens/tvos_h265_aac.json (0.00s)
    --- PASS: TestDecisionGoldens/vlc_h265_eac3.json (0.00s)
    --- PASS: TestDecisionGoldens/web_conservative_ac3.json (0.00s)
    --- PASS: TestDecisionGoldens/web_conservative_h264_aac.json (0.00s)
    --- PASS: TestDecisionGoldens/web_conservative_mkv.json (0.00s)
=== RUN   TestDecisionOutputInvariants
=== RUN   TestDecisionOutputInvariants/#9_Strict_DirectPlay_(Happy_Path)
=== RUN   TestDecisionOutputInvariants/#11_Deny_Hygiene_(Happy_Path)
--- PASS: TestDecisionOutputInvariants (0.00s)
    --- PASS: TestDecisionOutputInvariants/#9_Strict_DirectPlay_(Happy_Path) (0.00s)
    --- PASS: TestDecisionOutputInvariants/#11_Deny_Hygiene_(Happy_Path) (0.00s)
=== RUN   TestDecisionObservabilityContract
=== RUN   TestDecisionObservabilityContract/Direct_Play_(Happy_Path)
=== RUN   TestDecisionObservabilityContract/Deny_(Container_Unsupported)
=== RUN   TestDecisionObservabilityContract/Problem_(Missing_Truth)
--- PASS: TestDecisionObservabilityContract (0.00s)
    --- PASS: TestDecisionObservabilityContract/Direct_Play_(Happy_Path) (0.00s)
    --- PASS: TestDecisionObservabilityContract/Deny_(Container_Unsupported) (0.00s)
    --- PASS: TestDecisionObservabilityContract/Problem_(Missing_Truth) (0.00s)
PASS
coverage: [no statements]
ok  	github.com/ManuGH/xg2g/test/invariants	1.029s	coverage: [no statements]
